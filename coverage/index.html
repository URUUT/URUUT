<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Uruut-dev</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.8.0/application.js' type='text/javascript'></script>
    <link href='./assets/0.8.0/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.8.0/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.8.0/favicon.png" />
  </head>

  <body>
    <div id="loading">
      <img src="./assets/0.8.0/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2014-03-29T23:58:33-04:00">2014-03-29T23:58:33-04:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="red">43.47%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         1.28
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>118</b> files in total.
    <b>2811</b> relevant lines.
    <span class="green"><b>1222</b> lines covered</span> and
    <span class="red"><b>1589</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="strong"><a href="#556ed61113e933ae8298e023a1658598a40dfe59" class="src_link" title="app/admin/admin_user.rb">app/admin/admin_user.rb</a></td>
        <td class="red strong">28.57 %</td>
        <td>20</td>
        <td>14</td>
        <td>4</td>
        <td>10</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2361cd8b08c2c3e1acea3552d3907b94ca24b33a" class="src_link" title="app/admin/dashboard.rb">app/admin/dashboard.rb</a></td>
        <td class="red strong">12.12 %</td>
        <td>77</td>
        <td>33</td>
        <td>4</td>
        <td>29</td>
        <td>0.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#ed620f4484c406f42f313432b69f99d1d2222a2c" class="src_link" title="app/admin/demo.rb">app/admin/demo.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#816bf0f2f35cbc364196bae9f0585bb3374b0e22" class="src_link" title="app/admin/membership.rb">app/admin/membership.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>37</td>
        <td>21</td>
        <td>7</td>
        <td>14</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e29d3fa5c5ee4c9b883648f87f3cd3f62c858f2b" class="src_link" title="app/admin/project.rb">app/admin/project.rb</a></td>
        <td class="red strong">8.79 %</td>
        <td>126</td>
        <td>91</td>
        <td>8</td>
        <td>83</td>
        <td>0.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#344620363e81540f496f214e2e4d244e0d600c3e" class="src_link" title="app/admin/user.rb">app/admin/user.rb</a></td>
        <td class="red strong">37.5 %</td>
        <td>11</td>
        <td>8</td>
        <td>3</td>
        <td>5</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5f8a40195ce45308d6356e9e539fa5754beef394" class="src_link" title="app/controllers/admin_controller.rb">app/controllers/admin_controller.rb</a></td>
        <td class="red strong">42.11 %</td>
        <td>41</td>
        <td>19</td>
        <td>8</td>
        <td>11</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a845ccee818c59c170e1572f78f556567f3d85df" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
        <td class="red strong">69.05 %</td>
        <td>76</td>
        <td>42</td>
        <td>29</td>
        <td>13</td>
        <td>10.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#681d294c2edd32bd1776b87b76af7e32504e2ce5" class="src_link" title="app/controllers/authentications_controller.rb">app/controllers/authentications_controller.rb</a></td>
        <td class="red strong">31.58 %</td>
        <td>33</td>
        <td>19</td>
        <td>6</td>
        <td>13</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6113b80be33e3081111889b24e25d3ebb6e042a0" class="src_link" title="app/controllers/comments_controller.rb">app/controllers/comments_controller.rb</a></td>
        <td class="red strong">22.22 %</td>
        <td>14</td>
        <td>9</td>
        <td>2</td>
        <td>7</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#fa391ca21b0484a94610215d091a34e615988141" class="src_link" title="app/controllers/demo_request_controller.rb">app/controllers/demo_request_controller.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>55</td>
        <td>30</td>
        <td>10</td>
        <td>20</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#62377441b41c9c08a0b5228120c5a0a9c6bf1184" class="src_link" title="app/controllers/donation_steps_controller.rb">app/controllers/donation_steps_controller.rb</a></td>
        <td class="red strong">60.0 %</td>
        <td>80</td>
        <td>45</td>
        <td>27</td>
        <td>18</td>
        <td>1.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#35194221aa7425b146793467aebb6cc6cd050990" class="src_link" title="app/controllers/donations_controller.rb">app/controllers/donations_controller.rb</a></td>
        <td class="red strong">35.94 %</td>
        <td>183</td>
        <td>128</td>
        <td>46</td>
        <td>82</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6d796903ab77a5c0c130f455ad3be2fd660ca286" class="src_link" title="app/controllers/galleries_controller.rb">app/controllers/galleries_controller.rb</a></td>
        <td class="red strong">16.67 %</td>
        <td>41</td>
        <td>24</td>
        <td>4</td>
        <td>20</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#58858915cf084124f427a3b86affe71b9a078c66" class="src_link" title="app/controllers/identities_controller.rb">app/controllers/identities_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#37f544a2fd5d5b9a253cd9d30063bcd7c4d12978" class="src_link" title="app/controllers/marketing_infos_controller.rb">app/controllers/marketing_infos_controller.rb</a></td>
        <td class="red strong">25.0 %</td>
        <td>14</td>
        <td>8</td>
        <td>2</td>
        <td>6</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#aa7210f1c889870d3f8076eaefb9b7d2ed80eaf7" class="src_link" title="app/controllers/memberships_controller.rb">app/controllers/memberships_controller.rb</a></td>
        <td class="red strong">40.0 %</td>
        <td>38</td>
        <td>20</td>
        <td>8</td>
        <td>12</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#88ded1c4c746b0dd45401672cf00f5bf4aceb16d" class="src_link" title="app/controllers/newsletters_controller.rb">app/controllers/newsletters_controller.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>13</td>
        <td>6</td>
        <td>2</td>
        <td>4</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2793a461617f9b8bf863e57e27f2b13c67686af1" class="src_link" title="app/controllers/pages_controller.rb">app/controllers/pages_controller.rb</a></td>
        <td class="red strong">43.86 %</td>
        <td>110</td>
        <td>57</td>
        <td>25</td>
        <td>32</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#4d0a79ec48ac7c9c4e52cf83f246a3a841a42251" class="src_link" title="app/controllers/payment_methods_controller.rb">app/controllers/payment_methods_controller.rb</a></td>
        <td class="red strong">28.95 %</td>
        <td>63</td>
        <td>38</td>
        <td>11</td>
        <td>27</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6b813e06f1278dfb51a2e7008a3033767f0a3661" class="src_link" title="app/controllers/payments_controller.rb">app/controllers/payments_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a28f36265c0ad52b995556a7216f0f072ee83c64" class="src_link" title="app/controllers/posts_controller.rb">app/controllers/posts_controller.rb</a></td>
        <td class="red strong">25.0 %</td>
        <td>19</td>
        <td>12</td>
        <td>3</td>
        <td>9</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9f1af694a704cd218df63b622900d307a7b3eb63" class="src_link" title="app/controllers/press_coverages_controller.rb">app/controllers/press_coverages_controller.rb</a></td>
        <td class="red strong">47.37 %</td>
        <td>46</td>
        <td>19</td>
        <td>9</td>
        <td>10</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#aca0e7f3ffdedf772991ffc3019937e6946982ac" class="src_link" title="app/controllers/press_releases_controller.rb">app/controllers/press_releases_controller.rb</a></td>
        <td class="red strong">47.37 %</td>
        <td>47</td>
        <td>19</td>
        <td>9</td>
        <td>10</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf463187a568086d1d16724f212ce8047e46d7ed" class="src_link" title="app/controllers/project_admin/documents_controller.rb">app/controllers/project_admin/documents_controller.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>30</td>
        <td>16</td>
        <td>8</td>
        <td>8</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#7b217c8f0eca4a5113efaecf948c95058846c3b0" class="src_link" title="app/controllers/project_admin/projects_controller.rb">app/controllers/project_admin/projects_controller.rb</a></td>
        <td class="red strong">28.43 %</td>
        <td>170</td>
        <td>102</td>
        <td>29</td>
        <td>73</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5c959d7e2bea356992c71286d202f2ffae21284e" class="src_link" title="app/controllers/project_admin/xls_controller.rb">app/controllers/project_admin/xls_controller.rb</a></td>
        <td class="red strong">60.0 %</td>
        <td>20</td>
        <td>10</td>
        <td>6</td>
        <td>4</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9507b804ab53049e61c84e13d1b07bd791ca03ed" class="src_link" title="app/controllers/project_sponsor_controller.rb">app/controllers/project_sponsor_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#deeac6ff25168aee42f08cd1d8cc84ba1e46a639" class="src_link" title="app/controllers/projects_controller.rb">app/controllers/projects_controller.rb</a></td>
        <td class="red strong">60.92 %</td>
        <td>434</td>
        <td>261</td>
        <td>159</td>
        <td>102</td>
        <td>2.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9573b3a5a9bb35bfd77183c0920e021514307da5" class="src_link" title="app/controllers/question_controller.rb">app/controllers/question_controller.rb</a></td>
        <td class="red strong">16.67 %</td>
        <td>17</td>
        <td>12</td>
        <td>2</td>
        <td>10</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#04884ed9febe55d1cef0a6aa19d2eb5a3197b8e5" class="src_link" title="app/controllers/registrations_controller.rb">app/controllers/registrations_controller.rb</a></td>
        <td class="red strong">17.86 %</td>
        <td>98</td>
        <td>56</td>
        <td>10</td>
        <td>46</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#36b027c8f78c88224e91af7d035dee59284b5fb8" class="src_link" title="app/controllers/sponsors/dashboard_controller.rb">app/controllers/sponsors/dashboard_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9a0c296510044b0941f3d1993a64c6a227910bf6" class="src_link" title="app/controllers/sponsors/registrations_controller.rb">app/controllers/sponsors/registrations_controller.rb</a></td>
        <td class="red strong">20.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>2</td>
        <td>8</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f7becbe209601e8516ba1ecfe2f71b7b632fa4da" class="src_link" title="app/controllers/sponsors_controller.rb">app/controllers/sponsors_controller.rb</a></td>
        <td class="red strong">44.77 %</td>
        <td>250</td>
        <td>172</td>
        <td>77</td>
        <td>95</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5162c5365abae115afbdd9320b3e130adfbd30e2" class="src_link" title="app/controllers/subscriptions_controller.rb">app/controllers/subscriptions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#60977a896a24f0176330c0fcd93c418373d37f3d" class="src_link" title="app/controllers/transparency_workroom_controller.rb">app/controllers/transparency_workroom_controller.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>20</td>
        <td>15</td>
        <td>5</td>
        <td>10</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9ea79f53d8b8d72f6df473990af568bc5c85df99" class="src_link" title="app/controllers/users/omniauth_callbacks_controller.rb">app/controllers/users/omniauth_callbacks_controller.rb</a></td>
        <td class="red strong">18.75 %</td>
        <td>59</td>
        <td>32</td>
        <td>6</td>
        <td>26</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#67a7fca30560b0aa7e131146aad3487b0612e328" class="src_link" title="app/controllers/users/passwords_controller.rb">app/controllers/users/passwords_controller.rb</a></td>
        <td class="red strong">34.29 %</td>
        <td>72</td>
        <td>35</td>
        <td>12</td>
        <td>23</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#1acb720140de400fd8e3a1a5ce4b2ca3a21dd0a1" class="src_link" title="app/controllers/users/sessions_controller.rb">app/controllers/users/sessions_controller.rb</a></td>
        <td class="red strong">28.13 %</td>
        <td>67</td>
        <td>32</td>
        <td>9</td>
        <td>23</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#1aab4395a7b4cb380b4dc44a06814340bc44c009" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
        <td class="red strong">57.14 %</td>
        <td>53</td>
        <td>28</td>
        <td>16</td>
        <td>12</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#675d841ad552c76d335195e789cab0597f03dd0d" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
        <td class="red strong">49.26 %</td>
        <td>249</td>
        <td>136</td>
        <td>67</td>
        <td>69</td>
        <td>5.9</td>
      </tr>

      <tr>
        <td class="strong"><a href="#59c94a4a12c07eb6dde0b0e13aff5f4704769bd7" class="src_link" title="app/helpers/devise_helper.rb">app/helpers/devise_helper.rb</a></td>
        <td class="red strong">42.86 %</td>
        <td>16</td>
        <td>7</td>
        <td>3</td>
        <td>4</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a32b941304031f144fb5a91339432086460a671e" class="src_link" title="app/helpers/donations_helper.rb">app/helpers/donations_helper.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#87399e82acb917bdbbc3e1081c004da716ab5509" class="src_link" title="app/helpers/identities_helper.rb">app/helpers/identities_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5868eaabdab9a671171a5b3973ec890c2965e49c" class="src_link" title="app/helpers/mailer_helper.rb">app/helpers/mailer_helper.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>5</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#0565456c5539d347f0571190d89f295229db842f" class="src_link" title="app/helpers/memberships_helper.rb">app/helpers/memberships_helper.rb</a></td>
        <td class="red strong">32.0 %</td>
        <td>55</td>
        <td>25</td>
        <td>8</td>
        <td>17</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#df42ae8a85a5bb23564d48b9e2a75d821c2936ce" class="src_link" title="app/helpers/navigation_helper.rb">app/helpers/navigation_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>13.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#379787e76c6da5d84f17a7f1530847869608297d" class="src_link" title="app/helpers/pages_helper.rb">app/helpers/pages_helper.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>5</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#78611b50266244e79240ce286e4dc9d39b8cffaf" class="src_link" title="app/helpers/payment_helper.rb">app/helpers/payment_helper.rb</a></td>
        <td class="red strong">22.22 %</td>
        <td>18</td>
        <td>9</td>
        <td>2</td>
        <td>7</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2196ab0203eaae2498e68fcf83d03c1a22d92024" class="src_link" title="app/helpers/projects_helper.rb">app/helpers/projects_helper.rb</a></td>
        <td class="red strong">57.78 %</td>
        <td>118</td>
        <td>45</td>
        <td>26</td>
        <td>19</td>
        <td>2.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f0ed26846a32ed31207c30f278e1128e963e78fe" class="src_link" title="app/helpers/sponsors/dashboard_helper.rb">app/helpers/sponsors/dashboard_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c801de131565edff2dd7b24ed0b9c9112bebaa74" class="src_link" title="app/helpers/sponsors_helper.rb">app/helpers/sponsors_helper.rb</a></td>
        <td class="red strong">51.85 %</td>
        <td>48</td>
        <td>27</td>
        <td>14</td>
        <td>13</td>
        <td>1.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#d937c9f16c10c0de3c4851bda5719bf06ff3ded8" class="src_link" title="app/helpers/users_helper.rb">app/helpers/users_helper.rb</a></td>
        <td class="red strong">69.23 %</td>
        <td>89</td>
        <td>13</td>
        <td>9</td>
        <td>4</td>
        <td>2.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf12371121596006810fb66f6365843cc686eeec" class="src_link" title="app/mailer_previews/contact_mailer_preview.rb">app/mailer_previews/contact_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#123e75c980b7cf5f92874586382c294380f0dae0" class="src_link" title="app/mailer_previews/demo_request_mailer_preview.rb">app/mailer_previews/demo_request_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#38343f5929f28ca19a7ff97b38d1d2d86655bbe4" class="src_link" title="app/mailer_previews/donation_mailer_preview.rb">app/mailer_previews/donation_mailer_preview.rb</a></td>
        <td class="red strong">57.14 %</td>
        <td>16</td>
        <td>7</td>
        <td>4</td>
        <td>3</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#46a3fc2dfe7e14e3e87e77f631598f6cac519d9c" class="src_link" title="app/mailer_previews/milestone_mailer_preview.rb">app/mailer_previews/milestone_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c624cfe5f3673105a2a3d86e3247ea9dac077424" class="src_link" title="app/mailer_previews/newsletter_mailer_preview.rb">app/mailer_previews/newsletter_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e8f98f95e47f0d2f8f4c2a287fc4ff6f06e3072c" class="src_link" title="app/mailer_previews/project_mailer_preview.rb">app/mailer_previews/project_mailer_preview.rb</a></td>
        <td class="red strong">57.14 %</td>
        <td>16</td>
        <td>7</td>
        <td>4</td>
        <td>3</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c651b9e6cb3588366f4ae47839b3c4c6be41cae8" class="src_link" title="app/mailer_previews/question_mailer_preview.rb">app/mailer_previews/question_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a077b9593ac724b81cfa81a6dd130c5a959510d2" class="src_link" title="app/mailer_previews/sponsor_mailer_preview.rb">app/mailer_previews/sponsor_mailer_preview.rb</a></td>
        <td class="red strong">55.56 %</td>
        <td>21</td>
        <td>9</td>
        <td>5</td>
        <td>4</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a1feffab53e2b345b62a36cac554e7b4a6009659" class="src_link" title="app/mailer_previews/welcome_mailer_preview.rb">app/mailer_previews/welcome_mailer_preview.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>21</td>
        <td>10</td>
        <td>5</td>
        <td>5</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#b0e247cd3d0aac6e4bfe6a650df91d36f548177f" class="src_link" title="app/mailers/contact_mailer.rb">app/mailers/contact_mailer.rb</a></td>
        <td class="red strong">37.5 %</td>
        <td>18</td>
        <td>8</td>
        <td>3</td>
        <td>5</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#1263879ab3b8855a469cf932fc43ee40f7e4050c" class="src_link" title="app/mailers/demo_request_mailer.rb">app/mailers/demo_request_mailer.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>10</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#53f530d65f7208d4d44cd9904134296d34097abd" class="src_link" title="app/mailers/donation_mailer.rb">app/mailers/donation_mailer.rb</a></td>
        <td class="red strong">18.18 %</td>
        <td>51</td>
        <td>33</td>
        <td>6</td>
        <td>27</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9621a48ac3235c77d5788727b94cc12a4ca19725" class="src_link" title="app/mailers/milestone_mailer.rb">app/mailers/milestone_mailer.rb</a></td>
        <td class="red strong">44.44 %</td>
        <td>13</td>
        <td>9</td>
        <td>4</td>
        <td>5</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#abd76a0ef148022925435f30ac4d5963ef742a23" class="src_link" title="app/mailers/newsletter_mailer.rb">app/mailers/newsletter_mailer.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>10</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2212e3c9716f6cd23010c114c440122e6736b38a" class="src_link" title="app/mailers/project_mailer.rb">app/mailers/project_mailer.rb</a></td>
        <td class="red strong">22.22 %</td>
        <td>41</td>
        <td>27</td>
        <td>6</td>
        <td>21</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6d2a4d35d3ce9a5bd895cc6857cb4a4f7ecdb322" class="src_link" title="app/mailers/question_mailer.rb">app/mailers/question_mailer.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>12</td>
        <td>9</td>
        <td>3</td>
        <td>6</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#76f50ef76b083474103e5128eab5a62b4896c8a7" class="src_link" title="app/mailers/sponsor_mailer.rb">app/mailers/sponsor_mailer.rb</a></td>
        <td class="red strong">18.18 %</td>
        <td>79</td>
        <td>55</td>
        <td>10</td>
        <td>45</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#7f5b84a83362c331ccfe7290cda16408249a4562" class="src_link" title="app/mailers/transparency_workroom_mailer.rb">app/mailers/transparency_workroom_mailer.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>11</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#afbbc86d6791a50a783319543a51b679199f7363" class="src_link" title="app/mailers/welcome_mailer.rb">app/mailers/welcome_mailer.rb</a></td>
        <td class="red strong">29.41 %</td>
        <td>31</td>
        <td>17</td>
        <td>5</td>
        <td>12</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#8f56b9a98ea120b1766a9787165e93a8183a7869" class="src_link" title="app/models/ability.rb">app/models/ability.rb</a></td>
        <td class="red strong">27.27 %</td>
        <td>17</td>
        <td>11</td>
        <td>3</td>
        <td>8</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#eb84067a35cc26fa67ae7cfc59185b72f7da2d48" class="src_link" title="app/models/account.rb">app/models/account.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9bd2d9a057ffb5b3fa4d142b5770a57333d72b15" class="src_link" title="app/models/admin_user.rb">app/models/admin_user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#597b051dfa35fb8a3a19a5e14cfeeb24b3a7de8a" class="src_link" title="app/models/authentication.rb">app/models/authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#152569c7c87ca8c044e2e3059a50a17f8ba345f2" class="src_link" title="app/models/comment.rb">app/models/comment.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#dc439c7da27653b55d9e4919f1e6217069cf2c2d" class="src_link" title="app/models/contact.rb">app/models/contact.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#97d01aa75382dbda039100284feb104f848322aa" class="src_link" title="app/models/credit_card.rb">app/models/credit_card.rb</a></td>
        <td class="red strong">48.0 %</td>
        <td>51</td>
        <td>25</td>
        <td>12</td>
        <td>13</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf77cbc4efb6d2ffe2a8013041bf7e845500e499" class="src_link" title="app/models/demo.rb">app/models/demo.rb</a></td>
        <td class="red strong">68.97 %</td>
        <td>148</td>
        <td>29</td>
        <td>20</td>
        <td>9</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e011ef800f5e1d87894fe49a0081aeeb01608126" class="src_link" title="app/models/document.rb">app/models/document.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#ef84543fda098ceba08592e2aa82d64fcbc76ece" class="src_link" title="app/models/donation.rb">app/models/donation.rb</a></td>
        <td class="red strong">48.39 %</td>
        <td>169</td>
        <td>93</td>
        <td>45</td>
        <td>48</td>
        <td>1.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f89272d3c19c7e125fc9a83860df565a090edf7f" class="src_link" title="app/models/feature.rb">app/models/feature.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#8f07ef00117bd25fe4fb8a460b3cb4c551ad364a" class="src_link" title="app/models/gallery.rb">app/models/gallery.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#93d3293c53d6c1ba0cc6d601077a31fb8bac95f1" class="src_link" title="app/models/identity.rb">app/models/identity.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#27d6b1b2a541abe4aaeaa6b6cd9c83c2d046131f" class="src_link" title="app/models/marketing_info.rb">app/models/marketing_info.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c37fda3babeb25f451141a9dee6a0d89e7e3012b" class="src_link" title="app/models/membership.rb">app/models/membership.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>1.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#fbfd4573e7b0eb57b5b219dae14a14db95581016" class="src_link" title="app/models/merit/badge_rules.rb">app/models/merit/badge_rules.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>49</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#40ae1bfdb6620cd93ab66cab0f8ea194d33892ab" class="src_link" title="app/models/merit/point_rules.rb">app/models/merit/point_rules.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a045779eb7ee953910dad73120da50d61b63907a" class="src_link" title="app/models/merit/rank_rules.rb">app/models/merit/rank_rules.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5c83c4c07405e6769687dba17bf024869c469a1b" class="src_link" title="app/models/message.rb">app/models/message.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#8301edf857be2f017130177eebc87531b40c01f2" class="src_link" title="app/models/milestoneemail.rb">app/models/milestoneemail.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>4</td>
        <td>1</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#367cc70bc2b2d22fd447d018875601928b398cde" class="src_link" title="app/models/newsletter.rb">app/models/newsletter.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e0486abc22ee49268c5dfa9e82d11854f971b26b" class="src_link" title="app/models/perk.rb">app/models/perk.rb</a></td>
        <td class="red strong">58.33 %</td>
        <td>22</td>
        <td>12</td>
        <td>7</td>
        <td>5</td>
        <td>1.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#7e71d37e9dc15fdb7a94b8447432a08fc28c9ff1" class="src_link" title="app/models/plan.rb">app/models/plan.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>1.9</td>
      </tr>

      <tr>
        <td class="strong"><a href="#eb146565e98153485d2b79732a6fab6f4c090efa" class="src_link" title="app/models/plan_feature.rb">app/models/plan_feature.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#426e2c1456b61fd89d06cc55acac39c78105cd02" class="src_link" title="app/models/post.rb">app/models/post.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2cc4e13f808af585d2ae1b8d8f1c390aac30f9f3" class="src_link" title="app/models/press_coverage.rb">app/models/press_coverage.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f5c15ceeba743498e539e4524fc14a72c4376050" class="src_link" title="app/models/press_release.rb">app/models/press_release.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#014c541e6d1d272ebd4b5b43c214d2efba24d16f" class="src_link" title="app/models/project.rb">app/models/project.rb</a></td>
        <td class="red strong">33.48 %</td>
        <td>410</td>
        <td>227</td>
        <td>76</td>
        <td>151</td>
        <td>1.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#3970aa36c3b03c2727f492796eb4eb475e08c206" class="src_link" title="app/models/project_sponsor.rb">app/models/project_sponsor.rb</a></td>
        <td class="red strong">62.5 %</td>
        <td>37</td>
        <td>24</td>
        <td>15</td>
        <td>9</td>
        <td>3.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#fe2c4aaaca43837f5fac72036fd265cd8670f3ba" class="src_link" title="app/models/project_update.rb">app/models/project_update.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#3ad85f53c10aaf90e5b8a3e172ffbc3133b9cee2" class="src_link" title="app/models/question.rb">app/models/question.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#99e3b750911f5c7662b7fad707b34c9f1ea3ba57" class="src_link" title="app/models/sponsor.rb">app/models/sponsor.rb</a></td>
        <td class="red strong">37.14 %</td>
        <td>138</td>
        <td>70</td>
        <td>26</td>
        <td>44</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#80d05693ee375e25361bc832fb88405c290bd047" class="src_link" title="app/models/sponsorship_benefit.rb">app/models/sponsorship_benefit.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#b5255c665ff34637018857ff6b255787344d0ab3" class="src_link" title="app/models/sponsorship_level.rb">app/models/sponsorship_level.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#ad6c590b26c503ceebd35b1e1a7cbae68a7757ba" class="src_link" title="app/models/tax_report.rb">app/models/tax_report.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#901e1f9b5a6285915135f59fc9672548f6b78e6d" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
        <td class="red strong">39.13 %</td>
        <td>209</td>
        <td>115</td>
        <td>45</td>
        <td>70</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#248deb0cfd0ad48f9bd072f78e737130d47486b0" class="src_link" title="app/services/gateway/base_service.rb">app/services/gateway/base_service.rb</a></td>
        <td class="red strong">54.55 %</td>
        <td>23</td>
        <td>11</td>
        <td>6</td>
        <td>5</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c59123810d052eeb2c9cba2800711fdcdf6faec1" class="src_link" title="app/services/gateway/cards_service.rb">app/services/gateway/cards_service.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>19</td>
        <td>9</td>
        <td>3</td>
        <td>6</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e6fc991cf5749b5c80d306c061bc3610ab37ed77" class="src_link" title="app/services/gateway/customer_service.rb">app/services/gateway/customer_service.rb</a></td>
        <td class="red strong">42.86 %</td>
        <td>14</td>
        <td>7</td>
        <td>3</td>
        <td>4</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#d19292acdc58db56c1cc616d9522c8eba85cee43" class="src_link" title="app/services/gateway/plans_service.rb">app/services/gateway/plans_service.rb</a></td>
        <td class="red strong">28.57 %</td>
        <td>50</td>
        <td>28</td>
        <td>8</td>
        <td>20</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#501003b58a9cdaedd52f211d748398104ed9ad15" class="src_link" title="app/services/subscription_service.rb">app/services/subscription_service.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>15</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf6840928b0c230fde4fe34b1caae49d23c919a8" class="src_link" title="app/services/worksheet/base.rb">app/services/worksheet/base.rb</a></td>
        <td class="red strong">38.89 %</td>
        <td>33</td>
        <td>18</td>
        <td>7</td>
        <td>11</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f862985a47e78b58fe5aecbe684cc5557e3b0144" class="src_link" title="app/services/worksheet/donors.rb">app/services/worksheet/donors.rb</a></td>
        <td class="red strong">58.33 %</td>
        <td>28</td>
        <td>12</td>
        <td>7</td>
        <td>5</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#99efbd4197005b7d330aacecb21d9d59ffb57790" class="src_link" title="app/services/worksheet/sponsors.rb">app/services/worksheet/sponsors.rb</a></td>
        <td class="red strong">53.33 %</td>
        <td>34</td>
        <td>15</td>
        <td>8</td>
        <td>7</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#151d00deba20d09927071f991cbfdfec5da2351d" class="src_link" title="app/services/xls_service.rb">app/services/xls_service.rb</a></td>
        <td class="red strong">47.06 %</td>
        <td>33</td>
        <td>17</td>
        <td>8</td>
        <td>9</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#00031ce59e4062aef510bd5632cb3d3beb920e52" class="src_link" title="app/workers/second_test.rb">app/workers/second_test.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>11</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>0.7</td>
      </tr>

    </tbody>
  </table>
</div>



          <div class="file_list_container" id="Controllers">
  <h2>
    <span class="group_name">Controllers</span>
    (<span class="covered_percent"><span class="red">43.19%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         1.26
       </span>
    </span> hits/line)
  </h2>
  <a name="Controllers"></a>
  <div>
    <b>34</b> files in total.
    <b>1292</b> relevant lines.
    <span class="green"><b>558</b> lines covered</span> and
    <span class="red"><b>734</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="strong"><a href="#5f8a40195ce45308d6356e9e539fa5754beef394" class="src_link" title="app/controllers/admin_controller.rb">app/controllers/admin_controller.rb</a></td>
        <td class="red strong">42.11 %</td>
        <td>41</td>
        <td>19</td>
        <td>8</td>
        <td>11</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a845ccee818c59c170e1572f78f556567f3d85df" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
        <td class="red strong">69.05 %</td>
        <td>76</td>
        <td>42</td>
        <td>29</td>
        <td>13</td>
        <td>10.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#681d294c2edd32bd1776b87b76af7e32504e2ce5" class="src_link" title="app/controllers/authentications_controller.rb">app/controllers/authentications_controller.rb</a></td>
        <td class="red strong">31.58 %</td>
        <td>33</td>
        <td>19</td>
        <td>6</td>
        <td>13</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6113b80be33e3081111889b24e25d3ebb6e042a0" class="src_link" title="app/controllers/comments_controller.rb">app/controllers/comments_controller.rb</a></td>
        <td class="red strong">22.22 %</td>
        <td>14</td>
        <td>9</td>
        <td>2</td>
        <td>7</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#fa391ca21b0484a94610215d091a34e615988141" class="src_link" title="app/controllers/demo_request_controller.rb">app/controllers/demo_request_controller.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>55</td>
        <td>30</td>
        <td>10</td>
        <td>20</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#62377441b41c9c08a0b5228120c5a0a9c6bf1184" class="src_link" title="app/controllers/donation_steps_controller.rb">app/controllers/donation_steps_controller.rb</a></td>
        <td class="red strong">60.0 %</td>
        <td>80</td>
        <td>45</td>
        <td>27</td>
        <td>18</td>
        <td>1.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#35194221aa7425b146793467aebb6cc6cd050990" class="src_link" title="app/controllers/donations_controller.rb">app/controllers/donations_controller.rb</a></td>
        <td class="red strong">35.94 %</td>
        <td>183</td>
        <td>128</td>
        <td>46</td>
        <td>82</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6d796903ab77a5c0c130f455ad3be2fd660ca286" class="src_link" title="app/controllers/galleries_controller.rb">app/controllers/galleries_controller.rb</a></td>
        <td class="red strong">16.67 %</td>
        <td>41</td>
        <td>24</td>
        <td>4</td>
        <td>20</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#58858915cf084124f427a3b86affe71b9a078c66" class="src_link" title="app/controllers/identities_controller.rb">app/controllers/identities_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#37f544a2fd5d5b9a253cd9d30063bcd7c4d12978" class="src_link" title="app/controllers/marketing_infos_controller.rb">app/controllers/marketing_infos_controller.rb</a></td>
        <td class="red strong">25.0 %</td>
        <td>14</td>
        <td>8</td>
        <td>2</td>
        <td>6</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#aa7210f1c889870d3f8076eaefb9b7d2ed80eaf7" class="src_link" title="app/controllers/memberships_controller.rb">app/controllers/memberships_controller.rb</a></td>
        <td class="red strong">40.0 %</td>
        <td>38</td>
        <td>20</td>
        <td>8</td>
        <td>12</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#88ded1c4c746b0dd45401672cf00f5bf4aceb16d" class="src_link" title="app/controllers/newsletters_controller.rb">app/controllers/newsletters_controller.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>13</td>
        <td>6</td>
        <td>2</td>
        <td>4</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2793a461617f9b8bf863e57e27f2b13c67686af1" class="src_link" title="app/controllers/pages_controller.rb">app/controllers/pages_controller.rb</a></td>
        <td class="red strong">43.86 %</td>
        <td>110</td>
        <td>57</td>
        <td>25</td>
        <td>32</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#4d0a79ec48ac7c9c4e52cf83f246a3a841a42251" class="src_link" title="app/controllers/payment_methods_controller.rb">app/controllers/payment_methods_controller.rb</a></td>
        <td class="red strong">28.95 %</td>
        <td>63</td>
        <td>38</td>
        <td>11</td>
        <td>27</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6b813e06f1278dfb51a2e7008a3033767f0a3661" class="src_link" title="app/controllers/payments_controller.rb">app/controllers/payments_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a28f36265c0ad52b995556a7216f0f072ee83c64" class="src_link" title="app/controllers/posts_controller.rb">app/controllers/posts_controller.rb</a></td>
        <td class="red strong">25.0 %</td>
        <td>19</td>
        <td>12</td>
        <td>3</td>
        <td>9</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9f1af694a704cd218df63b622900d307a7b3eb63" class="src_link" title="app/controllers/press_coverages_controller.rb">app/controllers/press_coverages_controller.rb</a></td>
        <td class="red strong">47.37 %</td>
        <td>46</td>
        <td>19</td>
        <td>9</td>
        <td>10</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#aca0e7f3ffdedf772991ffc3019937e6946982ac" class="src_link" title="app/controllers/press_releases_controller.rb">app/controllers/press_releases_controller.rb</a></td>
        <td class="red strong">47.37 %</td>
        <td>47</td>
        <td>19</td>
        <td>9</td>
        <td>10</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf463187a568086d1d16724f212ce8047e46d7ed" class="src_link" title="app/controllers/project_admin/documents_controller.rb">app/controllers/project_admin/documents_controller.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>30</td>
        <td>16</td>
        <td>8</td>
        <td>8</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#7b217c8f0eca4a5113efaecf948c95058846c3b0" class="src_link" title="app/controllers/project_admin/projects_controller.rb">app/controllers/project_admin/projects_controller.rb</a></td>
        <td class="red strong">28.43 %</td>
        <td>170</td>
        <td>102</td>
        <td>29</td>
        <td>73</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5c959d7e2bea356992c71286d202f2ffae21284e" class="src_link" title="app/controllers/project_admin/xls_controller.rb">app/controllers/project_admin/xls_controller.rb</a></td>
        <td class="red strong">60.0 %</td>
        <td>20</td>
        <td>10</td>
        <td>6</td>
        <td>4</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9507b804ab53049e61c84e13d1b07bd791ca03ed" class="src_link" title="app/controllers/project_sponsor_controller.rb">app/controllers/project_sponsor_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#deeac6ff25168aee42f08cd1d8cc84ba1e46a639" class="src_link" title="app/controllers/projects_controller.rb">app/controllers/projects_controller.rb</a></td>
        <td class="red strong">60.92 %</td>
        <td>434</td>
        <td>261</td>
        <td>159</td>
        <td>102</td>
        <td>2.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9573b3a5a9bb35bfd77183c0920e021514307da5" class="src_link" title="app/controllers/question_controller.rb">app/controllers/question_controller.rb</a></td>
        <td class="red strong">16.67 %</td>
        <td>17</td>
        <td>12</td>
        <td>2</td>
        <td>10</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#04884ed9febe55d1cef0a6aa19d2eb5a3197b8e5" class="src_link" title="app/controllers/registrations_controller.rb">app/controllers/registrations_controller.rb</a></td>
        <td class="red strong">17.86 %</td>
        <td>98</td>
        <td>56</td>
        <td>10</td>
        <td>46</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#36b027c8f78c88224e91af7d035dee59284b5fb8" class="src_link" title="app/controllers/sponsors/dashboard_controller.rb">app/controllers/sponsors/dashboard_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9a0c296510044b0941f3d1993a64c6a227910bf6" class="src_link" title="app/controllers/sponsors/registrations_controller.rb">app/controllers/sponsors/registrations_controller.rb</a></td>
        <td class="red strong">20.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>2</td>
        <td>8</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f7becbe209601e8516ba1ecfe2f71b7b632fa4da" class="src_link" title="app/controllers/sponsors_controller.rb">app/controllers/sponsors_controller.rb</a></td>
        <td class="red strong">44.77 %</td>
        <td>250</td>
        <td>172</td>
        <td>77</td>
        <td>95</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5162c5365abae115afbdd9320b3e130adfbd30e2" class="src_link" title="app/controllers/subscriptions_controller.rb">app/controllers/subscriptions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#60977a896a24f0176330c0fcd93c418373d37f3d" class="src_link" title="app/controllers/transparency_workroom_controller.rb">app/controllers/transparency_workroom_controller.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>20</td>
        <td>15</td>
        <td>5</td>
        <td>10</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9ea79f53d8b8d72f6df473990af568bc5c85df99" class="src_link" title="app/controllers/users/omniauth_callbacks_controller.rb">app/controllers/users/omniauth_callbacks_controller.rb</a></td>
        <td class="red strong">18.75 %</td>
        <td>59</td>
        <td>32</td>
        <td>6</td>
        <td>26</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#67a7fca30560b0aa7e131146aad3487b0612e328" class="src_link" title="app/controllers/users/passwords_controller.rb">app/controllers/users/passwords_controller.rb</a></td>
        <td class="red strong">34.29 %</td>
        <td>72</td>
        <td>35</td>
        <td>12</td>
        <td>23</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#1acb720140de400fd8e3a1a5ce4b2ca3a21dd0a1" class="src_link" title="app/controllers/users/sessions_controller.rb">app/controllers/users/sessions_controller.rb</a></td>
        <td class="red strong">28.13 %</td>
        <td>67</td>
        <td>32</td>
        <td>9</td>
        <td>23</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#1aab4395a7b4cb380b4dc44a06814340bc44c009" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
        <td class="red strong">57.14 %</td>
        <td>53</td>
        <td>28</td>
        <td>16</td>
        <td>12</td>
        <td>0.8</td>
      </tr>

    </tbody>
  </table>
</div>


          <div class="file_list_container" id="Models">
  <h2>
    <span class="group_name">Models</span>
    (<span class="covered_percent"><span class="red">50.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         1.07
       </span>
    </span> hits/line)
  </h2>
  <a name="Models"></a>
  <div>
    <b>36</b> files in total.
    <b>718</b> relevant lines.
    <span class="green"><b>359</b> lines covered</span> and
    <span class="red"><b>359</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="strong"><a href="#8f56b9a98ea120b1766a9787165e93a8183a7869" class="src_link" title="app/models/ability.rb">app/models/ability.rb</a></td>
        <td class="red strong">27.27 %</td>
        <td>17</td>
        <td>11</td>
        <td>3</td>
        <td>8</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#eb84067a35cc26fa67ae7cfc59185b72f7da2d48" class="src_link" title="app/models/account.rb">app/models/account.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9bd2d9a057ffb5b3fa4d142b5770a57333d72b15" class="src_link" title="app/models/admin_user.rb">app/models/admin_user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#597b051dfa35fb8a3a19a5e14cfeeb24b3a7de8a" class="src_link" title="app/models/authentication.rb">app/models/authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#152569c7c87ca8c044e2e3059a50a17f8ba345f2" class="src_link" title="app/models/comment.rb">app/models/comment.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#dc439c7da27653b55d9e4919f1e6217069cf2c2d" class="src_link" title="app/models/contact.rb">app/models/contact.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#97d01aa75382dbda039100284feb104f848322aa" class="src_link" title="app/models/credit_card.rb">app/models/credit_card.rb</a></td>
        <td class="red strong">48.0 %</td>
        <td>51</td>
        <td>25</td>
        <td>12</td>
        <td>13</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf77cbc4efb6d2ffe2a8013041bf7e845500e499" class="src_link" title="app/models/demo.rb">app/models/demo.rb</a></td>
        <td class="red strong">68.97 %</td>
        <td>148</td>
        <td>29</td>
        <td>20</td>
        <td>9</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e011ef800f5e1d87894fe49a0081aeeb01608126" class="src_link" title="app/models/document.rb">app/models/document.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#ef84543fda098ceba08592e2aa82d64fcbc76ece" class="src_link" title="app/models/donation.rb">app/models/donation.rb</a></td>
        <td class="red strong">48.39 %</td>
        <td>169</td>
        <td>93</td>
        <td>45</td>
        <td>48</td>
        <td>1.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f89272d3c19c7e125fc9a83860df565a090edf7f" class="src_link" title="app/models/feature.rb">app/models/feature.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#8f07ef00117bd25fe4fb8a460b3cb4c551ad364a" class="src_link" title="app/models/gallery.rb">app/models/gallery.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#93d3293c53d6c1ba0cc6d601077a31fb8bac95f1" class="src_link" title="app/models/identity.rb">app/models/identity.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#27d6b1b2a541abe4aaeaa6b6cd9c83c2d046131f" class="src_link" title="app/models/marketing_info.rb">app/models/marketing_info.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c37fda3babeb25f451141a9dee6a0d89e7e3012b" class="src_link" title="app/models/membership.rb">app/models/membership.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>1.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#fbfd4573e7b0eb57b5b219dae14a14db95581016" class="src_link" title="app/models/merit/badge_rules.rb">app/models/merit/badge_rules.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>49</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#40ae1bfdb6620cd93ab66cab0f8ea194d33892ab" class="src_link" title="app/models/merit/point_rules.rb">app/models/merit/point_rules.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a045779eb7ee953910dad73120da50d61b63907a" class="src_link" title="app/models/merit/rank_rules.rb">app/models/merit/rank_rules.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5c83c4c07405e6769687dba17bf024869c469a1b" class="src_link" title="app/models/message.rb">app/models/message.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#8301edf857be2f017130177eebc87531b40c01f2" class="src_link" title="app/models/milestoneemail.rb">app/models/milestoneemail.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>4</td>
        <td>1</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#367cc70bc2b2d22fd447d018875601928b398cde" class="src_link" title="app/models/newsletter.rb">app/models/newsletter.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e0486abc22ee49268c5dfa9e82d11854f971b26b" class="src_link" title="app/models/perk.rb">app/models/perk.rb</a></td>
        <td class="red strong">58.33 %</td>
        <td>22</td>
        <td>12</td>
        <td>7</td>
        <td>5</td>
        <td>1.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#7e71d37e9dc15fdb7a94b8447432a08fc28c9ff1" class="src_link" title="app/models/plan.rb">app/models/plan.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>1.9</td>
      </tr>

      <tr>
        <td class="strong"><a href="#eb146565e98153485d2b79732a6fab6f4c090efa" class="src_link" title="app/models/plan_feature.rb">app/models/plan_feature.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#426e2c1456b61fd89d06cc55acac39c78105cd02" class="src_link" title="app/models/post.rb">app/models/post.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2cc4e13f808af585d2ae1b8d8f1c390aac30f9f3" class="src_link" title="app/models/press_coverage.rb">app/models/press_coverage.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f5c15ceeba743498e539e4524fc14a72c4376050" class="src_link" title="app/models/press_release.rb">app/models/press_release.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#014c541e6d1d272ebd4b5b43c214d2efba24d16f" class="src_link" title="app/models/project.rb">app/models/project.rb</a></td>
        <td class="red strong">33.48 %</td>
        <td>410</td>
        <td>227</td>
        <td>76</td>
        <td>151</td>
        <td>1.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#3970aa36c3b03c2727f492796eb4eb475e08c206" class="src_link" title="app/models/project_sponsor.rb">app/models/project_sponsor.rb</a></td>
        <td class="red strong">62.5 %</td>
        <td>37</td>
        <td>24</td>
        <td>15</td>
        <td>9</td>
        <td>3.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#fe2c4aaaca43837f5fac72036fd265cd8670f3ba" class="src_link" title="app/models/project_update.rb">app/models/project_update.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#3ad85f53c10aaf90e5b8a3e172ffbc3133b9cee2" class="src_link" title="app/models/question.rb">app/models/question.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#99e3b750911f5c7662b7fad707b34c9f1ea3ba57" class="src_link" title="app/models/sponsor.rb">app/models/sponsor.rb</a></td>
        <td class="red strong">37.14 %</td>
        <td>138</td>
        <td>70</td>
        <td>26</td>
        <td>44</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#80d05693ee375e25361bc832fb88405c290bd047" class="src_link" title="app/models/sponsorship_benefit.rb">app/models/sponsorship_benefit.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#b5255c665ff34637018857ff6b255787344d0ab3" class="src_link" title="app/models/sponsorship_level.rb">app/models/sponsorship_level.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#ad6c590b26c503ceebd35b1e1a7cbae68a7757ba" class="src_link" title="app/models/tax_report.rb">app/models/tax_report.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#901e1f9b5a6285915135f59fc9672548f6b78e6d" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
        <td class="red strong">39.13 %</td>
        <td>209</td>
        <td>115</td>
        <td>45</td>
        <td>70</td>
        <td>0.6</td>
      </tr>

    </tbody>
  </table>
</div>


          <div class="file_list_container" id="Mailers">
  <h2>
    <span class="group_name">Mailers</span>
    (<span class="covered_percent"><span class="red">27.53%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.28
       </span>
    </span> hits/line)
  </h2>
  <a name="Mailers"></a>
  <div>
    <b>10</b> files in total.
    <b>178</b> relevant lines.
    <span class="green"><b>49</b> lines covered</span> and
    <span class="red"><b>129</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="strong"><a href="#b0e247cd3d0aac6e4bfe6a650df91d36f548177f" class="src_link" title="app/mailers/contact_mailer.rb">app/mailers/contact_mailer.rb</a></td>
        <td class="red strong">37.5 %</td>
        <td>18</td>
        <td>8</td>
        <td>3</td>
        <td>5</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#1263879ab3b8855a469cf932fc43ee40f7e4050c" class="src_link" title="app/mailers/demo_request_mailer.rb">app/mailers/demo_request_mailer.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>10</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#53f530d65f7208d4d44cd9904134296d34097abd" class="src_link" title="app/mailers/donation_mailer.rb">app/mailers/donation_mailer.rb</a></td>
        <td class="red strong">18.18 %</td>
        <td>51</td>
        <td>33</td>
        <td>6</td>
        <td>27</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#9621a48ac3235c77d5788727b94cc12a4ca19725" class="src_link" title="app/mailers/milestone_mailer.rb">app/mailers/milestone_mailer.rb</a></td>
        <td class="red strong">44.44 %</td>
        <td>13</td>
        <td>9</td>
        <td>4</td>
        <td>5</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#abd76a0ef148022925435f30ac4d5963ef742a23" class="src_link" title="app/mailers/newsletter_mailer.rb">app/mailers/newsletter_mailer.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>10</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2212e3c9716f6cd23010c114c440122e6736b38a" class="src_link" title="app/mailers/project_mailer.rb">app/mailers/project_mailer.rb</a></td>
        <td class="red strong">22.22 %</td>
        <td>41</td>
        <td>27</td>
        <td>6</td>
        <td>21</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#6d2a4d35d3ce9a5bd895cc6857cb4a4f7ecdb322" class="src_link" title="app/mailers/question_mailer.rb">app/mailers/question_mailer.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>12</td>
        <td>9</td>
        <td>3</td>
        <td>6</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#76f50ef76b083474103e5128eab5a62b4896c8a7" class="src_link" title="app/mailers/sponsor_mailer.rb">app/mailers/sponsor_mailer.rb</a></td>
        <td class="red strong">18.18 %</td>
        <td>79</td>
        <td>55</td>
        <td>10</td>
        <td>45</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#7f5b84a83362c331ccfe7290cda16408249a4562" class="src_link" title="app/mailers/transparency_workroom_mailer.rb">app/mailers/transparency_workroom_mailer.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>11</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#afbbc86d6791a50a783319543a51b679199f7363" class="src_link" title="app/mailers/welcome_mailer.rb">app/mailers/welcome_mailer.rb</a></td>
        <td class="red strong">29.41 %</td>
        <td>31</td>
        <td>17</td>
        <td>5</td>
        <td>12</td>
        <td>0.3</td>
      </tr>

    </tbody>
  </table>
</div>


          <div class="file_list_container" id="Helpers">
  <h2>
    <span class="group_name">Helpers</span>
    (<span class="covered_percent"><span class="red">50.9%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         3.8
       </span>
    </span> hits/line)
  </h2>
  <a name="Helpers"></a>
  <div>
    <b>13</b> files in total.
    <b>277</b> relevant lines.
    <span class="green"><b>141</b> lines covered</span> and
    <span class="red"><b>136</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="strong"><a href="#675d841ad552c76d335195e789cab0597f03dd0d" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
        <td class="red strong">49.26 %</td>
        <td>249</td>
        <td>136</td>
        <td>67</td>
        <td>69</td>
        <td>5.9</td>
      </tr>

      <tr>
        <td class="strong"><a href="#59c94a4a12c07eb6dde0b0e13aff5f4704769bd7" class="src_link" title="app/helpers/devise_helper.rb">app/helpers/devise_helper.rb</a></td>
        <td class="red strong">42.86 %</td>
        <td>16</td>
        <td>7</td>
        <td>3</td>
        <td>4</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a32b941304031f144fb5a91339432086460a671e" class="src_link" title="app/helpers/donations_helper.rb">app/helpers/donations_helper.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#87399e82acb917bdbbc3e1081c004da716ab5509" class="src_link" title="app/helpers/identities_helper.rb">app/helpers/identities_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#5868eaabdab9a671171a5b3973ec890c2965e49c" class="src_link" title="app/helpers/mailer_helper.rb">app/helpers/mailer_helper.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>5</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#0565456c5539d347f0571190d89f295229db842f" class="src_link" title="app/helpers/memberships_helper.rb">app/helpers/memberships_helper.rb</a></td>
        <td class="red strong">32.0 %</td>
        <td>55</td>
        <td>25</td>
        <td>8</td>
        <td>17</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#df42ae8a85a5bb23564d48b9e2a75d821c2936ce" class="src_link" title="app/helpers/navigation_helper.rb">app/helpers/navigation_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>13.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#379787e76c6da5d84f17a7f1530847869608297d" class="src_link" title="app/helpers/pages_helper.rb">app/helpers/pages_helper.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>5</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#78611b50266244e79240ce286e4dc9d39b8cffaf" class="src_link" title="app/helpers/payment_helper.rb">app/helpers/payment_helper.rb</a></td>
        <td class="red strong">22.22 %</td>
        <td>18</td>
        <td>9</td>
        <td>2</td>
        <td>7</td>
        <td>0.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2196ab0203eaae2498e68fcf83d03c1a22d92024" class="src_link" title="app/helpers/projects_helper.rb">app/helpers/projects_helper.rb</a></td>
        <td class="red strong">57.78 %</td>
        <td>118</td>
        <td>45</td>
        <td>26</td>
        <td>19</td>
        <td>2.2</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f0ed26846a32ed31207c30f278e1128e963e78fe" class="src_link" title="app/helpers/sponsors/dashboard_helper.rb">app/helpers/sponsors/dashboard_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c801de131565edff2dd7b24ed0b9c9112bebaa74" class="src_link" title="app/helpers/sponsors_helper.rb">app/helpers/sponsors_helper.rb</a></td>
        <td class="red strong">51.85 %</td>
        <td>48</td>
        <td>27</td>
        <td>14</td>
        <td>13</td>
        <td>1.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#d937c9f16c10c0de3c4851bda5719bf06ff3ded8" class="src_link" title="app/helpers/users_helper.rb">app/helpers/users_helper.rb</a></td>
        <td class="red strong">69.23 %</td>
        <td>89</td>
        <td>13</td>
        <td>9</td>
        <td>4</td>
        <td>2.3</td>
      </tr>

    </tbody>
  </table>
</div>


          <div class="file_list_container" id="Libraries">
  <h2>
    <span class="group_name">Libraries</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line)
  </h2>
  <a name="Libraries"></a>
  <div>
    <b>0</b> files in total.
    <b>0.0</b> relevant lines.
    <span class="green"><b>0.0</b> lines covered</span> and
    <span class="red"><b>0.0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

    </tbody>
  </table>
</div>


          <div class="file_list_container" id="Ungrouped">
  <h2>
    <span class="group_name">Ungrouped</span>
    (<span class="covered_percent"><span class="red">33.24%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.34
       </span>
    </span> hits/line)
  </h2>
  <a name="Ungrouped"></a>
  <div>
    <b>25</b> files in total.
    <b>346</b> relevant lines.
    <span class="green"><b>115</b> lines covered</span> and
    <span class="red"><b>231</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="strong"><a href="#556ed61113e933ae8298e023a1658598a40dfe59" class="src_link" title="app/admin/admin_user.rb">app/admin/admin_user.rb</a></td>
        <td class="red strong">28.57 %</td>
        <td>20</td>
        <td>14</td>
        <td>4</td>
        <td>10</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#2361cd8b08c2c3e1acea3552d3907b94ca24b33a" class="src_link" title="app/admin/dashboard.rb">app/admin/dashboard.rb</a></td>
        <td class="red strong">12.12 %</td>
        <td>77</td>
        <td>33</td>
        <td>4</td>
        <td>29</td>
        <td>0.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#ed620f4484c406f42f313432b69f99d1d2222a2c" class="src_link" title="app/admin/demo.rb">app/admin/demo.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>

      <tr>
        <td class="strong"><a href="#816bf0f2f35cbc364196bae9f0585bb3374b0e22" class="src_link" title="app/admin/membership.rb">app/admin/membership.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>37</td>
        <td>21</td>
        <td>7</td>
        <td>14</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e29d3fa5c5ee4c9b883648f87f3cd3f62c858f2b" class="src_link" title="app/admin/project.rb">app/admin/project.rb</a></td>
        <td class="red strong">8.79 %</td>
        <td>126</td>
        <td>91</td>
        <td>8</td>
        <td>83</td>
        <td>0.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#344620363e81540f496f214e2e4d244e0d600c3e" class="src_link" title="app/admin/user.rb">app/admin/user.rb</a></td>
        <td class="red strong">37.5 %</td>
        <td>11</td>
        <td>8</td>
        <td>3</td>
        <td>5</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf12371121596006810fb66f6365843cc686eeec" class="src_link" title="app/mailer_previews/contact_mailer_preview.rb">app/mailer_previews/contact_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#123e75c980b7cf5f92874586382c294380f0dae0" class="src_link" title="app/mailer_previews/demo_request_mailer_preview.rb">app/mailer_previews/demo_request_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#38343f5929f28ca19a7ff97b38d1d2d86655bbe4" class="src_link" title="app/mailer_previews/donation_mailer_preview.rb">app/mailer_previews/donation_mailer_preview.rb</a></td>
        <td class="red strong">57.14 %</td>
        <td>16</td>
        <td>7</td>
        <td>4</td>
        <td>3</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#46a3fc2dfe7e14e3e87e77f631598f6cac519d9c" class="src_link" title="app/mailer_previews/milestone_mailer_preview.rb">app/mailer_previews/milestone_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c624cfe5f3673105a2a3d86e3247ea9dac077424" class="src_link" title="app/mailer_previews/newsletter_mailer_preview.rb">app/mailer_previews/newsletter_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e8f98f95e47f0d2f8f4c2a287fc4ff6f06e3072c" class="src_link" title="app/mailer_previews/project_mailer_preview.rb">app/mailer_previews/project_mailer_preview.rb</a></td>
        <td class="red strong">57.14 %</td>
        <td>16</td>
        <td>7</td>
        <td>4</td>
        <td>3</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c651b9e6cb3588366f4ae47839b3c4c6be41cae8" class="src_link" title="app/mailer_previews/question_mailer_preview.rb">app/mailer_previews/question_mailer_preview.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>6</td>
        <td>3</td>
        <td>2</td>
        <td>1</td>
        <td>0.7</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a077b9593ac724b81cfa81a6dd130c5a959510d2" class="src_link" title="app/mailer_previews/sponsor_mailer_preview.rb">app/mailer_previews/sponsor_mailer_preview.rb</a></td>
        <td class="red strong">55.56 %</td>
        <td>21</td>
        <td>9</td>
        <td>5</td>
        <td>4</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#a1feffab53e2b345b62a36cac554e7b4a6009659" class="src_link" title="app/mailer_previews/welcome_mailer_preview.rb">app/mailer_previews/welcome_mailer_preview.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>21</td>
        <td>10</td>
        <td>5</td>
        <td>5</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#248deb0cfd0ad48f9bd072f78e737130d47486b0" class="src_link" title="app/services/gateway/base_service.rb">app/services/gateway/base_service.rb</a></td>
        <td class="red strong">54.55 %</td>
        <td>23</td>
        <td>11</td>
        <td>6</td>
        <td>5</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c59123810d052eeb2c9cba2800711fdcdf6faec1" class="src_link" title="app/services/gateway/cards_service.rb">app/services/gateway/cards_service.rb</a></td>
        <td class="red strong">33.33 %</td>
        <td>19</td>
        <td>9</td>
        <td>3</td>
        <td>6</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e6fc991cf5749b5c80d306c061bc3610ab37ed77" class="src_link" title="app/services/gateway/customer_service.rb">app/services/gateway/customer_service.rb</a></td>
        <td class="red strong">42.86 %</td>
        <td>14</td>
        <td>7</td>
        <td>3</td>
        <td>4</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#d19292acdc58db56c1cc616d9522c8eba85cee43" class="src_link" title="app/services/gateway/plans_service.rb">app/services/gateway/plans_service.rb</a></td>
        <td class="red strong">28.57 %</td>
        <td>50</td>
        <td>28</td>
        <td>8</td>
        <td>20</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#501003b58a9cdaedd52f211d748398104ed9ad15" class="src_link" title="app/services/subscription_service.rb">app/services/subscription_service.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>15</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>0.8</td>
      </tr>

      <tr>
        <td class="strong"><a href="#cf6840928b0c230fde4fe34b1caae49d23c919a8" class="src_link" title="app/services/worksheet/base.rb">app/services/worksheet/base.rb</a></td>
        <td class="red strong">38.89 %</td>
        <td>33</td>
        <td>18</td>
        <td>7</td>
        <td>11</td>
        <td>0.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f862985a47e78b58fe5aecbe684cc5557e3b0144" class="src_link" title="app/services/worksheet/donors.rb">app/services/worksheet/donors.rb</a></td>
        <td class="red strong">58.33 %</td>
        <td>28</td>
        <td>12</td>
        <td>7</td>
        <td>5</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#99efbd4197005b7d330aacecb21d9d59ffb57790" class="src_link" title="app/services/worksheet/sponsors.rb">app/services/worksheet/sponsors.rb</a></td>
        <td class="red strong">53.33 %</td>
        <td>34</td>
        <td>15</td>
        <td>8</td>
        <td>7</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#151d00deba20d09927071f991cbfdfec5da2351d" class="src_link" title="app/services/xls_service.rb">app/services/xls_service.rb</a></td>
        <td class="red strong">47.06 %</td>
        <td>33</td>
        <td>17</td>
        <td>8</td>
        <td>9</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#00031ce59e4062aef510bd5632cb3d3beb920e52" class="src_link" title="app/workers/second_test.rb">app/workers/second_test.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>11</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>0.7</td>
      </tr>

    </tbody>
  </table>
</div>


      </div>

      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.8.2
        and simplecov-html v0.8.0<br/>
        using RSpec
      </div>

      <div class="source_files">

        <div class="source_table" id="556ed61113e933ae8298e023a1658598a40dfe59">
  <div class="header">
    <h3>app/admin/admin_user.rb</h3>
    <h4><span class="red">28.57 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">ActiveAdmin.register AdminUser do</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  index do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    column :email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    column :current_sign_in_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    column :last_sign_in_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    column :sign_in_count</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    default_actions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  filter :email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  form do |f|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    f.inputs &quot;Admin Details&quot; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">      f.input :email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">      f.input :password</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">      f.input :password_confirmation</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    f.actions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="2361cd8b08c2c3e1acea3552d3907b94ca24b33a">
  <div class="header">
    <h3>app/admin/dashboard.rb</h3>
    <h4><span class="red">12.12 %</span> covered</h4>
    <div>
      <b>33</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>29</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">ActiveAdmin.register_page &quot;Dashboard&quot; do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  menu :priority =&gt; 1, :label =&gt; proc{ I18n.t(&quot;active_admin.dashboard&quot;) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  content :title =&gt; proc{ I18n.t(&quot;active_admin.dashboard&quot;) } do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    div :class =&gt; &quot;blank_slate_container&quot;, :id =&gt; &quot;dashboard_default_message&quot; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">      span :class =&gt; &quot;blank_slate&quot; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">        span I18n.t(&quot;active_admin.dashboard_welcome.welcome&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">        small I18n.t(&quot;active_admin.dashboard_welcome.call_to_action&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">    # Here is an example of a simple dashboard with columns and panels.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">    # columns do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    #   column do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    #     panel &quot;Recent Posts&quot; do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">    #       ul do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    #         Post.recent(5).map do |post|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">    #           li link_to(post.title, admin_post_path(post))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">    #         end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">    #       end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    #     end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">    #   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">    #   column do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    #     panel &quot;Info&quot; do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">    #       para &quot;Welcome to ActiveAdmin.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">    #     end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    #   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">    # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end # content</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  content do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    columns do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">      column :class =&gt; &#39;projects-container&#39; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">        unless Project.where(ready_for_approval: 1).count == 0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">          panel &quot;Projects Ready For Approval&quot; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">            ul do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">              Project.where(ready_for_approval: 1).each do |project|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">                li link_to(project.title, admin_project_path(project))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">              end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">            end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">          end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">        panel &quot;Recent Demo Requests (5)&quot; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">          ul do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">            Demo.limit(5).each do |demo|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">              li link_to(demo.organization, admin_demo_path(demo))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">            end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">          end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">      column :class =&gt; &#39;projects-container&#39; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">        panel &quot;Sign Ups&quot; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">          h4 do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">            text_node &quot;Fee Plan (&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">            text_node link_to Membership.includes(:plan).where(:plans =&gt; {:name =&gt; &#39;fee&#39;}).count, admin_memberships_path(scope: &#39;fee&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">            text_node &quot;)&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">          end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">          h4 do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">            text_node &quot;Basic Plan (&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">            text_node link_to Membership.joins(:plan).where(:plans =&gt; {:name =&gt; &#39;basic&#39;}).count, admin_memberships_path(scope: &#39;basic&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">            text_node &quot;)&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">          end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="67">


          <code class="ruby">          h4 do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">            text_node &quot;Plus Plan (&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="69">


          <code class="ruby">            text_node link_to Membership.joins(:plan).where(:plans =&gt; {:name =&gt; &#39;plus&#39;}).count, admin_memberships_path(scope: &#39;plus&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">            text_node &quot;)&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">          end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="ed620f4484c406f42f313432b69f99d1d2222a2c">
  <div class="header">
    <h3>app/admin/demo.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">ActiveAdmin.register Demo do</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  actions :all, :except =&gt; [:destroy]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="816bf0f2f35cbc364196bae9f0585bb3374b0e22">
  <div class="header">
    <h3>app/admin/membership.rb</h3>
    <h4><span class="red">33.33 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">ActiveAdmin.register Membership do</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  menu :label =&gt; &quot;Customers&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  actions :all, :except =&gt; [:destroy]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  index do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    column :id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    column :name do |membership|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">      &quot;#{membership.user.first_name.capitalize} #{membership.user.last_name.capitalize}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    column :organization do |membership|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      membership.user.organization.capitalize if membership.user.organization</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    column :plan do |membership|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">      membership.plan.try(:name).try(:capitalize)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    column :email do |membership|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      link_to membership.user.email, &quot;mailto:#{membership.user.email}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    column :signed_up do |membership|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      membership.created_at.strftime(&quot;%d %b %Y at %I:%M %p&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  scope :fee do |memberships|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    memberships.joins(:plan).where(:plans =&gt; {:name =&gt; &#39;fee&#39;})</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  scope :basic do |memberships|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    memberships.joins(:plan).where(:plans =&gt; {:name =&gt; &#39;basic&#39;})</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  scope :plus do |memberships|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    memberships.joins(:plan).where(:plans =&gt; {:name =&gt; &#39;plus&#39;})</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="e29d3fa5c5ee4c9b883648f87f3cd3f62c858f2b">
  <div class="header">
    <h3>app/admin/project.rb</h3>
    <h4><span class="red">8.79 %</span> covered</h4>
    <div>
      <b>91</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>83</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">ActiveAdmin.register Project do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  actions :all, :except =&gt; [:destroy]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  index do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    column :project_title do |project|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">      link_to project.project_title, admin_project_path(project)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    default_actions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  show do |project|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    attributes_table do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">      row :large_image do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">        image_tag(&quot;#{project.large_image}/convert?w=500&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      row :project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">      row :organization</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">      row :organization_classification</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      row :description</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      row :duration do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">        project.duration + &quot; days&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">      row :goal do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">        number_to_currency project.goal</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      row :partial_funding</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">      row :address</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">      row :city do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">        project.city.capitalize</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">      row :state</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">      row :zip</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">      row :category</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">      row :website</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">      row :twitter_handle</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">      row :facebook_page</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">      row :title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">      row :short_description</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">      row :sponsorship_permission</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">      row :perk_permission</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">      row :status</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">      row :seed_video</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">      row :story</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">      row :about</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">      row :seed_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">      row :cultivation_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">      row :organization_type</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">      row :cultivation_video</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">      row :campaign_deadline</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">      row :sponsor_permission</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">      row :live</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">    active_admin_comments</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>

          <code class="ruby">  form do |f|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="67">


          <code class="ruby">    f.inputs &quot;Project Details&quot; do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">      f.input :category, :as =&gt; :select, :collection =&gt; project_categories, prompt: &#39;Select a Category&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="69">


          <code class="ruby">      f.input :description</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">      f.input :duration</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="71">


          <code class="ruby">      f.input :goal</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="72">


          <code class="ruby">      f.input :address</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="73">


          <code class="ruby">      f.input :project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="74">


          <code class="ruby">      f.input :sponsorship_permission</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">      f.input :city</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="77">


          <code class="ruby">      f.input :state, :as =&gt; :select, :collection =&gt; us_states, prompt: &#39;Choose a state&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="78">


          <code class="ruby">      f.input :zip</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="79">


          <code class="ruby">      f.input :neighborhood</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="80">


          <code class="ruby">      f.input :title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="81">


          <code class="ruby">      f.input :live</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="82">


          <code class="ruby">      f.input :short_description</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="83">


          <code class="ruby">      f.input :perk_permission</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">      f.input :status</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">      f.input :organization</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="87">


          <code class="ruby">      f.input :website</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="88">


          <code class="ruby">      f.input :twitter_handle</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">      f.input :facebook_page</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="90">


          <code class="ruby">      f.input :seed_video</code>
        </li>

        <li class="never" data-hits="" data-linenumber="91">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="92">


          <code class="ruby">      f.input :story</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="93">


          <code class="ruby">      f.input :about</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">      f.input :large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="95">


          <code class="ruby">      f.input :seed_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="96">


          <code class="ruby">      f.input :cultivation_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">      f.input :ready_for_approval</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="98">


          <code class="ruby">      f.input :organization_type, :as =&gt; :select, :collection =&gt; project_org_type, prompt: &#39;Select a Type&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="99">


          <code class="ruby">      f.input :cultivation_mime_type</code>
        </li>

        <li class="never" data-hits="" data-linenumber="100">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="101">


          <code class="ruby">      f.input :organization_classification, :as =&gt; :select, :collection =&gt; project_org_class, prompt: &#39;Select a Classification&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="102">


          <code class="ruby">      f.input :cultivation_video</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="103">


          <code class="ruby">      f.input :campaign_deadline</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="104">


          <code class="ruby">      f.input :sponsor_permission</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="105">


          <code class="ruby">      f.input :step</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="106">


          <code class="ruby">      f.input :seed_mime_type</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="107">


          <code class="ruby">      f.input :partial_funding</code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="109">


          <code class="ruby">    f.actions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="111">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>

          <code class="ruby">  action_item :only =&gt; :show do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">    link_to(&#39;Approve Project&#39;, approve_project_admin_project_path(project), :method =&gt; :post) if project.ready_for_approval == 1</code>
        </li>

        <li class="never" data-hits="" data-linenumber="114">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="115">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>

          <code class="ruby">  member_action :approve_project, :method =&gt; :post do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="117">


          <code class="ruby">    # Just a regular controller method in here</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="118">


          <code class="ruby">    project = Project.find params[:id]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="119">


          <code class="ruby">    project.approve!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="120">


          <code class="ruby">    redirect_to :back, :notice =&gt; &quot;Project Approved&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="121">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="122">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>

          <code class="ruby">  scope :unapproved do |projects|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="124">


          <code class="ruby">    projects.where(&#39;ready_for_approval = ?&#39;, 1)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="125">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="344620363e81540f496f214e2e4d244e0d600c3e">
  <div class="header">
    <h3>app/admin/user.rb</h3>
    <h4><span class="red">37.5 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">ActiveAdmin.register User do</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  actions :all, :except =&gt; [:destroy]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  index do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    column :email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    column :first_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    column :last_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    column :telephone</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    default_actions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="5f8a40195ce45308d6356e9e539fa5754beef394">
  <div class="header">
    <h3>app/controllers/admin_controller.rb</h3>
    <h4><span class="red">42.11 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class AdminController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">  # http_basic_authenticate_with :name =&gt; &quot;frodo&quot;, :password =&gt; &quot;thering&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  # before_filter :authenticate_user!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  authorize_resource :class =&gt; false</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  skip_before_filter :verify_authenticity_token</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  layout :layout_by_resource</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def unapproved</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @unapproved_projects = Project.where(:ready_for_approval =&gt; 1).page(params[:page]).per(20)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def approve</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    if params[&#39;approved&#39;] == &quot;true&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">      newData = &quot;Success&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">      project = Project.find_by_id(params[&#39;id&#39;])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">      project.approve!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      newData = &quot;Failure&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      format.js { render :json =&gt; newData.to_json }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  def deny</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    project = Project.find(params[:id]).destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    redirect_to admin_unapproved_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def layout_by_resource</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    &#39;admin&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">  # private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">  # def admin_required!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">  #   unless current_user.role == &quot;admin&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  #     flash[:error] = &quot;Sorry, you don&#39;t have the right permissions to access this page.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  #     redirect_to root_url and return false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">  #   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">  # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="a845ccee818c59c170e1572f78f556567f3d85df">
  <div class="header">
    <h3>app/controllers/application_controller.rb</h3>
    <h4><span class="red">69.05 %</span> covered</h4>
    <div>
      <b>42</b> relevant lines.
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ApplicationController &lt; ActionController::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  protect_from_forgery</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  set_current_tenant_through_filter</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  layout :layout_by_resource</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :last_url, :session_email_forgot_password, :additional_information,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">                :get_current_tenant</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  # rescue_from ActionController::RoutingError, with: :render404</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  def after_sign_in_path_for(resource, params=nil)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    return new_user_payment_method_path(current_user, plan_id: params[:sign_in_plan]) if params &amp;&amp; params[:sign_in_plan]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    if session[:redirect_url] == new_project_url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">      User.set_redirect_path</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    elsif session[:redirect_url] == user_registration_url || request.referer.nil? || request.referer.start_with?(edit_user_password_url) || session[:redirect_url] == root_url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">      root_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      stored_location_for(resource) || request.referer || session[:redirect_url]  ||  request.env[&#39;omniauth.origin&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>

          <code class="ruby">  def last_url</code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="23">
          <span class="hits">47</span>

          <code class="ruby">    url = request.url.split(&quot;/&quot;).last</code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="24">
          <span class="hits">47</span>

          <code class="ruby">    unless params[:controller].eql?(&quot;registrations&quot;)</code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="25">
          <span class="hits">47</span>

          <code class="ruby">      session[:redirect_url_last] = session[:redirect_url]</code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="26">
          <span class="hits">47</span>

          <code class="ruby">      session[:redirect_url] = request.url if !url.eql?(&quot;sign_in&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def session_email_forgot_password</code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="31">
          <span class="hits">47</span>

          <code class="ruby">      session[:email_forgot_password] = params[:user][:email] if params[:user]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>

          <code class="ruby">  def additional_information</code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="35">
          <span class="hits">47</span>

          <code class="ruby">    @email_users = User.pluck :email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>

          <code class="ruby">  def video_data_by_link(link)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">    youtube_client = YouTubeIt::Client.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    youtube_client.video_by(link)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">  def not_found</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">    raise ActionController::RoutingError.new(&#39;Not Found&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  def render404</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    render :file =&gt; &#39;public/404.html&#39;, status: 404, layout: false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>

          <code class="ruby">  protected</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>

          <code class="ruby">  def layout_by_resource</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="54">
          <span class="hits">7</span>

          <code class="ruby">    &quot;application&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>

          <code class="ruby">  def set_session_wizard</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="58">
          <span class="hits">9</span>

          <code class="ruby">    session[:step] = nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>

          <code class="ruby">  def get_projects</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">    @user = User.find(params[:user_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">    comparison = params[:status].eql?(&quot;Funding Active&quot;) ? &quot;&gt;&quot; : &quot;&lt;&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">    @projects_created = @user.projects.where(&quot;campaign_deadline #{comparison} ? AND live = 1&quot;, Time.now).order(&quot;updated_at DESC&quot;).page(params[:created_page]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>

          <code class="ruby">  def get_current_tenant</code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="70">
          <span class="hits">47</span>

          <code class="ruby">    return unless current_user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="45" data-linenumber="72">
          <span class="hits">45</span>

          <code class="ruby">    current_account = current_user.account</code>
        </li>

        <li class="covered" data-hits="45" data-linenumber="73">
          <span class="hits">45</span>

          <code class="ruby">    set_current_tenant(current_account)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="681d294c2edd32bd1776b87b76af7e32504e2ce5">
  <div class="header">
    <h3>app/controllers/authentications_controller.rb</h3>
    <h4><span class="red">31.58 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class AuthenticationsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_previous_page</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  def facebook</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    omni = request.env[&quot;omniauth.auth&quot;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    authentication = Authentication.find_by_provider_and_uid(omni[&#39;provider&#39;], omni[&#39;uid&#39;])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    if authentication</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      flash[:notice] = &quot;Logged in Successfully&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">      sign_in_and_redirect User.find(authentication.user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    elsif current_user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      token = omni[&#39;credentials&#39;].token</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      token_secret = omni[&#39;credentials&#39;].secret</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">      current_user.authentications.create!(:provider =&gt; omni[&#39;provider&#39;], :uid =&gt; omni[&#39;uid&#39;], :token =&gt; token, :token_secret =&gt; token_secret)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">      flash[:notice] = &quot;Authentication successful.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">      sign_in_and_redirect current_user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      @user = User.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">      @user.create_facebook_user(omni)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="6113b80be33e3081111889b24e25d3ebb6e042a0">
  <div class="header">
    <h3>app/controllers/comments_controller.rb</h3>
    <h4><span class="red">22.22 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class CommentsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">	def create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">		post = Post.find(params[:comment][:post_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">		comment = post.comments.build(params[:comment])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">		comment.user_id = current_user.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">		if comment.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">	      flash[:notice] = &quot;Successfully created post.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">	      redirect_to :back</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">	    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">	      flash[:error] = &quot;Error adding comment.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">	    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="fa391ca21b0484a94610215d091a34e615988141">
  <div class="header">
    <h3>app/controllers/demo_request_controller.rb</h3>
    <h4><span class="red">33.33 %</span> covered</h4>
    <div>
      <b>30</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>20</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class DemoRequestController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &quot;landing&quot;, only: [:thank_you]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    if current_user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">      @demo = Demo.create_for_user(current_user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">      redirect_to demo_request_organization_path(@demo)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">      @demo = Demo.new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @demo = Demo.new(params[:demo])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    if @demo.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">      redirect_to demo_request_organization_path(@demo)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      render :new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    @demo = Demo.find(params[:id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    @demo = Demo.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    if @demo.update_attributes(params[:demo])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      redirect_to demo_request_organization_path(@demo)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">      render :edit</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>

          <code class="ruby">  def organization</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    @demo = Demo.find(params[:demo_request_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def organization_update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    @demo = Demo.find(params[:demo_request_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    if @demo.update_attributes(params[:demo])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">      DemoRequestMailer.scheduled_demo_confirmation(@demo).deliver</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">      redirect_to demo_request_thank_you_path(@demo)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">      render :organization</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>

          <code class="ruby">  def thank_you</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>

          <code class="ruby">  def whitepaper</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">    send_file &#39;public/whitepaper.pdf&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="62377441b41c9c08a0b5228120c5a0a9c6bf1184">
  <div class="header">
    <h3>app/controllers/donation_steps_controller.rb</h3>
    <h4><span class="red">60.0 %</span> covered</h4>
    <div>
      <b>45</b> relevant lines.
      <span class="green"><b>27</b> lines covered</span> and
      <span class="red"><b>18</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class DonationStepsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  include Wicked::Wizard</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  steps :confirmation, :thank_you</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_session_page</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  def show</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="7">
          <span class="hits">3</span>

          <code class="ruby">    if session[:donation_id]</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="8">
          <span class="hits">3</span>

          <code class="ruby">      @donation = Donation.unscoped.find(session[:donation_id])</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="9">
          <span class="hits">3</span>

          <code class="ruby">      @project = @donation.project</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>

          <code class="ruby">      @card_type = session[:card_type]</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>

          <code class="ruby">      @card_last4 = session[:card_last4]</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="12">
          <span class="hits">3</span>

          <code class="ruby">      @need_doctype = true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>

          <code class="ruby">      if session[:perk_type].eql?(&quot;default&quot;)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>

          <code class="ruby">        @perk = Perk.new</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>

          <code class="ruby">        @perk.get_perk_name(session[:payment_amount])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>

          <code class="ruby">        if session[:payment_amount].to_s.split(&quot;.&quot;)[1].eql?(&quot;0&quot;)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>

          <code class="ruby">          @perk.description = &quot;You will receive #{session[:payment_amount].to_i} Uruut Reward Points when you seed $#{session[:payment_amount].to_i}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">          @perk.description = &quot;You will receive #{session[:payment_amount].to_i} Uruut Reward Points when you seed $#{session[:payment_amount].to_f}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">        @perk = Perk.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">        @perk.name = @donation.perk_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">        @perk.amount = @donation.amount</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">        if @perk.amount.to_s.split(&quot;.&quot;)[1].eql?(&quot;0&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">          @perk.description = &quot;You will receive #{@perk.amount.to_i} Uruut Reward Points when you seed $#{@perk.amount.to_i}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">          @perk.description = &quot;You will receive #{@perk.amount.to_i} Uruut Reward Points when you seed $#{@perk.amount.to_f}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>

          <code class="ruby">      session[:donation_thank_you] = {</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">        amount: @donation.amount,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">        project_id: @project.id,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">        project_large_image: @project.large_image,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">        project_bitly: @project.bitly,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">        project_title: @project.project_title,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">        project_category: @project.category,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">        perk_name: @perk.name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">        perk_description: @perk.description</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">      }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="45">
          <span class="hits">3</span>

          <code class="ruby">      render_wizard</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">      redirect_to root_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="49">
          <span class="hits">3</span>

          <code class="ruby">    session.except!(:donation_id, :card_token, :perk_id) if step == :thank_you</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>

          <code class="ruby">    @donation = Donation.unscoped.find(session[:donation_id])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>

          <code class="ruby">    @donation.token = session[:card_token]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>

          <code class="ruby">    if @donation.save_with_payment</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">      donate_badge = Merit::Badge.new(id:3, name:&quot;Project donation badge&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">      if !current_user.badges.include?(donate_badge)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">        current_user.add_badge(3)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">      perk = Perk.where(project_id: session[:project_id_of_perk_selected], amount: session[:payment_amount]).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">      if !perk.nil? &amp;&amp; perk.limit? &amp;&amp; perk.perks_available.to_i &gt; 0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">        new_perk_available = perk.perks_available.to_i - 1</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">        perk.update_attributes!(perks_available: new_perk_available)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">      current_user.update_attributes!(uruut_point: current_user.uruut_point.to_i + session[:payment_amount].to_i)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="66">


          <code class="ruby">      session.delete(:perk_amount)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby">      # Donation.send_confirmation_email(@donation)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">      redirect_to wizard_path(:thank_you)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>

          <code class="ruby">      redirect_to wizard_path(:confirmation)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>

          <code class="ruby">  def set_session_page</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="77">
          <span class="hits">6</span>

          <code class="ruby">    session[:page_active] = &quot;project&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="35194221aa7425b146793467aebb6cc6cd050990">
  <div class="header">
    <h3>app/controllers/donations_controller.rb</h3>
    <h4><span class="red">35.94 %</span> covered</h4>
    <div>
      <b>128</b> relevant lines.
      <span class="green"><b>46</b> lines covered</span> and
      <span class="red"><b>82</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;open-uri&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">class DonationsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  skip_before_filter :verify_authenticity_token, only: :default_perk</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">	before_filter :authenticate_user!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_session_page, :set_session_wizard, :set_previous_path_for_registration</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  layout &quot;landing&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @donation = Donation.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    @perk = Perk.find(params[:perk])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @perk_name = params[:name].to_s</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    @perk_amount = params[:amount].gsub(&quot;,&quot;, &quot;&quot;).to_f</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @perk_description = params[:description]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    @perks = @project.perks.order(:amount).map{ |perk| [perk.name, perk.amount.to_i] }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    session[:perk_id] = params[:perk]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def default_perk</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="21">
          <span class="hits">3</span>

          <code class="ruby">    @donation = Donation.new</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>

          <code class="ruby">    @perk = Perk.new</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="23">
          <span class="hits">3</span>

          <code class="ruby">    @perk_name = params[:name].to_s</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="24">
          <span class="hits">3</span>

          <code class="ruby">    @perk_amount = params[:amount].gsub(&quot;,&quot;, &quot;&quot;).to_f</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="25">
          <span class="hits">3</span>

          <code class="ruby">    @perk_description = params[:description]</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>

          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="27">
          <span class="hits">3</span>

          <code class="ruby">    if params[:amount].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">      @perks = @project.perks.order(:amount).map{ |perk| [perk.name, perk.amount.to_i] }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      session[:perk_id] = &quot;custom_donate&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>

          <code class="ruby">      perks = Donation.set_perks(@project)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="32">
          <span class="hits">3</span>

          <code class="ruby">      @perks = Donation.reorder_perks(perks, @perk_amount)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>

          <code class="ruby">      @perk_name_selected, @perk_description = Donation.get_perk_info(@project, @perk_amount, @perks)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>

          <code class="ruby">      session[:perk_id] = Donation.set_perk_id(@perks, @project)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>

          <code class="ruby">    render :new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def change_perk</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    if !params[:id].eql?(&quot;custom&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">      if params[&quot;amount&quot;].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">        @perk = Perk.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">        @project = Project.find(params[&quot;project_id&quot;])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">        session[:perk_id] = @perk.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">        session[:perk_amount] = @perk.amount.to_f</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">        @perk_description = @perk.description</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">        @perk = Perk.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">        @perk.id = params[&quot;level&quot;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">        @perk.amount = params[&quot;amount&quot;].gsub(&quot;,&quot;, &quot;&quot;).to_f</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">        session[:perk_amount] = @perk.amount.to_f</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="52">


          <code class="ruby">        @project = Project.find(params[&quot;project_id&quot;])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">        perks = Donation.set_perks(@project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">        @perks = Donation.reorder_perks(perks, @perk.amount)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">        @perk_name_selected = @perks.last[0]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">        @perk_description = @perks.last[3]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">        if @project.perk_permission</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">          session[:perk_id] = @perks.last[2]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">          session[:perk_id] = @perks.last[0]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">        end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">        @perk.name = &quot;Level #{@perk.id}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">        @perk.description = &quot;You will receive #{@perk.amount.to_i} Uruut Reward Points when you seed $#{@perk.amount.to_i}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="67">


          <code class="ruby">      @perk = Perk.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">      @perk.id = params[&quot;level&quot;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="69">


          <code class="ruby">      @perk.amount = params[&quot;custom_seed&quot;].gsub(&quot;,&quot;, &quot;&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">      @project = Project.find(params[&quot;project_id&quot;])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="72">


          <code class="ruby">      perks = Donation.set_perks(@project)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="74">


          <code class="ruby">      @perks = Donation.reorder_perks(perks, @perk.amount)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">      @perk_name_selected, @perk_description = Donation.get_perk_info(@project, @perk.amount, @perks)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="78">


          <code class="ruby">      session[:perk_id] = Donation.set_perk_id(@perks, @project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="79">


          <code class="ruby">      session[:perk_amount] = @perk.amount.to_f</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="80">


          <code class="ruby">      @perk.name = &quot;Custom&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="81">


          <code class="ruby">      @perk.description = &quot;You will receive #{@perk.amount} Uruut Reward Points when you seed $#{@perk.amount}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="86">
          <span class="hits">2</span>

          <code class="ruby">    if params[:perk_type].eql?(&quot;default&quot;)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>

          <code class="ruby">      params[:donation][:description] = &quot;#{params[:donation][:amount].to_i} Uruut Reward Points&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="88">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">      params[:donation][:description] = params[:perk_description]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="90">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="91">
          <span class="hits">2</span>

          <code class="ruby">    params[:donation][:perk_name] = params[:name_of_perk]</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="92">
          <span class="hits">2</span>

          <code class="ruby">    logger.debug params[:donation].to_yaml</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="93">
          <span class="hits">2</span>

          <code class="ruby">    @donation = Donation.new(params[:donation])</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="94">
          <span class="hits">2</span>

          <code class="ruby">    @donation.confirmed = false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="96">
          <span class="hits">2</span>

          <code class="ruby">    if @donation.save</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="97">
          <span class="hits">2</span>

          <code class="ruby">      session.merge!(:donation_id =&gt; @donation.id, :card_token =&gt; @donation.token, :card_type =&gt; @donation.card_type,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby">                     :card_last4 =&gt; @donation.card_last4)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="99">
          <span class="hits">2</span>

          <code class="ruby">      session[:perk_type] = params[:perk_type]</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="100">
          <span class="hits">2</span>

          <code class="ruby">      session[:payment_amount] = params[:donation][:amount]</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="101">
          <span class="hits">2</span>

          <code class="ruby">      session[:project_id_of_perk_selected] = params[:donation][:project_id]</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="102">
          <span class="hits">2</span>

          <code class="ruby">      session[:perk_amount] = params[:donation][:amount]</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="103">
          <span class="hits">2</span>

          <code class="ruby">      redirect_to donation_steps_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="105">


          <code class="ruby">      render :new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="106">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="107">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="111">


          <code class="ruby">    @donation = Donation.unscoped.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="112">


          <code class="ruby">    @project = @donation.project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">    perks = @project.perks.order(:amount).map{ |perk| [perk.name, perk.amount.to_i, perk.id] }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="114">


          <code class="ruby">    @perks = []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="115">


          <code class="ruby">    perks.each do |perk|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="116">


          <code class="ruby">      if perk[1].to_f &lt;= @donation.amount.to_f</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="117">


          <code class="ruby">        @perks.push(perk)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="119">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="120">


          <code class="ruby">    @perk_name_selected = @donation.perk_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="121">


          <code class="ruby">    @donation.save!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="122">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>

          <code class="ruby">  def set_new_perk</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">    perk = Perk.where(name: params[:perk_name], project_id: params[:project_id]).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="126">


          <code class="ruby">    @perk_name_selected = perk.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="127">


          <code class="ruby">    @perk_description = perk.description</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="128">


          <code class="ruby">    if perk.nil?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="129">


          <code class="ruby">      session[:perk_id] = params[:name_of_perk]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="130">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="131">


          <code class="ruby">      session[:perk_id] = perk.id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="132">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="133">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="134">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="135">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="137">


          <code class="ruby">    @donation = Donation.unscoped.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="138">


          <code class="ruby">    session[:card_last4] = params[:donation][:card_last4]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="139">


          <code class="ruby">    session[:card_type] = params[:donation][:card_type]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="140">


          <code class="ruby">    params[:donation][:perk_name] = params[:name_of_perk]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="141">


          <code class="ruby">    params[:donation][:amount] = session[:perk_amount]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="142">


          <code class="ruby">    params[:donation][:description] = params[:perk_description]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="143">


          <code class="ruby">    session[:payment_amount] = params[:donation][:amount]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="144">


          <code class="ruby">    current_user.update_attributes!(uruut_point: session[:payment_amount])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="145">


          <code class="ruby">    if params[:donation][:amount].is_a?(String)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="146">


          <code class="ruby">      params[:donation][:amount] = params[:donation][:amount].gsub(&#39;$&#39;, &#39;&#39;).gsub(&#39;,&#39;, &#39;&#39;).to_f</code>
        </li>

        <li class="never" data-hits="" data-linenumber="147">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="148">


          <code class="ruby">    if @donation.update_attributes(params[:donation])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="149">


          <code class="ruby">     flash[:notice] = &quot;Successfully updated donation.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="150">


          <code class="ruby">   end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="151">


          <code class="ruby">   redirect_to donation_steps_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="152">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="153">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>

          <code class="ruby">  def more_donators</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="155">


          <code class="ruby">    @project = Project.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="156">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="157">


          <code class="ruby">      format.html { redirect_to project_url(@project), notice: &quot;successfully&quot; }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="158">


          <code class="ruby">      format.js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="159">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="160">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="161">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="162">
          <span class="hits">1</span>

          <code class="ruby">  def thank_you</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="163">


          <code class="ruby">    @need_doctype = true</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="164">


          <code class="ruby">    @thanks_url = URI.encode(session[:donation_thank_you][:project_bitly])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="165">


          <code class="ruby">    render :layout =&gt; &quot;application&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="166">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="167">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>

          <code class="ruby">  def share_email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="169">


          <code class="ruby">    DonationMailer.share_project(params[:emails], params[:project_id], params[:user_id]).deliver</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="170">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="171">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="172">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="173">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="174">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>

          <code class="ruby">  def set_session_page</code>
        </li>

        <li class="covered" data-hits="5" data-linenumber="176">
          <span class="hits">5</span>

          <code class="ruby">    session[:page_active] = &quot;project&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="177">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="178">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="179">
          <span class="hits">1</span>

          <code class="ruby">  def set_previous_path_for_registration</code>
        </li>

        <li class="covered" data-hits="5" data-linenumber="180">
          <span class="hits">5</span>

          <code class="ruby">    session[:path] = params[:url]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="181">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="182">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="183">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="6d796903ab77a5c0c130f455ad3be2fd660ca286">
  <div class="header">
    <h3>app/controllers/galleries_controller.rb</h3>
    <h4><span class="red">16.67 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>20</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class GalleriesController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def save_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    @project = Project.find_by_id(session[:current_project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    @image = @project.galleries.create({gallery_file_name: params[:gallery]})</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    render json: { image_id: @image.id }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @image = Gallery.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @image.destroy</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    render json: { image_id: @image.id }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def save_photo_tw_room</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    if params[:mimetype].eql?(&quot;image&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      @image = project.galleries.create(gallery_file_name: params[:file_url], gallery_type: &quot;transparency_workroom&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">      @thumbnail_url = @image.gallery_file_name + &quot;/convert?fit=scale&amp;height=216&amp;width=216&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">      @link_text = &quot;Delete Photo&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      video_data = video_data_by_link(params[:video_link])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">      file_url = thumbnail = &quot;&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">      unless video_data.blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">        file_url = video_data.player_url.gsub(&#39;&amp;feature=youtube_gdata_player&#39;, &#39;&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">        thumbnail = video_data.thumbnails.detect {|video| video.height == 360 }.url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">      @image = project.galleries.create(</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">        gallery_file_name: file_url,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">        gallery_type: &quot;transparency_workroom&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">        gallery_content_type: &quot;video&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">        thumbnail_url: thumbnail</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">        )</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">      @thumbnail_url = @image.thumbnail_url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">      @link_text = &quot;Delete Video&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="58858915cf084124f427a3b86affe71b9a078c66">
  <div class="header">
    <h3>app/controllers/identities_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class IdentitiesController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="37f544a2fd5d5b9a253cd9d30063bcd7c4d12978">
  <div class="header">
    <h3>app/controllers/marketing_infos_controller.rb</h3>
    <h4><span class="red">25.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class MarketingInfosController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    @marketing_info = MarketingInfo.new(params[:marketing_info])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    if @marketing_info.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">      url = @marketing_info.href</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">      url &lt;&lt; &quot;&amp;marketing_info_id=#{@marketing_info.id}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">      redirect_to url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">      redirect_to choose_plan_pages_path, notice: &#39;Email error&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="aa7210f1c889870d3f8076eaefb9b7d2ed80eaf7">
  <div class="header">
    <h3>app/controllers/memberships_controller.rb</h3>
    <h4><span class="red">40.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class MembershipsController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :authenticate_user!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :find_membership, only: [:show, :update, :edit]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    plan = Plan.where(name: params[:membership_type]).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @membership.plan = plan</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    if @membership.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">      flash[:notice] = &#39;You have not been subscribed.&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      redirect_to user_membership_path(current_user, @membership)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">      flash[:alert] = &#39;You have not been subscribed.&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">      redirect_to pricing_page_pages_path()</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  def cancel</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    plan_service = Gateway::PlansService.new(current_user)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    if plan_service.cancel_plan</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">      redirect_to root_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">      render :cancel</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>

          <code class="ruby">  def find_membership</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    @membership = current_user.membership</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="88ded1c4c746b0dd45401672cf00f5bf4aceb16d">
  <div class="header">
    <h3>app/controllers/newsletters_controller.rb</h3>
    <h4><span class="red">33.33 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class NewslettersController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    newsletter = Newsletter.new(params[:newsletter])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    if result = newsletter.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">      NewsletterMailer.newsletter_confirmation(newsletter).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    render :json =&gt; { :created =&gt; result }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="2793a461617f9b8bf863e57e27f2b13c67686af1">
  <div class="header">
    <h3>app/controllers/pages_controller.rb</h3>
    <h4><span class="red">43.86 %</span> covered</h4>
    <div>
      <b>57</b> relevant lines.
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>32</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PagesController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &quot;application&quot;, :except =&gt; [:index, :discover, :about, :contact]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  layout &quot;landing&quot;, :only =&gt; [:index, :discover, :about, :home, :funding_sources,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">    :search, :pricing, :choose_plan, :change_plan, :landing, :donor_relationship,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">    :donor_convenience, :fundraising, :analytics]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  skip_before_filter :set_previous_page</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_session_page</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_session_wizard, except: :home</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    @projects = Project.where(live: true, status: &#39;Funding Active&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @project_success = Project.where(&quot;live = 1 AND status = &#39;Funding Completed&#39;&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def home</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    session[:connected] = params[:code]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    session[:step] = true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def search</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    projects_list</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  def search_category_or_location</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    projects_list</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def discover</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">  	@cat = params[:category]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    @category = Project.where(&quot;live = true AND deleted = false AND category = &#39;#{@cat}&#39;&quot;).page(params[:page]).per(9)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    @projects = Project.where(&#39;live = true AND deleted = false&#39;).page(params[:page]).per(9)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>

          <code class="ruby">  def download_article</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    send_file &quot;#{Rails.root}/public/articles/#{params[:file]}&quot;, filename: params[:file], type: &#39;application/pdf&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def categories</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">  	@category = Project.where(&quot;category = ?&quot;, params[:category])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">  def contact</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>

          <code class="ruby">  def choose_plan</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    @marketing_info = MarketingInfo.new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  def contact_send</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    name = params[:pages][:name]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="52">


          <code class="ruby">    email = params[:pages][:email]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">    subject = params[:pages][:subject]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">    message = params[:pages][:message]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">    ContactMailer.delay.contact_confirmation(name, email, subject, message)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">    redirect_to contact_pages_url, notice: &quot;Thank You!!! Your Message Has Been Sent&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>

          <code class="ruby">  def how_it_works</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">    # session[:previous_page] = request.referer</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>

          <code class="ruby">  def extreme_makeover</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">    @demo = Demo.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="66">


          <code class="ruby">    render layout: false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>

          <code class="ruby">  def media</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">    @press_releases = PressRelease.all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="71">


          <code class="ruby">    @press_coverages = PressCoverage.order(&quot;release_date DESC&quot;).all</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>

          <code class="ruby">  def projects_list</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">    query = []</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="78">


          <code class="ruby">    fields = %w{</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">      title description location duration goal category address city state</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">      zip neighborhood short_description website facebook_page twitter_handle</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby">      organization story about project_title organization_type</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">      organization_classification</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby">    }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">    fields.each do |field|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">      query &lt;&lt; &quot;#{field} ILIKE :keyword&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="88">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">    @projects = Project.live.where(&quot;#{query.join(&#39; OR &#39;)}&quot;, :keyword =&gt; &quot;%#{params[:keyword]}%&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="90">


          <code class="ruby">                        .by_city(params[:city])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="91">


          <code class="ruby">                        .by_category(params[:category])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="92">


          <code class="ruby">                        .reject { |project| project.status == &quot;Funding Completed&quot; || project.status == nil }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="93">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">    @project_success = Project.live.where(&quot;#{query.join(&#39; OR &#39;)}&quot;, :keyword =&gt; &quot;%#{params[:keyword]}%&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby">                        .by_city(params[:city])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="96">


          <code class="ruby">                        .by_category(params[:category])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">                        .reject { |project| project.status == &quot;Funding Active&quot; || project.status == nil }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="99">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="101">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>

          <code class="ruby">  def set_session_page</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="103">
          <span class="hits">2</span>

          <code class="ruby">    session[:page_active] = if action_name.eql?(&quot;about&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="104">


          <code class="ruby">      &quot;about&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="106">
          <span class="hits">2</span>

          <code class="ruby">      action_name.eql?(&quot;home&quot;) ? &quot;home&quot; : &quot;project&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="107">


          <code class="ruby">   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby"> end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="4d0a79ec48ac7c9c4e52cf83f246a3a841a42251">
  <div class="header">
    <h3>app/controllers/payment_methods_controller.rb</h3>
    <h4><span class="red">28.95 %</span> covered</h4>
    <div>
      <b>38</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>27</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PaymentMethodsController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :authenticate_user!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :find_customer_data</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :new_credit_card, only: [:new, :edit]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    customer_plan = Gateway::PlansService.new(current_user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    plan_id = params[:plan_id]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @plan = Plan.where(&quot;name = ?&quot;, plan_id).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    if plan_id == &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      customer_plan.update_plan(&#39;fee&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">      redirect_to users_sign_up_confirmation_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    @credit_card = CreditCard.new(params[:credit_card])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    customer_plan = Gateway::PlansService.new(current_user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    plan_id = params[:credit_card][:plan_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    begin</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">      if @credit_card.valid? &amp;&amp; @card_service.create(@credit_card)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">        customer_plan.update_plan(plan_id) if plan_id.present?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">        current_user.send_welcome_email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">        redirect_to users_sign_up_confirmation_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">        render :new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    rescue Stripe::CardError =&gt; e</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">      @credit_card.errors.add(:base, e.message)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">      render :new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    credit_card = CreditCard.new(params[:credit_card])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">    if @card_service.create(credit_card)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">      flash[:notice] = &#39;Payment method updated.&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">      flash[:notice] = &#39;Something went wrong. Please try again in a few minutes.&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    redirect_to edit_user_payment_method_path(current_user)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>

          <code class="ruby">  def new_credit_card</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">    @credit_card = CreditCard.new()</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">    @customer_card = @card_service.find_card</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>

          <code class="ruby">  def find_customer_data</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">    @card_service = Gateway::CardsService.new(current_user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">    @customer = @card_service.find_customer</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="6b813e06f1278dfb51a2e7008a3033767f0a3661">
  <div class="header">
    <h3>app/controllers/payments_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PaymentsController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def purchase</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">    project = Project.find(params[:project_id])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">    sponsor = Sponsor.find(params[:sponsor_id])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">    project_sponsor = project.project_sponsors.unscoped.find_by_sponsor_id(sponsor.id)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">    project_sponsor.update_attributes!(confirmed: true)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">    redirect_to thank_you_for_sponsor_url(project.id, sponsor.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="a28f36265c0ad52b995556a7216f0f072ee83c64">
  <div class="header">
    <h3>app/controllers/posts_controller.rb</h3>
    <h4><span class="red">25.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PostsController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">	def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">		@project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">		@post = @project.posts.build(params[:post])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">		@post.user_id = current_user.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">		if @post.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">	      flash[:notice] = &quot;Successfully created post.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">	      respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">	    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">	      flash[:error] = &quot;Error adding comment.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">	    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">	def create_post</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">		@project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">		@post = @project.posts.build(params[:post])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="9f1af694a704cd218df63b622900d307a7b3eb63">
  <div class="header">
    <h3>app/controllers/press_coverages_controller.rb</h3>
    <h4><span class="red">47.37 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PressCoveragesController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  load_and_authorize_resource</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  # before_filter :authenticate_user!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @press_coverages = PressCoverage.all</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @press_coverage = PressCoverage.new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @press_coverage = PressCoverage.find(params[:id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @press_coverage = PressCoverage.new(params[:press_coverage])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    </code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      if @press_coverage.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">        format.html { redirect_to press_coverages_path }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def show</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    PressCoverage.find(params[:id]).destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    flash[:success] = &quot;Press Release Destroyed.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    redirect_to press_coverages_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  </code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">  # private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">  # def admin_required!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  #   unless current_user.role == &quot;admin&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  #     flash[:error] = &quot;Sorry, you don&#39;t have the right permissions to access this page.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">  #     redirect_to root_url and return false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  #   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">  # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="aca0e7f3ffdedf772991ffc3019937e6946982ac">
  <div class="header">
    <h3>app/controllers/press_releases_controller.rb</h3>
    <h4><span class="red">47.37 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PressReleasesController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  load_and_authorize_resource</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  # before_filter :authenticate_user!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @press_releases = PressRelease.all</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @press_release = PressRelease.new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @press_release = PressRelease.find(params[:id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @press_release = PressRelease.new(params[:press_release])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    </code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      if @press_release.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">        format.html { redirect_to press_releases_path }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def show</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    PressRelease.find(params[:id]).destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    flash[:success] = &quot;Press Release Destroyed.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    redirect_to press_releases_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  </code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">  # private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">  # def admin_required!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  #   unless current_user.role == &quot;admin&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  #     flash[:error] = &quot;Sorry, you don&#39;t have the right permissions to access this page.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">  #     redirect_to root_url and return false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  #   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">  # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">  </code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="cf463187a568086d1d16724f212ce8047e46d7ed">
  <div class="header">
    <h3>app/controllers/project_admin/documents_controller.rb</h3>
    <h4><span class="red">50.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectAdmin::DocumentsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_project, except: :destroy</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    @authenticated = admin_required!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @documents = @project.documents.page(params[:page]).per(9) if @authenticated</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @document = Document.create!(filename: params[:filename], url: params[:url],  project_id: @project.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    Document.delete(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    render :text =&gt; &quot;Success&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def set_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  def admin_required!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">   unless current_user.role == &quot;admin&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    @project.user.id.eql?(current_user.id) ? true : false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"> end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="7b217c8f0eca4a5113efaecf948c95058846c3b0">
  <div class="header">
    <h3>app/controllers/project_admin/projects_controller.rb</h3>
    <h4><span class="red">28.43 %</span> covered</h4>
    <div>
      <b>102</b> relevant lines.
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>73</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectAdmin::ProjectsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :authenticate_user!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_project, only: :show</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_project_ajax, except: [:index, :update, :show,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">    :send_email, :email_based_on_sponsor_level, :project_update, :process_project_update]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  respond_to :js, except: [:index, :update, :show, :emails_page, :messages]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  has_scope :page, :default =&gt; 1</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  layout false, :only =&gt; &quot;stripe_update&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @projects = Project.find(params[:id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def show</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    subheader</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    @fundings = @project.all_funding_by_project(params[:page])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @total_fundings = @project.total_funding_by_project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      format.js</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      format.html</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  def messages</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    subheader</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    @fundings = @project.all_funding_by_project(params[:page])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    @total_fundings = @project.total_funding_by_project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">      format.js</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">      format.html</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>

          <code class="ruby">  def overview; end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def manage</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    @galleries = @project.galleries.page(params[:page]).per(6)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">  def detail; end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>

          <code class="ruby">  def visual; end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  def project_update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    @project_update = ProjectUpdate.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">    session[:current_project] = params[:project_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>

          <code class="ruby">  def process_project_update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">    params[:project_update][:project_id] = session[:current_project]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">    project_update = ProjectUpdate.new(params[:project_update])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">    project_update.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">    @alert = &quot;Project successfully updated&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>

          <code class="ruby">  def cover_photo_and_gallery</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">    @galleries = @project.galleries.page(params[:page]).per(6)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>

          <code class="ruby">  def post_to_social_media; end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>

          <code class="ruby">  def project_founder</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="66">


          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">    if params[:type].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="69">


          <code class="ruby">      @founders = @project.founders(params[:page])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">      @all = true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="72">


          <code class="ruby">      @founders = if params[:type].eql?(&quot;individual&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="73">


          <code class="ruby">        @project.individual_donors(params[:page])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">        @project.project_sponsor_by_level(params[:page])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="77">


          <code class="ruby">      @all = false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>

          <code class="ruby">  def send_email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="82">


          <code class="ruby">    @error_messages = []</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="84">


          <code class="ruby">    @error_messages &lt;&lt; &quot;email recipient can&#39;t be blank&quot; if params[:email_recepient].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">    @error_messages &lt;&lt; &quot;email subject can&#39;t be blank&quot; if params[:post][&quot;subject&quot;].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">    @error_messages &lt;&lt; &quot;email content can&#39;t be blank&quot; if params[:post][&quot;email_content&quot;].blank?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="88">


          <code class="ruby">    if @error_messages.blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">      subject = params[:post][:subject]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="90">


          <code class="ruby">      recepients = params[:email_recepient].split(&quot;,&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="91">


          <code class="ruby">      recepients.each do |recepient|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="92">


          <code class="ruby">        ProjectMailer.project_message(recepient, params[:post][&quot;subject&quot;], params[:email_header], params[:post][&quot;email_content&quot;]).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="93">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="94">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="96">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>

          <code class="ruby">  def emails_page</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="98">


          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="99">


          <code class="ruby">    @total_fundings = @project.total_funding_by_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="100">


          <code class="ruby">    @contact = Contact.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="101">


          <code class="ruby">    @need_doctype = true</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="102">


          <code class="ruby">    @list_recepients = @project.list_recepient</code>
        </li>

        <li class="never" data-hits="" data-linenumber="103">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="104">


          <code class="ruby">    subheader</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="106">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>

          <code class="ruby">  def email_based_on_sponsor_level</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="108">


          <code class="ruby">    project = Project.find(session[:current_project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="109">


          <code class="ruby">    case params[:level_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">    when &quot;All Project Sponsors and Donors&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="111">


          <code class="ruby">      emails_sponsor = project.project_sponsors.joins(:sponsor).pluck(:email).uniq</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="112">


          <code class="ruby">      emails_donors = project.donations.where(anonymous: false).pluck(:email).uniq</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">      emails = emails_donors + emails_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="114">


          <code class="ruby">    when &quot;All Project Sponsors&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="115">


          <code class="ruby">      emails = project.project_sponsors.joins(:sponsor).pluck(:email).uniq</code>
        </li>

        <li class="never" data-hits="" data-linenumber="116">


          <code class="ruby">    when &quot;All Project Donors&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="117">


          <code class="ruby">      emails = project.donations.where(anonymous: false).pluck(:email).uniq</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby">    when &quot;My Contacts&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="119">


          <code class="ruby">      emails = []</code>
        </li>

        <li class="never" data-hits="" data-linenumber="120">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="121">


          <code class="ruby">      if params[:level_id].to_i.to_s == params[:level_id]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="122">


          <code class="ruby">        emails = project.project_sponsors.joins(:sponsor).where(&quot;level_id = ?&quot;, params[:level_id]).uniq.pluck(:email)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="124">


          <code class="ruby">        level_name = params[:level_id].split(&quot; Project&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">        emails = project.donations.where(anonymous: false).where(&quot;perk_name = ?&quot;, level_name[0]).uniq.pluck(:email)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="127">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="128">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="129">


          <code class="ruby">    emails.reject!(&amp;:empty?)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="130">


          <code class="ruby">    @emails = emails.join(&quot;,&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="131">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="132">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>

          <code class="ruby">  def photos_and_videos</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="134">


          <code class="ruby">    @photos_and_videos = @project.galleries.media_transparent_room(params[:page])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="135">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="136">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>

          <code class="ruby">  def communication_zone</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="138">


          <code class="ruby">    @test = &quot;test&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="139">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="140">


          <code class="ruby">      format.js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="141">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="142">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="143">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="145">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>

          <code class="ruby">  def set_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="147">


          <code class="ruby">    @project = Project.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="148">


          <code class="ruby">    admin_required!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="149">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="150">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>

          <code class="ruby">  def set_project_ajax</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="152">


          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="153">


          <code class="ruby">    session[:current_project] = @project.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="154">


          <code class="ruby">    admin_required!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="155">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="156">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="157">
          <span class="hits">1</span>

          <code class="ruby">  def subheader</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="158">


          <code class="ruby">    @donations = Donation.find_all_by_project_id(@project.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="159">


          <code class="ruby">    @sponsors = ProjectSponsor.where(project_id: @project.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="160">


          <code class="ruby">    @sponsor_count = @sponsors.empty? ? 0 : @sponsors.count</code>
        </li>

        <li class="never" data-hits="" data-linenumber="161">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="162">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="163">
          <span class="hits">1</span>

          <code class="ruby">  def admin_required!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="164">


          <code class="ruby">    unless current_user.role == &quot;admin&quot; || @project.user.id.eql?(current_user.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="165">


          <code class="ruby">      flash[:error] = &quot;Sorry, you don&#39;t have right permision to accessing page.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="166">


          <code class="ruby">      redirect_to root_url and return false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="167">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="168">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="169">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="170">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="5c959d7e2bea356992c71286d202f2ffae21284e">
  <div class="header">
    <h3>app/controllers/project_admin/xls_controller.rb</h3>
    <h4><span class="red">60.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectAdmin::XlsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_project, :admin_required!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    xls = XlsService.new(@project).create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    send_file xls.file_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def set_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def admin_required!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    current_user.role == &quot;admin&quot; || @project.user.id.eql?(current_user.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="9507b804ab53049e61c84e13d1b07bd791ca03ed">
  <div class="header">
    <h3>app/controllers/project_sponsor_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectSponsorController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="deeac6ff25168aee42f08cd1d8cc84ba1e46a639">
  <div class="header">
    <h3>app/controllers/projects_controller.rb</h3>
    <h4><span class="red">60.92 %</span> covered</h4>
    <div>
      <b>261</b> relevant lines.
      <span class="green"><b>159</b> lines covered</span> and
      <span class="red"><b>102</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectsController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  require &#39;bitly&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  require &quot;net/http&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  require &quot;uri&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  skip_before_filter :verify_authenticity_token, only: :add_perk</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :session_path, only: :create</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :authenticate_user!, :only =&gt; [:index, :create, :edit, :update]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_session_page</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :set_session_wizard, only: [:new, :create]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :admin_required!, only: [:edit, :update, :delete_image]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  layout false, :only =&gt; &quot;stripe_update&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    @projects = Project.find_all_by_user_id(current_user.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">    @project = Project.new</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">    session[:current_project] = &#39;&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>

          <code class="ruby">    session[:connected] = &#39;&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">    #    @project.perks.build</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">    #    @project.galleries.build</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">    render :layout =&gt; &#39;landing&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def download_stripe_guide</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    send_file &quot;#{Rails.root}/public/data/Uruut_StripeQuickStartGuide.pdf&quot;, :type=&gt;&quot;application/pdf&quot;, :x_sendfile=&gt;true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>

          <code class="ruby">  def download</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    send_file &quot;#{Rails.root}/public/data/URUUT_ProjectCreationWizard_Step1.psd&quot;, :type=&gt;&quot;application/psd&quot;, :x_sendfile=&gt;true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">    @project = current_user.projects.build(params[:project])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>

          <code class="ruby">      if @project.save</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>

          <code class="ruby">        format.html { redirect_to edit_project_path(@project, anchor: &#39;sponsor-info&#39;) }</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">        format.json { render :json =&gt; @project.id }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">        format.json { render :json =&gt; &quot;error&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="51">
          <span class="hits">9</span>

          <code class="ruby">    if params[:step]</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>

          <code class="ruby">      if params[:step] == &#39;first&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>

          <code class="ruby">        @project.errors.clear</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>

          <code class="ruby">        @project.update_attributes!(params[:project])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>

          <code class="ruby">        @project.sponsor_info = true</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>

          <code class="ruby">        if @project.valid?</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>

          <code class="ruby">          render :json =&gt; &quot;Success&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">          render :json =&gt; { :errors =&gt; @project.errors.full_messages }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>

          <code class="ruby">      if params[:step] == &#39;second&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>

          <code class="ruby">        @project.errors.clear</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>

          <code class="ruby">        @project.update_attributes!(params[:project])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>

          <code class="ruby">        @project.project_details = true</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>

          <code class="ruby">        if @project.valid?</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>

          <code class="ruby">          render :json =&gt; &quot;Success&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">          render :json =&gt; { :errors =&gt; @project.errors.full_messages }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>

          <code class="ruby">      if params[:step] == &#39;last&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">        @project.errors.clear</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">        @project.update_attributes!(params[:project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="77">


          <code class="ruby">        @project.assets = true</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="78">


          <code class="ruby">        if @project.valid?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="79">


          <code class="ruby">          render :json =&gt; &quot;Success&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="81">


          <code class="ruby">          render :json =&gt; { :errors =&gt; @project.errors.full_messages }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="85">
          <span class="hits">7</span>

          <code class="ruby">      sort_sponsorships = @project.project_sponsors.sort_by {|ps| ps.level_id}</code>
        </li>

        <li class="covered" data-hits="8" data-linenumber="86">
          <span class="hits">8</span>

          <code class="ruby">      @sponsorship_benefits = @project.sponsorship_benefits.where(status: true).order(:id).group_by {|sponsor| sponsor.sponsorship_level_id}</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="87">
          <span class="hits">7</span>

          <code class="ruby">      session[:current_project] = @project.id</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="88">
          <span class="hits">7</span>

          <code class="ruby">      @project.update_attributes!(params[:project])</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="89">
          <span class="hits">7</span>

          <code class="ruby">      @perks = @project.perks.order(:amount)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="90">
          <span class="hits">7</span>

          <code class="ruby">      respond_to do |format|</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="91">
          <span class="hits">7</span>

          <code class="ruby">        format.html</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="92">
          <span class="hits">7</span>

          <code class="ruby">        format.js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="93">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="94">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="96">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>

          <code class="ruby">  def show</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="98">
          <span class="hits">3</span>

          <code class="ruby">    @project = Project.live.find_by_id(params[:id]) || not_found</code>
        </li>

        <li class="never" data-hits="" data-linenumber="99">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="100">
          <span class="hits">3</span>

          <code class="ruby">    @images = @project.galleries.page(params[:page]).per(6)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="101">
          <span class="hits">3</span>

          <code class="ruby">    sort_sponsorships = @project.project_sponsors.sort_by {|ps| ps.level_id}</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="102">
          <span class="hits">3</span>

          <code class="ruby">    @project_sponsors = sort_sponsorships.group_by {|sponsor| sponsor.level_id }</code>
        </li>

        <li class="covered" data-hits="10" data-linenumber="103">
          <span class="hits">10</span>

          <code class="ruby">    @sponsorship_benefits = @project.sponsorship_benefits.where(status: true).order(:id).group_by {|sponsor| sponsor.sponsorship_level_id}</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="104">
          <span class="hits">3</span>

          <code class="ruby">    @perks = @project.perks.order(:amount)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="105">
          <span class="hits">3</span>

          <code class="ruby">    session[:current_project] = @project.id</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="106">
          <span class="hits">3</span>

          <code class="ruby">    render :layout =&gt; &#39;landing&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="107">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>

          <code class="ruby">  def show_more_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="110">


          <code class="ruby">    @project = Project.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="111">


          <code class="ruby">    @images = @project.galleries.page(params[:page]).per(6)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="112">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="113">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="115">
          <span class="hits">4</span>

          <code class="ruby">    sponsorship_benefits = []</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="116">
          <span class="hits">4</span>

          <code class="ruby">    def sponsorship_benefit_level(level, benefit, key)</code>
        </li>

        <li class="covered" data-hits="12" data-linenumber="117">
          <span class="hits">12</span>

          <code class="ruby">      data = []</code>
        </li>

        <li class="covered" data-hits="12" data-linenumber="118">
          <span class="hits">12</span>

          <code class="ruby">      1.upto(params[&quot;#{level}_count&quot;].to_i) do |x|</code>
        </li>

        <li class="covered" data-hits="30" data-linenumber="119">
          <span class="hits">30</span>

          <code class="ruby">        count = if !benefit[x - 1].blank?</code>
        </li>

        <li class="covered" data-hits="24" data-linenumber="120">
          <span class="hits">24</span>

          <code class="ruby">          !benefit[x - 1][:id].blank? ? benefit[x - 1][:id] : x</code>
        </li>

        <li class="never" data-hits="" data-linenumber="121">


          <code class="ruby">        else</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="122">
          <span class="hits">6</span>

          <code class="ruby">          x</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby">        end</code>
        </li>

        <li class="covered" data-hits="30" data-linenumber="124">
          <span class="hits">30</span>

          <code class="ruby">        status = params[&quot;#{level}&quot;][&quot;#{count}&quot;] ? 1 : 0</code>
        </li>

        <li class="covered" data-hits="30" data-linenumber="125">
          <span class="hits">30</span>

          <code class="ruby">        if level.eql?(&quot;platinum&quot;)</code>
        </li>

        <li class="covered" data-hits="12" data-linenumber="126">
          <span class="hits">12</span>

          <code class="ruby">          cost = 0.25 * @project.goal.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="127">


          <code class="ruby">        elsif level.eql?(&quot;gold&quot;)</code>
        </li>

        <li class="covered" data-hits="10" data-linenumber="128">
          <span class="hits">10</span>

          <code class="ruby">          cost = 0.1 * @project.goal.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="129">


          <code class="ruby">        elsif level.eql?(&quot;silver&quot;)</code>
        </li>

        <li class="covered" data-hits="8" data-linenumber="130">
          <span class="hits">8</span>

          <code class="ruby">          cost = 0.05 * @project.goal.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="131">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="132">


          <code class="ruby">          if @project.goal.to_i * 0.02 &gt;= 750</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="133">


          <code class="ruby">            cost = 750</code>
        </li>

        <li class="never" data-hits="" data-linenumber="134">


          <code class="ruby">          else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="135">


          <code class="ruby">            cost = 0.02 * @project.goal.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="136">


          <code class="ruby">          end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="137">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="138">


          <code class="ruby">        # if @project.sponsorship_benefits.blank? || params[&quot;#{level}&quot;][&quot;id_#{count}&quot;].nil?</code>
        </li>

        <li class="covered" data-hits="30" data-linenumber="139">
          <span class="hits">30</span>

          <code class="ruby">          unless params[&quot;#{level}&quot;][&quot;info_#{count}&quot;].blank?</code>
        </li>

        <li class="covered" data-hits="24" data-linenumber="140">
          <span class="hits">24</span>

          <code class="ruby">            data &lt;&lt;  {name: params[&quot;#{level}&quot;][&quot;info_#{count}&quot;],sponsorship_level_id: key, project_id: @project.id, status: status, cost: cost}</code>
        </li>

        <li class="never" data-hits="" data-linenumber="141">


          <code class="ruby">          end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="142">


          <code class="ruby">        # else</code>
        </li>

        <li class="never" data-hits="" data-linenumber="143">


          <code class="ruby">        #   sponsorship_benefit = SponsorshipBenefit.find(params[level][&quot;id_#{count}&quot;])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="144">


          <code class="ruby">        #   sponsorship_benefit.update_attributes({name: params[&quot;#{level}&quot;][&quot;info_#{count}&quot;],sponsorship_level_id: key, project_id: @project.id, status: status, cost: cost})</code>
        </li>

        <li class="never" data-hits="" data-linenumber="145">


          <code class="ruby">        # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="146">


          <code class="ruby">      end</code>
        </li>

        <li class="covered" data-hits="12" data-linenumber="147">
          <span class="hits">12</span>

          <code class="ruby">      data</code>
        </li>

        <li class="never" data-hits="" data-linenumber="148">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="149">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="150">
          <span class="hits">4</span>

          <code class="ruby">    SponsorshipBenefit::SPONSORSHIP_BENEFITS.each do |key, value|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="151">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="16" data-linenumber="152">
          <span class="hits">16</span>

          <code class="ruby">      case key</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="153">
          <span class="hits">4</span>

          <code class="ruby">        when 1 then sponsorship_benefits += sponsorship_benefit_level(&quot;platinum&quot;, value, key)</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="154">
          <span class="hits">4</span>

          <code class="ruby">        when 2 then sponsorship_benefits += sponsorship_benefit_level(&quot;gold&quot;, value, key)</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="155">
          <span class="hits">4</span>

          <code class="ruby">        when 3 then sponsorship_benefits += sponsorship_benefit_level(&quot;silver&quot;, value, key)</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="156">
          <span class="hits">4</span>

          <code class="ruby">        when 4 then sponsorship_benefits += sponsorship_benefit_level(&quot;custom&quot;, value, key) if params[:custom].present?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="157">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="158">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="159">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="160">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="161">
          <span class="hits">4</span>

          <code class="ruby">    unless params[:project][:duration].blank?</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="162">
          <span class="hits">1</span>

          <code class="ruby">      params[:project][:campaign_deadline] = params[:project][:duration].to_i.days.from_now.end_of_day.to_time</code>
        </li>

        <li class="never" data-hits="" data-linenumber="163">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="164">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="165">
          <span class="hits">4</span>

          <code class="ruby">    session[:step] = params[:step]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="166">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="167">
          <span class="hits">4</span>

          <code class="ruby">    if session[:step].eql?(&quot;first&quot;)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>

          <code class="ruby">      @project.step = &quot;/projects/#{@project.id}/edit#project-details&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="169">


          <code class="ruby">    elsif session[:step].eql?(&quot;second&quot;)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="170">
          <span class="hits">1</span>

          <code class="ruby">      @project.step = &quot;/projects/#{@project.id}/edit#perks&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="171">


          <code class="ruby">    elsif session[:step].eql?(&quot;third&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="172">


          <code class="ruby">      @project.step = &quot;/projects/#{@project.id}/edit#sponsorship&quot;</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="173">
          <span class="hits">2</span>

          <code class="ruby">    else session[:step].eql?(&quot;fourth&quot;)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="174">
          <span class="hits">2</span>

          <code class="ruby">      @project.step = &quot;/projects/#{@project.id}/edit#assets&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="175">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="176">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="177">
          <span class="hits">4</span>

          <code class="ruby">    unless sponsorship_benefits.blank?</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="178">
          <span class="hits">2</span>

          <code class="ruby">      SponsorshipBenefit.where(project_id: params[:id]).destroy_all</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="179">
          <span class="hits">2</span>

          <code class="ruby">      @sponsorship_benefits = SponsorshipBenefit.create!(sponsorship_benefits)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="180">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="181">
          <span class="hits">4</span>

          <code class="ruby">    params[:project][:goal] = params[:project][:goal].gsub(&quot;,&quot;, &quot;&quot;) if !params[:project][:goal].nil?</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="182">
          <span class="hits">4</span>

          <code class="ruby">    params[:project][:sponsor_permission] = params[:project][:sponsorship_permission] if !params[:project][:sponsorship_permission].nil?</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="183">
          <span class="hits">4</span>

          <code class="ruby">    @project.update_attributes!(params[:project])</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="184">
          <span class="hits">4</span>

          <code class="ruby">    unless @project.bitly?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="185">


          <code class="ruby">      bitly = Bitly.client</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="186">


          <code class="ruby">      page_url = bitly.shorten(&quot;#{request.scheme}://#{request.host_with_port}/projects/#{@project.id}&quot;) rescue nil</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="187">


          <code class="ruby">      @project.bitly = page_url.short_url rescue nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="188">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="189">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="190">
          <span class="hits">4</span>

          <code class="ruby">    if @project.save</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="191">
          <span class="hits">4</span>

          <code class="ruby">      if params[:step].eql?(&quot;fourth&quot;)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="192">
          <span class="hits">2</span>

          <code class="ruby">        @perks = @project.perks.order(:amount)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="193">
          <span class="hits">3</span>

          <code class="ruby">        @sponsorship_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="194">
          <span class="hits">2</span>

          <code class="ruby">        respond_to do |format|</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="195">
          <span class="hits">4</span>

          <code class="ruby">          format.js { render &quot;skip_sponsor.js.erb&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="196">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="197">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="198">
          <span class="hits">2</span>

          <code class="ruby">        respond_to do |format|</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="199">
          <span class="hits">4</span>

          <code class="ruby">          format.json { render :json =&gt; @project.id }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="200">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="201">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="202">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="203">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="204">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>

          <code class="ruby">  def update_sponsor_info</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="206">
          <span class="hits">3</span>

          <code class="ruby">    case params[:type]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="207">


          <code class="ruby">    when &quot;state&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>

          <code class="ruby">      Project.update(params[:id].to_i, state: params[:data_value])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="209">


          <code class="ruby">    when &quot;organized_type&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="210">
          <span class="hits">1</span>

          <code class="ruby">      Project.update(params[:id].to_i, organization_type: params[:data_value])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="211">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>

          <code class="ruby">      Project.update(params[:id].to_i, organization_classification: params[:data_value])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="213">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="214">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="215">
          <span class="hits">3</span>

          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="216">
          <span class="hits">6</span>

          <code class="ruby">      format.text { render :text =&gt; &quot;Success&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="217">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="218">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="219">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>

          <code class="ruby">  def set_perk_to_false</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>

          <code class="ruby">    session[:step] = &quot;third&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="222">
          <span class="hits">1</span>

          <code class="ruby">    Project.update(params[:id], perk_permission: false)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="223">
          <span class="hits">1</span>

          <code class="ruby">    render nothing: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="224">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="225">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>

          <code class="ruby">  def skip_sponsor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="227">


          <code class="ruby">    session[:step] = &quot;fourth&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="228">


          <code class="ruby">    @project = Project.find(session[:current_project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="229">


          <code class="ruby">    @project.update_attributes!(sponsor_permission: false)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="230">


          <code class="ruby">    @sponsorship_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="231">


          <code class="ruby">    @perks = @project.perks.order(:amount)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="232">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="233">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="234">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="235">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>

          <code class="ruby">  def stripe_update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="237">


          <code class="ruby">    code = params[:code]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="238">


          <code class="ruby">    client = OAuth2::Client.new(&quot;#{Settings.stripe.client_id}&quot;, &quot;#{Settings.stripe.api_key}&quot;, :site =&gt; &quot;https://connect.stripe.com/oauth/authorize?scope=read_write&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="239">


          <code class="ruby">    token = client.auth_code.get_token(code, :params =&gt; {:scope =&gt; &#39;read_write&#39;}, :headers =&gt; {&#39;Authorization&#39; =&gt; &quot;Bearer #{Settings.stripe.api_key}&quot;})</code>
        </li>

        <li class="never" data-hits="" data-linenumber="240">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="241">


          <code class="ruby">    project = Project.find(session[:current_project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="242">


          <code class="ruby">    project.publishable_key = token.params[&#39;stripe_publishable_key&#39;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="243">


          <code class="ruby">    project.project_token = token.token</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="244">


          <code class="ruby">    project.save!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="245">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="246">


          <code class="ruby">    if project.project_token</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="247">


          <code class="ruby">      session[:connected] = &quot;true&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="248">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="249">


          <code class="ruby">      session[:connected] = &quot;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="250">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="251">


          <code class="ruby">    redirect_to &quot;/projects/#{project.id}/edit#sponsor-info&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="252">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="253">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="254">
          <span class="hits">1</span>

          <code class="ruby">  def save_video</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="255">


          <code class="ruby">    video = params[:video_link]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="256">


          <code class="ruby">    link_video = generate_video_link(video)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="257">


          <code class="ruby">    link_video = link_video.gsub(&#39;watch?v=&#39;, &#39;embed/&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="258">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="259">


          <code class="ruby">    logger.debug link_video</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="260">


          <code class="ruby">    puts &quot;#{link_video}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="261">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="262">


          <code class="ruby">    @project = Project.find_by_id(session[:current_project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="263">


          <code class="ruby">    if params[:video_type].eql?(&quot;seed&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="264">


          <code class="ruby">      @project.seed_video = link_video</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="265">


          <code class="ruby">      @project.seed_mime_type = &quot;video&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="266">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="267">


          <code class="ruby">      @project.cultivation_video = link_video</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="268">


          <code class="ruby">      @project.cultivation_mime_type = &quot;video&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="269">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="270">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="271">


          <code class="ruby">    @project.save!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="272">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="273">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>

          <code class="ruby">  def save_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="275">


          <code class="ruby">    @project = Project.find_by_id(session[:current_project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="276">


          <code class="ruby">    if params[:large_image]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="277">


          <code class="ruby">      @project.large_image = params[:large_image]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="278">


          <code class="ruby">    elsif params[:seed_image]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="279">


          <code class="ruby">      @project.seed_image = params[:seed_image]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="280">


          <code class="ruby">      @project.seed_mime_type = &quot;image&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="281">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="282">


          <code class="ruby">      @project.cultivation_image = params[:cultivation_image]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="283">


          <code class="ruby">      @project.cultivation_mime_type = &quot;image&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="284">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="285">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="286">


          <code class="ruby">    render :nothing =&gt; true if @project.save</code>
        </li>

        <li class="never" data-hits="" data-linenumber="287">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="288">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="289">
          <span class="hits">1</span>

          <code class="ruby">  def get_complete_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="290">


          <code class="ruby">    get_projects</code>
        </li>

        <li class="never" data-hits="" data-linenumber="291">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="292">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="293">
          <span class="hits">1</span>

          <code class="ruby">  def get_complete_project_public</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="294">


          <code class="ruby">    get_projects</code>
        </li>

        <li class="never" data-hits="" data-linenumber="295">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="296">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="297">
          <span class="hits">1</span>

          <code class="ruby">  def add_perk</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="298">


          <code class="ruby">    session[:step] = params[:step]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="299">


          <code class="ruby">    perk_permission = params[:perk_permission].eql?(&quot;yes&quot;) ? true : false</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="300">


          <code class="ruby">    Project.update(params[:project], perk_permission: perk_permission)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="301">


          <code class="ruby">    unless perk_permission.eql?(false) &amp;&amp; params[:name].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="302">


          <code class="ruby">      limit_status = params[:limit].eql?(&quot;yes&quot;) ? true : false</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="303">


          <code class="ruby">      perk = Perk.create!(name: params[:name], amount: params[:amount],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="304">


          <code class="ruby">                  description: params[:description], project_id: params[:project],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="305">


          <code class="ruby">                  perks_available: params[:perks_available], limit: limit_status, perk_limit: params[:perks_available])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="306">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="307">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="308">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="309">


          <code class="ruby">      format.json { render :json =&gt; perk.id }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="310">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="311">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="312">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="313">
          <span class="hits">1</span>

          <code class="ruby">  def get_perk</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="314">


          <code class="ruby">    perk = Perk.find_by_id(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="315">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="316">


          <code class="ruby">      format.json { render :json =&gt; {name: perk.name, amount: perk.amount, description: perk.description, id: perk.id} }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="317">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="318">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="319">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="320">
          <span class="hits">1</span>

          <code class="ruby">  def update_perk</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="321">


          <code class="ruby">    perk = Perk.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="322">


          <code class="ruby">    perk.name = params[:name]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="323">


          <code class="ruby">    perk.amount = params[:amount]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="324">


          <code class="ruby">    perk.description = params[:description]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="325">


          <code class="ruby">    if perk.save!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="326">


          <code class="ruby">      respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="327">


          <code class="ruby">        format.json { render :json =&gt; perk }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="328">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="329">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="330">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="331">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="332">
          <span class="hits">1</span>

          <code class="ruby">  def delete_perk</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="333">


          <code class="ruby">    if Perk.find(params[:id]).destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="334">


          <code class="ruby">      respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="335">


          <code class="ruby">        format.json { render :json =&gt; {destroy: true} }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="336">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="337">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="338">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="339">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="340">
          <span class="hits">1</span>

          <code class="ruby">  def submit_project</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="341">
          <span class="hits">1</span>

          <code class="ruby">    project = Project.find(params[:id])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="342">
          <span class="hits">1</span>

          <code class="ruby">    project.live = 0</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="343">
          <span class="hits">1</span>

          <code class="ruby">    project.ready_for_approval = 1</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="344">
          <span class="hits">1</span>

          <code class="ruby">    if project.save!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="345">
          <span class="hits">1</span>

          <code class="ruby">      session[:step] = nil</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="346">
          <span class="hits">1</span>

          <code class="ruby">      respond_to do |format|</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="347">
          <span class="hits">1</span>

          <code class="ruby">        Project.delay.send_confirmation_email(project)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="348">
          <span class="hits">2</span>

          <code class="ruby">        format.json { render :json =&gt; { ready_for_approval: project.ready_for_approval, status: 200 } }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="349">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="350">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="351">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="352">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="353">
          <span class="hits">1</span>

          <code class="ruby">  def update_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="354">


          <code class="ruby">    @project = Project.find_by_id(session[:current_project])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="355">


          <code class="ruby">    if params[:status].eql?(&quot;seed_image&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="356">


          <code class="ruby">      @project.update_attributes!(seed_mime_type: &quot;image&quot;, seed_image: params[:image])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="357">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="358">


          <code class="ruby">      @project.update_attributes!(cultivation_mime_type: &quot;image&quot;, cultivation_image: params[:image])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="359">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="360">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="361">


          <code class="ruby">    render nothing: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="362">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="363">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="364">
          <span class="hits">1</span>

          <code class="ruby">  def delete_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="365">


          <code class="ruby">    params[:type].eql?(&quot;seed_image&quot;) ? @project.seed_image = nil : @project.cultivation_image = nil</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="366">


          <code class="ruby">    @project.save!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="367">


          <code class="ruby">    render nothing: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="368">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="369">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="370">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="371">


          <code class="ruby">    Project.find(params[:id]).destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="372">


          <code class="ruby">    redirect_to current_user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="373">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="374">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="375">
          <span class="hits">1</span>

          <code class="ruby">  def update_content_assets_tab</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="376">
          <span class="hits">2</span>

          <code class="ruby">    @project = Project.find(params[:id])</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="377">
          <span class="hits">2</span>

          <code class="ruby">    @sponsorship_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="378">
          <span class="hits">1</span>

          <code class="ruby">    @perks = @project.perks.order(:amount)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="379">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="380">
          <span class="hits">1</span>

          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="381">
          <span class="hits">2</span>

          <code class="ruby">      format.js { render &quot;skip_sponsor.js.erb&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="382">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="383">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="384">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="385">
          <span class="hits">1</span>

          <code class="ruby">  def update_sponsorship_content</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="386">
          <span class="hits">1</span>

          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="387">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="388">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="389">
          <span class="hits">1</span>

          <code class="ruby">  def update_td_mark</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="390">


          <code class="ruby">    @project = Project.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="391">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="392">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="393">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="394">
          <span class="hits">1</span>

          <code class="ruby">  def set_previous_path_for_registration</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="395">


          <code class="ruby">    session[:path] = params[:url]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="396">


          <code class="ruby">    redirect_to new_user_registration_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="397">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="398">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="399">
          <span class="hits">1</span>

          <code class="ruby">  def set_previous_path_for_registration_perk</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="400">


          <code class="ruby">    session[:path] = URI.escape(CGI::unescape params[:url])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="401">


          <code class="ruby">    redirect_to new_user_registration_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="402">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="403">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="404">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="405">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="406">
          <span class="hits">1</span>

          <code class="ruby">  def set_session_page</code>
        </li>

        <li class="covered" data-hits="26" data-linenumber="407">
          <span class="hits">26</span>

          <code class="ruby">    session[:page_active] = if action_name.eql?(&quot;edit&quot;) or action_name.eql?(&quot;new&quot;)</code>
        </li>

        <li class="covered" data-hits="10" data-linenumber="408">
          <span class="hits">10</span>

          <code class="ruby">      &quot;funding&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="409">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="16" data-linenumber="410">
          <span class="hits">16</span>

          <code class="ruby">      &quot;project&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="411">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="412">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="413">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="414">
          <span class="hits">1</span>

          <code class="ruby">  def generate_video_link(link)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="415">


          <code class="ruby">    video_data = video_data_by_link(link)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="416">


          <code class="ruby">    logger.debug &quot;#{video_data}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="417">


          <code class="ruby">    video_data.player_url.sub(&#39;&amp;feature=youtube_gdata_player&#39;, &#39;&#39;).sub(/^(http|https):/, &#39;&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="418">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="419">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="420">
          <span class="hits">1</span>

          <code class="ruby">  def session_path</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="421">
          <span class="hits">1</span>

          <code class="ruby">    session[:path] = &quot;project_new&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="422">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="423">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="424">
          <span class="hits">1</span>

          <code class="ruby">  def admin_required!</code>
        </li>

        <li class="covered" data-hits="13" data-linenumber="425">
          <span class="hits">13</span>

          <code class="ruby">    @project = Project.find(params[:id])</code>
        </li>

        <li class="covered" data-hits="13" data-linenumber="426">
          <span class="hits">13</span>

          <code class="ruby">     unless current_user.role == &quot;admin&quot;</code>
        </li>

        <li class="covered" data-hits="13" data-linenumber="427">
          <span class="hits">13</span>

          <code class="ruby">      unless @project.user.id.eql?(current_user.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="428">


          <code class="ruby">       flash[:error] = &quot;Sorry, you don&#39;t have right permision to accessing page.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="429">


          <code class="ruby">       redirect_to root_url and return false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="430">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="431">


          <code class="ruby">     end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="432">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="433">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="434">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="9573b3a5a9bb35bfd77183c0920e021514307da5">
  <div class="header">
    <h3>app/controllers/question_controller.rb</h3>
    <h4><span class="red">16.67 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class QuestionController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">	def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">		@question = Question.new(params[:question])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">		@question.user = current_user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">		@project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">		@question.project = @project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">		if @question.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">	      flash[:notice] = &quot;Successfully send question.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">	      user_name = &quot;#{current_user.first_name} #{current_user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">	      QuestionMailer.send_question(@project.user, user_name, current_user.email, @question.subject, @question.body).deliver</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">	      redirect_to :back</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">	    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">	      flash[:error] = &quot;Error question.&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">	    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="04884ed9febe55d1cef0a6aa19d2eb5a3197b8e5">
  <div class="header">
    <h3>app/controllers/registrations_controller.rb</h3>
    <h4><span class="red">17.86 %</span> covered</h4>
    <div>
      <b>56</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>46</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class RegistrationsController &lt; Devise::RegistrationsController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  layout &quot;landing&quot;, only: [:confirmation]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    self.resource = resource_class.new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @marketing_info = MarketingInfo.find_by_id(params[:marketing_info_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    if @marketing_info</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">      resource.first_name = @marketing_info.first_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      resource.last_name  = @marketing_info.last_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">      resource.email      = @marketing_info.email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @plan = Plan.where(&quot;name = ?&quot;, params[:sign_up_plan]).first</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">    @customer_card = Gateway::CardsService.new(current_user).find_card</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    self.resource = resource_class.new(params[:user])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    if resource.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">      resource.build_membership.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">      Gateway::CustomerService.new(resource).create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">      Gateway::PlansService.new(resource).update_plan(&#39;fee&#39;) if resource.sign_up_plan == &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      if resource.active_for_authentication?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">        set_flash_message :notice, :signed_up if is_navigational_format?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">        sign_up(resource_name, resource)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">        respond_with resource, :location =&gt; full_registration_path(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">        set_flash_message :notice, :&quot;signed_up_but_#{resource.inactive_message}&quot; if is_navigational_format?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">        expire_session_data_after_sign_in!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">        respond_with resource, :location =&gt; after_inactive_sign_up_path_for(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">      clean_up_passwords resource</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">      respond_with resource</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">    @user = User.find(current_user.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">    email_changed = @user.email != params[:user][:email]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    password_changed = !params[:user][:password].empty?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">    successfully_updated = @user.update_attributes(params[:user])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">    session[:avatar] = params[:user][:avatar]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    if successfully_updated</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">      # Sign in the user bypassing validation in case his password changed</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">      sign_in @user, :bypass =&gt; true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">      # if params[:user][:avatar]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">#         render json: { :path =&gt; (@user.errors.empty? ? @user.avatar : &quot;#failed#&quot;) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">#       else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">        session.delete(:avatar)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">        redirect_to @user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">      session[:avatar] = params[:user][:avatar]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">      render &quot;edit&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>

          <code class="ruby">  def step2</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">    @credit_card = CreditCard.new()</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="70">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>

          <code class="ruby">  def after_sign_up_path_for(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">    # sign_up_url = url_for(:action =&gt; &#39;create&#39;, :controller =&gt; &#39;registrations&#39;, :only_path =&gt; false, :protocol =&gt; &#39;http&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="73">


          <code class="ruby">    if session[:redirect_url] == new_project_url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="74">


          <code class="ruby">      User.set_redirect_path</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">    elsif session[:path]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">      session[:path]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="77">


          <code class="ruby">    elsif session[:redirect_url] == user_registration_url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="78">


          <code class="ruby">      root_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="80">


          <code class="ruby">      stored_location_for(resource) || session[:redirect_url] || request.referer ||  request.env[&#39;omniauth.origin&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">      # logger.debug(request.referrer)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby">      # return root_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="85">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>

          <code class="ruby">  def full_registration_path(resource)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">    if resource.full_registration &amp;&amp; resource.sign_up_plan != &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="90">


          <code class="ruby">      new_user_payment_method_path(resource, plan_id: resource.sign_up_plan)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="91">


          <code class="ruby">    elsif resource.sign_up_plan == &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="92">


          <code class="ruby">      users_sign_up_confirmation_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="93">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">      after_sign_up_path_for(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="96">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="97">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="36b027c8f78c88224e91af7d035dee59284b5fb8">
  <div class="header">
    <h3>app/controllers/sponsors/dashboard_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Sponsors::DashboardController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :authenticate_sponsor!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def index</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="9a0c296510044b0941f3d1993a64c6a227910bf6">
  <div class="header">
    <h3>app/controllers/sponsors/registrations_controller.rb</h3>
    <h4><span class="red">20.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Sponsors::RegistrationsController &lt; Devise::RegistrationsController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">    # required for settings form to submit when password is left blank</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    if params[:sponsor][:password].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">      params[:sponsor].delete(&quot;password&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">      params[:sponsor].delete(&quot;password_confirmation&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @sponsor = Sponsor.find(current_sponsor.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    if @sponsor.update_attributes(params[:sponsor])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">      # Sign in the sponsor bypassing validation in case his password changed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      sign_in @sponsor, :bypass =&gt; true</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">      redirect_to root_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">      render &quot;edit&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="f7becbe209601e8516ba1ecfe2f71b7b632fa4da">
  <div class="header">
    <h3>app/controllers/sponsors_controller.rb</h3>
    <h4><span class="red">44.77 %</span> covered</h4>
    <div>
      <b>172</b> relevant lines.
      <span class="green"><b>77</b> lines covered</span> and
      <span class="red"><b>95</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SponsorsController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :project_id, except: [:create, :thank_you, :share_email]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :authenticate_user!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>

          <code class="ruby">    @sponsor = Sponsor.new</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>

          <code class="ruby">    @sponsor.anonymous = false</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>

          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>

          <code class="ruby">    session[:path] = &quot;sponsor_new&quot;</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>

          <code class="ruby">    case params[:level]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">      when &#39;platinum&#39;</code>
        </li>

        <li class="covered" data-hits="16" data-linenumber="13">
          <span class="hits">16</span>

          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[1]</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>

          <code class="ruby">        @cost = @project.goal.to_i * 0.25</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>

          <code class="ruby">        @level = &quot;Platinum&quot;</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>

          <code class="ruby">        session[:level_id] = 1</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">      when &#39;gold&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[2]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">        @cost = @project.goal.to_i * 0.1</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">        @level = &quot;Gold&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">        session[:level_id] = 2</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">      when &#39;silver&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[3]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">        @cost = @project.goal.to_i * 0.05</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">        @level = &quot;Silver&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">        session[:level_id] = 3</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">      when &#39;bronze&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">        @level = &quot;Bronze&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[4]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">        if (@project.goal.to_i * 0.02) &gt;= 750</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">          @cost = 750</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">          @cost = @project.goal.to_i * 0.02</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">        end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">        session[:level_id] = 4</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">        level_sponsor = @sponsorship_levels.first.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[level_sponsor]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">        @cost = Sponsor.set_sponsorship_percentage(level_sponsor, @project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">        session[:level_id] = level_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="16" data-linenumber="43">
          <span class="hits">16</span>

          <code class="ruby">    @sponsorship_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>

          <code class="ruby">    render :layout =&gt; &#39;landing&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    @sponsor = Sponsor.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">    @project_sponsor = ProjectSponsor.unscoped.where(project_id: @project.id, sponsor_id: @sponsor.id).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    @sponsor.anonymous = @project_sponsor.anonymous</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="52">


          <code class="ruby">    @sponsorship_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">    case @project_sponsor.level_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">      when 1</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[1]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">        @cost = @project.goal.to_i * 0.25</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">        @level = &quot;Platinum&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">        session[:level_id] = 1</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">      when 2</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[2]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">        @cost = @project.goal.to_i * 0.1</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">        @level = &quot;Gold&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">        session[:level_id] = 2</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby">      when 3</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[3]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="66">


          <code class="ruby">        @cost = @project.goal.to_i * 0.05</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="67">


          <code class="ruby">        @level = &quot;Silver&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">        session[:level_id] = 3</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">      when 4</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">        @level = &quot;Bronze&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="71">


          <code class="ruby">        @first_benefits = @project.sponsorship_benefits.where(status: true).group_by {|sponsor| sponsor.sponsorship_level_id}[4]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="72">


          <code class="ruby">        if (@project.goal.to_i * 0.02) &gt;= 750</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="73">


          <code class="ruby">          @cost = 750</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">          @cost = @project.goal.to_i * 0.02</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">        end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="77">


          <code class="ruby">        session[:level_id] = 4</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="79">


          <code class="ruby">    render :layout =&gt; &#39;landing&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="83">


          <code class="ruby">    params[:project_sponsor][:anonymous] = params[:sponsor][:anonymous]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="84">


          <code class="ruby">    params[:sponsor].delete(&quot;anonymous&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">    @sponsor = Sponsor.find(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">    @project_sponsor = ProjectSponsor.unscoped.where(project_id: params[:project_id], sponsor_id: @sponsor.id).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="87">


          <code class="ruby">    sponsor = params[:sponsor]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="88">


          <code class="ruby">    project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">    sponsor_name = sponsor[:payment_type].eql?(&quot;Wire Transfer&quot;) ? sponsor[:name] : sponsor[:card_name]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="90">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="91">


          <code class="ruby">    cost = Sponsor.set_sponsorship_percentage(params[:project_sponsor][:level_id], project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="92">


          <code class="ruby">    params[:sponsor][:name] = sponsor_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="93">


          <code class="ruby">    params[:sponsor][:email] = current_user.email if params[:sponsor][:email].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">    @sponsor.update_attributes!(params[:sponsor])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="95">


          <code class="ruby">    @project_sponsor.update_attributes!(params[:project_sponsor].merge({cost: cost, project_id: params[:project_id], sponsor_id: @sponsor.id,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="96">


          <code class="ruby">                                      level_id: params[:project_sponsor][:level_id]}))</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">    redirect_to confirmation_url(params[:project_id], @sponsor.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="99">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="101">


          <code class="ruby">    # current_user = :current_user</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>

          <code class="ruby">    project = Project.find(params[:project_id])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>

          <code class="ruby">    logger.debug &quot;Project is #{project}&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>

          <code class="ruby">    sponsor_count = project.project_sponsors.where(level_id: params[:project_sponsor][:level_id]).count</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>

          <code class="ruby">    case params[:project_sponsor][:level_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="106">


          <code class="ruby">    when &#39;1&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>

          <code class="ruby">      if sponsor_count &lt; 1</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>

          <code class="ruby">        create_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="110">


          <code class="ruby">        failed_create_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="111">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="112">


          <code class="ruby">    when &#39;2&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">      if sponsor_count &lt; 3</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="114">


          <code class="ruby">        create_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="115">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="116">


          <code class="ruby">        failed_create_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="117">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby">    when &#39;3&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="119">


          <code class="ruby">      if sponsor_count &lt; 5</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="120">


          <code class="ruby">        create_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="121">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="122">


          <code class="ruby">        failed_create_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="124">


          <code class="ruby">    when &#39;4&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">      create_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="127">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="128">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="129">
          <span class="hits">1</span>

          <code class="ruby">  def get_sponsorship_levels</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="130">


          <code class="ruby">    project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="131">


          <code class="ruby">    @sponsorship_level = SponsorshipLevel.find(params[:sponsor_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="132">


          <code class="ruby">    @benefits = project.sponsorship_benefits.where(status: true, sponsorship_level_id: params[:sponsor_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="133">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="134">


          <code class="ruby">    case params[:sponsor_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="135">


          <code class="ruby">    when &quot;1&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="136">


          <code class="ruby">      @cost = project.goal.to_i * 0.25</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="137">


          <code class="ruby">      @image = &quot;/assets/platinum-placement.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="138">


          <code class="ruby">    when &quot;2&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="139">


          <code class="ruby">      @cost = project.goal.to_i * 0.1</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="140">


          <code class="ruby">      @image = &quot;/assets/gold-placement.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="141">


          <code class="ruby">    when &quot;3&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="142">


          <code class="ruby">      @cost = project.goal.to_i * 0.05</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="143">


          <code class="ruby">      @image = &quot;/assets/silver-placement.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="144">


          <code class="ruby">    when &quot;4&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="145">


          <code class="ruby">      @image = &quot;/assets/bronze-placement.png&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="146">


          <code class="ruby">      if project.goal.to_i * 0.02 &gt;= 750</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="147">


          <code class="ruby">        @cost = 750</code>
        </li>

        <li class="never" data-hits="" data-linenumber="148">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="149">


          <code class="ruby">        @cost = project.goal.to_i * 0.02</code>
        </li>

        <li class="never" data-hits="" data-linenumber="150">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="151">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="152">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="153">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="154">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="155">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>

          <code class="ruby">  def confirmation</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="157">
          <span class="hits">1</span>

          <code class="ruby">    @sponsor = Sponsor.find(params[:id])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>

          <code class="ruby">    @project_sponsor =   ProjectSponsor.unscoped.where(project_id: @project.id, sponsor_id: @sponsor.id).first</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>

          <code class="ruby">    @benefits = @project.sponsorship_benefits.where(status: true, sponsorship_level_id: @project_sponsor.level_id )</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>

          <code class="ruby">    @sponsorship_level = SponsorshipLevel.find(@project_sponsor.level_id)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="161">
          <span class="hits">1</span>

          <code class="ruby">    @cost = Sponsor.set_sponsorship_percentage(@project_sponsor.level_id.to_s, @project)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="162">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="163">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="164">
          <span class="hits">1</span>

          <code class="ruby">  def thank_you</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="165">
          <span class="hits">1</span>

          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="166">
          <span class="hits">1</span>

          <code class="ruby">    project_sponsor =  ProjectSponsor.unscoped.where(project_id: @project.id, sponsor_id: params[:sponsor_id]).first</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="167">
          <span class="hits">1</span>

          <code class="ruby">    @project_sponsor = project_sponsor</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>

          <code class="ruby">    Sponsor.save_customer(current_user, @project_sponsor)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="169">


          <code class="ruby">    # Sponsor.create_charge(@project_sponsor)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="170">


          <code class="ruby">    # @sponsorship_level = SponsorshipLevel.find(project_sponsor.level_id)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>

          <code class="ruby">    @benefits = @project.sponsorship_benefits.where(status: true, sponsorship_level_id: project_sponsor.level_id )</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>

          <code class="ruby">    case project_sponsor.level_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="173">


          <code class="ruby">    when 1</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>

          <code class="ruby">      @cost = @project.goal.to_i * 0.25</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>

          <code class="ruby">      @level = &quot;Platinum&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="176">


          <code class="ruby">    when 2</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="177">


          <code class="ruby">      @cost = @project.goal.to_i * 0.1</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="178">


          <code class="ruby">      @level = &quot;Gold&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="179">


          <code class="ruby">    when 3</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="180">


          <code class="ruby">      @cost = @project.goal.to_i * 0.05</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="181">


          <code class="ruby">      @level = &quot;Silver&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="182">


          <code class="ruby">    when 4</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="183">


          <code class="ruby">      if @project.goal.to_i * 0.02 &gt;= 750</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="184">


          <code class="ruby">        @cost = 750</code>
        </li>

        <li class="never" data-hits="" data-linenumber="185">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="186">


          <code class="ruby">        @cost = @project.goal.to_i * 0.02</code>
        </li>

        <li class="never" data-hits="" data-linenumber="187">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="188">


          <code class="ruby">      @level = &quot;Bronze&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="189">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="190">
          <span class="hits">1</span>

          <code class="ruby">    @need_doctype = true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="191">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="192">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="193">
          <span class="hits">1</span>

          <code class="ruby">  def confirm_sponsor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="194">


          <code class="ruby">    @sponsor = Sponsor.find(params[:sponsor_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="195">


          <code class="ruby">    project_sponsor = ProjectSponsor.unscoped.where(project_id: params[:project_id], sponsor_id: @sponsor.id).last</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="196">


          <code class="ruby">    project_sponsor.update_attributes!(status: &quot;confirmed&quot;, confirmed: true)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="197">


          <code class="ruby">    Sponsor.delay.send_confirmation_email(@sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="198">


          <code class="ruby">    redirect_to thank_you_for_sponsor_url(params[:project_id], @sponsor.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="199">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="200">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="201">
          <span class="hits">1</span>

          <code class="ruby">  def share_email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="202">


          <code class="ruby">    SponsorMailer.share_project(params[:emails], params[:project_id], params[:user]).deliver</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="203">


          <code class="ruby">    respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="204">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="205">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="206">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="207">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>

          <code class="ruby">  def project_id</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="209">
          <span class="hits">3</span>

          <code class="ruby">    @project = Project.find(params[:project_id])</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="210">
          <span class="hits">3</span>

          <code class="ruby">    @sponsorship_levels = SponsorshipLevel.all</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="211">
          <span class="hits">3</span>

          <code class="ruby">    sponsors_of_project = @project.project_sponsors</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="212">
          <span class="hits">3</span>

          <code class="ruby">    platinum = sponsors_of_project.select { |sponsor| sponsor.level_id.eql?(1) }.count</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="213">
          <span class="hits">3</span>

          <code class="ruby">    gold = sponsors_of_project.select { |sponsor| sponsor.level_id.eql?(2) }.count</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="214">
          <span class="hits">3</span>

          <code class="ruby">    silver = sponsors_of_project.select { |sponsor| sponsor.level_id.eql?(3) }.count</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="215">
          <span class="hits">3</span>

          <code class="ruby">    @sponsorship_levels.delete_if{|level| level.name.eql?(&quot;Platinum&quot;)} if platinum &gt;= 1</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="216">
          <span class="hits">3</span>

          <code class="ruby">    @sponsorship_levels.delete_if{|level| level.name.eql?(&quot;Gold&quot;)} if gold &gt;= 3</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="217">
          <span class="hits">3</span>

          <code class="ruby">    @sponsorship_levels.delete_if{|level| level.name.eql?(&quot;Silver&quot;)} if silver &gt;= 5</code>
        </li>

        <li class="never" data-hits="" data-linenumber="218">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="219">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>

          <code class="ruby">  def create_sponsor</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>

          <code class="ruby">    params[:project_sponsor][:anonymous] = params[:sponsor][:anonymous]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="222">
          <span class="hits">1</span>

          <code class="ruby">    params[:sponsor].delete(&quot;anonymous&quot;)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="223">
          <span class="hits">1</span>

          <code class="ruby">    sponsor = params[:sponsor]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>

          <code class="ruby">    sponsor_name = sponsor[:payment_type].eql?(&quot;Wire Transfer&quot;) ? sponsor[:name] : sponsor[:card_name]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>

          <code class="ruby">    project = Project.find(params[:project_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="226">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="227">
          <span class="hits">1</span>

          <code class="ruby">    cost = Sponsor.set_sponsorship_percentage(params[:project_sponsor][:level_id], project)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>

          <code class="ruby">    params[:sponsor][:name] = sponsor_name</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="229">
          <span class="hits">1</span>

          <code class="ruby">    card_type = params[:project_sponsor][:card_type]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>

          <code class="ruby">    last4 = params[:project_sponsor][:card_last4]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="231">
          <span class="hits">1</span>

          <code class="ruby">    token = params[:token]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>

          <code class="ruby">    @sponsor = Sponsor.new(params[:sponsor])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="233">
          <span class="hits">1</span>

          <code class="ruby">    @sponsor.email = current_user.email if params[:sponsor][:email].blank?</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>

          <code class="ruby">    @sponsor.save!(validate: false)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>

          <code class="ruby">    @project_sponsor = ProjectSponsor.create!(params[:project_sponsor])</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>

          <code class="ruby">    @project_sponsor.confirmed = false</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="237">
          <span class="hits">1</span>

          <code class="ruby">    @project_sponsor.save!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="238">
          <span class="hits">1</span>

          <code class="ruby">    @project_sponsor.update_attributes!({cost: cost, project_id: params[:project_id], sponsor_id: @sponsor.id,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="239">


          <code class="ruby">                                      level_id: params[:project_sponsor][:level_id], card_token: token,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="240">


          <code class="ruby">                                      card_type: card_type, card_last4: last4, sponsor_type: params[:type] })</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="241">
          <span class="hits">1</span>

          <code class="ruby">    session[:project_sponsor] = @project_sponsor</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>

          <code class="ruby">    SponsorMailer.delay.send_confirmation_email(@sponsor)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="243">
          <span class="hits">1</span>

          <code class="ruby">    SponsorMailer.delay.sponsor_thank_you(@sponsor.id, @sponsor.email)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="244">
          <span class="hits">1</span>

          <code class="ruby">    redirect_to confirmation_url(params[:project_id], @sponsor.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="245">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="246">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="247">
          <span class="hits">1</span>

          <code class="ruby">  def failed_create_sponsor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="248">


          <code class="ruby">    redirect_to :back</code>
        </li>

        <li class="never" data-hits="" data-linenumber="249">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="250">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="5162c5365abae115afbdd9320b3e130adfbd30e2">
  <div class="header">
    <h3>app/controllers/subscriptions_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SubscriptionsController &lt; ApplicationController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">    # TODO Stripe integration</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">    # TODO Stripe integration</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="60977a896a24f0176330c0fcd93c418373d37f3d">
  <div class="header">
    <h3>app/controllers/transparency_workroom_controller.rb</h3>
    <h4><span class="red">33.33 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class TransparencyWorkroomController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">	layout &quot;landing&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">	before_filter :authenticate_user!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">	def index</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">		@project = Project.find(params[:project_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">		@comment = Comment.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @question = Question.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">		@documents = @project.documents.all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">		@photo_vids = @project.galleries.media_transparent_room(params[:page])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">	def download_file</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">	  	require &#39;open-uri&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">	  	document = Document.find(params[:document_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">		url = document.url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">		data = open(url).read</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">		send_data data, :disposition =&gt; &#39;attachment&#39;, :filename =&gt; document.filename</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="9ea79f53d8b8d72f6df473990af568bc5c85df99">
  <div class="header">
    <h3>app/controllers/users/omniauth_callbacks_controller.rb</h3>
    <h4><span class="red">18.75 %</span> covered</h4>
    <div>
      <b>32</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>26</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Users::OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def facebook</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">    # You need to implement the method below in your model (e.g. app/models/user.rb)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    @user = User.find_for_social_oauth(request.env[&quot;omniauth.auth&quot;], current_user, &quot;facebook&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    if @user.persisted?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">      # sign_in_and_redirect @user, :event =&gt; :authentication #this will throw if @user is not activated</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">      sign_in(:user, @user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">      after_sign_in_modify</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">      session[&quot;devise.facebook_data&quot;] = request.env[&quot;omniauth.auth&quot;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      after_sign_in_modify</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def twitter</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    # You need to implement the method below in your model (e.g. app/models/user.rb)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @user = User.find_for_social_oauth(request.env[&quot;omniauth.auth&quot;], current_user, &quot;twitter&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    if @user.persisted?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      sign_in_and_redirect @user, :event =&gt; :authentication #this will throw if @user is not activated</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      set_flash_message(:notice, :success, :kind =&gt; &quot;Twitter&quot;) if is_navigational_format?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">      puts @user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">      session[&quot;devise.twitter_data&quot;] = request.env[&quot;omniauth.auth&quot;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">      redirect_to new_user_registration_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def linkedin</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">    # You need to implement the method below in your model (e.g. app/models/user.rb)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    @user = User.find_for_social_oauth(request.env[&quot;omniauth.auth&quot;], current_user, &quot;linkedln&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    if @user.persisted?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">      sign_in_and_redirect @user, :event =&gt; :authentication #this will throw if @user is not activated</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">      set_flash_message(:notice, :success, :kind =&gt; &quot;LinkedIn&quot;) if is_navigational_format?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">      session[&quot;devise.linkedin_data&quot;] = request.env[&quot;omniauth.auth&quot;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">      # redirect_to new_user_registration_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>

          <code class="ruby">  def after_sign_in_modify</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    # sign_up_url = url_for(:action =&gt; &#39;new&#39;, :controller =&gt; &#39;registration&#39;, :only_path =&gt; false, :protocol =&gt; &#39;http&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    if session[:redirect_url_last] == new_project_url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">      session.delete(:path)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">      project = resource.projects.build()</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">      project.save!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">      redirect_to &quot;/projects/#{project.id}/edit#sponsor-info&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="52">


          <code class="ruby">    elsif session[:redirect_url_last] == new_user_registration_url</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">      redirect_to root_url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">      redirect_to stored_location_for(resource) || session[:redirect_url_last] || request.referer ||  request.env[&#39;omniauth.origin&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="67a7fca30560b0aa7e131146aad3487b0612e328">
  <div class="header">
    <h3>app/controllers/users/passwords_controller.rb</h3>
    <h4><span class="red">34.29 %</span> covered</h4>
    <div>
      <b>35</b> relevant lines.
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>23</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Users::PasswordsController &lt; DeviseController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  prepend_before_filter :require_no_authentication</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  # Render the #edit only if coming from a reset password email link</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  append_before_filter :assert_reset_token_passed, :only =&gt; :edit</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  # GET /resource/password/new</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    self.resource = resource_class.new</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  # POST /resource/password</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    self.resource = resource_class.send_reset_password_instructions(resource_params)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    if successfully_sent?(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">      # respond_with({}, :location =&gt; after_sending_reset_password_instructions_path_for(resource_name))</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">      respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">        format.js</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">        format.html</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      render &#39;error_email&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  # GET /resource/password/edit?reset_password_token=abcdef</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">  def edit</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    self.resource = resource_class.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    resource.reset_password_token = params[:reset_password_token]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  # PUT /resource/password</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    self.resource = resource_class.reset_password_by_token(resource_params)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    if resource.errors.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">      resource.unlock_access! if unlockable?(resource)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">      flash_message = resource.active_for_authentication? ? :updated : :updated_not_active</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">      set_flash_message(:notice, flash_message) if is_navigational_format?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">      sign_in(resource_name, resource)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">      respond_with resource, :location =&gt; after_resetting_password_path_for(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">      respond_with resource</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  protected</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>

          <code class="ruby">  def after_resetting_password_path_for(resource)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">    after_sign_in_path_for(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">    # The path used after sending reset password instructions</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>

          <code class="ruby">    def after_sending_reset_password_instructions_path_for(resource_name)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">      new_session_path(resource_name) if is_navigational_format?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">    # Check if a reset_password_token is provided in the request</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>

          <code class="ruby">    def assert_reset_token_passed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">      if params[:reset_password_token].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">        set_flash_message(:alert, :no_token)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">        redirect_to new_session_path(resource_name)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">    # Check if proper Lockable module methods are present &amp; unlock strategy</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">    # allows to unlock resource on password reset</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>

          <code class="ruby">    def unlockable?(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby">      resource.respond_to?(:unlock_access!) &amp;&amp;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="69">


          <code class="ruby">      resource.respond_to?(:unlock_strategy_enabled?) &amp;&amp;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="70">


          <code class="ruby">      resource.unlock_strategy_enabled?(:email)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">  end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="1acb720140de400fd8e3a1a5ce4b2ca3a21dd0a1">
  <div class="header">
    <h3>app/controllers/users/sessions_controller.rb</h3>
    <h4><span class="red">28.13 %</span> covered</h4>
    <div>
      <b>32</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>23</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Users::SessionsController &lt; DeviseController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  prepend_before_filter :require_no_authentication, :only =&gt; [ :new, :create ]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  prepend_before_filter :allow_params_authentication!, :only =&gt; :create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  # GET /resource/sign_in</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    self.resource = resource_class.new(params[:user])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    clean_up_passwords(resource)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">      format.js</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      format.html</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    # respond_with(resource, serialize_options(resource))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  # POST /resource/sign_in</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    resource = warden.authenticate!(auth_options)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    set_flash_message(:notice, :signed_in) if is_navigational_format?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    sign_in(resource_name, resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    # if user_signed_in?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">      # unless params[:url].nil?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">      #   session[:redirect_url] = params[:url]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    #   redirect_to after_sign_in_path_for(resource)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">    # else</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">    #   respond_to :js</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    # end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    if request.xhr?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">      render js: &quot;window.location = &#39;#{after_sign_in_path_for(resource, params[:user])}&#39;;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">      respond_with resource, :location =&gt; after_sign_in_path_for(resource, params[:user])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">  # DELETE /resource/sign_out</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">  def destroy</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    redirect_path = after_sign_out_path_for(resource_name)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">    signed_out = (Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name))</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">    set_flash_message :notice, :signed_out if signed_out</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">    # We actually need to hardcode this as Rails default responder doesn&#39;t</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    # support returning empty response on GET request</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    respond_to do |format|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">      format.any(*navigational_formats) { redirect_to redirect_path }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">      format.all do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">        head :no_content</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>

          <code class="ruby">  protected</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>

          <code class="ruby">  def serialize_options(resource)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">    methods = resource_class.authentication_keys.dup</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">    methods = methods.keys if methods.is_a?(Hash)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">    methods &lt;&lt; :password if resource.respond_to?(:password)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">    { :methods =&gt; methods, :only =&gt; [:password] }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>

          <code class="ruby">  def auth_options</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">    { :scope =&gt; resource_name, :recall =&gt; &quot;#{controller_path}#new&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="1aab4395a7b4cb380b4dc44a06814340bc44c009">
  <div class="header">
    <h3>app/controllers/users_controller.rb</h3>
    <h4><span class="red">57.14 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class UsersController &lt; ApplicationController</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  skip_before_filter :set_previous_page</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :authenticate_user!</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  before_filter :check_user, only: :show</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  def show</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>

          <code class="ruby">    @user = User.find(params[:id])</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>

          <code class="ruby">    @is_current = @user == current_user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    # if params[:status].present?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">    #   comparison = params[:status].eql?(&quot;Funding Active&quot;) ? &quot;&gt;&quot; : &quot;&lt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">    #   @projects_created = @user.projects.live.where(&quot;campaign_deadline #{comparison} ? AND live = 1&quot;, Time.now).order(&quot;updated_at DESC&quot;).page(params[:created_page]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">    #   @projects_funded = @user.projects_funded.where(&quot;campaign_deadline #{comparison} ? AND live = 1&quot;, Time.now).order(&quot;updated_at DESC&quot;).page(params[:funded_page]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    #   @pending_projects = @user.projects.where(live: 0)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">    # else</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>

          <code class="ruby">    @projects_created = @user.projects.live.order(&quot;updated_at DESC&quot;).page(params[:created_page]).per(2)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>

          <code class="ruby">    @projects_funded = @user.projects_funded.live.order(&quot;updated_at DESC&quot;).page(params[:funded_page]).per(2)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>

          <code class="ruby">    @pending_projects = @user.projects.where(live: 0)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>

          <code class="ruby">    @tax_reports = @user.tax_reports.page(params[:tax_report]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">    # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  def profile</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    @user = User.find(params[:user_id])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">    # @pending_projects = @user.projects.where(live: 0)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    # @projects = Project.where(&quot;user_id = ?&quot;, current_user.id).page(params[:page]).per(2)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    if params[:status].present?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      comparison = params[:status].eql?(&quot;Funding Active&quot;) ? &quot;&gt;&quot; : &quot;&lt;&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">      @projects_created = @user.projects.live.where(&quot;campaign_deadline #{comparison} ? AND live = 1&quot;, Time.now).order(&quot;updated_at DESC&quot;).page(params[:created_page]).per(2)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">      @projects_funded = @user.projects_funded.where(&quot;campaign_deadline #{comparison} ? AND live = 1&quot;, Time.now).order(&quot;updated_at DESC&quot;).page(params[:funded_page]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">      @projects_created = @user.projects.live.order(&quot;updated_at DESC&quot;).page(params[:created_page]).per(2)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">      @projects_funded = @user.projects_funded.live.order(&quot;updated_at DESC&quot;).page(params[:funded_page]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">    # @projects_funded = current_user.projects_funded.page(params[:page]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def get_complete_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    @user = User.find(params[:user_id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    comparison = params[:status].eql?(&quot;Funding Active&quot;) ? &quot;&gt;&quot; : &quot;&lt;&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">    @projects_funded = @user.projects_funded.where(&quot;campaign_deadline #{comparison} ? AND live = 1&quot;, Time.now).order(&quot;updated_at DESC&quot;).page(params[:funded_page]).per(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>

          <code class="ruby">  private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  def check_user</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>

          <code class="ruby">    unless current_user.id.to_s.eql?(params[:id])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">      flash[:error] = &quot;Sorry, you don&#39;t have right permision to accessing page.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">      redirect_to root_url and return false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="675d841ad552c76d335195e789cab0597f03dd0d">
  <div class="header">
    <h3>app/helpers/application_helper.rb</h3>
    <h4><span class="red">49.26 %</span> covered</h4>
    <div>
      <b>136</b> relevant lines.
      <span class="green"><b>67</b> lines covered</span> and
      <span class="red"><b>69</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module ApplicationHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">	def current_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">		session[:current_project]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def recognize_url(url)</code>
        </li>

        <li class="covered" data-hits="10" data-linenumber="8">
          <span class="hits">10</span>

          <code class="ruby">    if url.nil?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">      nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="11">
          <span class="hits">9</span>

          <code class="ruby">      if url.include?(&quot;http://&quot;) or url.include?(&quot;https://&quot;)</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="12">
          <span class="hits">9</span>

          <code class="ruby">        url</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">        &quot;http://#{url}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  def check_availibility(project, level)</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="20">
          <span class="hits">9</span>

          <code class="ruby">    total_sponsor = project.project_sponsors.where(level_id: level).count</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def strip_url(url)</code>
        </li>

        <li class="covered" data-hits="11" data-linenumber="24">
          <span class="hits">11</span>

          <code class="ruby">    url.sub(/^https?\:\/\//, &#39;&#39;).sub(/^www./,&#39;&#39;) rescue nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">  def amount_converter(amount)</code>
        </li>

        <li class="covered" data-hits="203" data-linenumber="28">
          <span class="hits">203</span>

          <code class="ruby">    if amount.to_f.to_s.length &gt; 9</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      number_to_currency(number_to_human(amount, precision: 2))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="203" data-linenumber="31">
          <span class="hits">203</span>

          <code class="ruby">      number_to_currency(amount, precision: 0)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>

          <code class="ruby">  def amount_converter_field(amount)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    if amount.to_s.length &gt; 9</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">      number_to_currency(number_to_human(amount, precision: 3))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">      number_to_currency(amount, precision: 0)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">  def percent_funded(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">    project = Project.find(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">    donation = Donation.where(&quot;project_id = ?&quot;, id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">    total_funded = 0.0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    donation.each do |d|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">     total_funded = total_funded + d.amount.to_f</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">   end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">   project_goal = project.goal.to_s.gsub(/,/, &#39;&#39;).to_f</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="52">


          <code class="ruby">   percentage = total_funded/project_goal</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">   return percentage.round(2) * 100</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">		# return total_funded</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">		# return percentage</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">		# return total_funded</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>

          <code class="ruby">  def percentage_sponsor(project)</code>
        </li>

        <li class="covered" data-hits="17" data-linenumber="61">
          <span class="hits">17</span>

          <code class="ruby">    donation = Donation.where(&quot;project_id = ?&quot;, project.id)</code>
        </li>

        <li class="covered" data-hits="17" data-linenumber="62">
          <span class="hits">17</span>

          <code class="ruby">    total_funded = 0.0</code>
        </li>

        <li class="covered" data-hits="17" data-linenumber="63">
          <span class="hits">17</span>

          <code class="ruby">    donation.each do |d|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">      total_funded = total_funded + d.amount.to_f</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="17" data-linenumber="66">
          <span class="hits">17</span>

          <code class="ruby">    total_funded += project.project_sponsors.sum(:cost)</code>
        </li>

        <li class="covered" data-hits="17" data-linenumber="67">
          <span class="hits">17</span>

          <code class="ruby">    percentage = (total_funded/project.goal.to_i).round(2) * 100</code>
        </li>

        <li class="covered" data-hits="17" data-linenumber="68">
          <span class="hits">17</span>

          <code class="ruby">    return percentage</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="70">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>

          <code class="ruby">  def totalsponsor(project)</code>
        </li>

        <li class="covered" data-hits="8" data-linenumber="72">
          <span class="hits">8</span>

          <code class="ruby">    donation = Donation.where(&quot;project_id = ?&quot;, project.id)</code>
        </li>

        <li class="covered" data-hits="8" data-linenumber="73">
          <span class="hits">8</span>

          <code class="ruby">    total_funded = 0.0</code>
        </li>

        <li class="covered" data-hits="8" data-linenumber="74">
          <span class="hits">8</span>

          <code class="ruby">    donation.each do |d|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">      total_funded = total_funded + d.amount.to_f</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="8" data-linenumber="77">
          <span class="hits">8</span>

          <code class="ruby">    total_funded += project.project_sponsors.sum(:cost)</code>
        </li>

        <li class="covered" data-hits="8" data-linenumber="78">
          <span class="hits">8</span>

          <code class="ruby">    return total_funded</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>

          <code class="ruby">  def amount_funded(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="82">


          <code class="ruby">    project = Project.find(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="83">


          <code class="ruby">    donation = Donation.where(&quot;project_id = ?&quot;, id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="84">


          <code class="ruby">    total_funded = 0.0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">    donation.each do |d|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">     total_funded = total_funded + d.amount.to_f</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="88">


          <code class="ruby">		# percentage = total_funded/project.goal</code>
        </li>

        <li class="never" data-hits="" data-linenumber="89">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="90">


          <code class="ruby">		# return percentage.round(2) * 100</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="91">


          <code class="ruby">		return total_funded</code>
        </li>

        <li class="never" data-hits="" data-linenumber="92">


          <code class="ruby">		# return percentage</code>
        </li>

        <li class="never" data-hits="" data-linenumber="93">


          <code class="ruby">		# return total_funded</code>
        </li>

        <li class="never" data-hits="" data-linenumber="94">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>

          <code class="ruby">	def get_user(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">		user = User.find_by_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="98">


          <code class="ruby">		return user.name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="99">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="100">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>

          <code class="ruby">	def get_gravatar(email, size)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="102">


          <code class="ruby">		digest = Digest::MD5.hexdigest(email)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="103">


          <code class="ruby">		return &quot;http://www.gravatar.com/avatar/&quot; + digest + &quot;.jpg?s=#{size}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>

          <code class="ruby">  def clean_data(data)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="107">


          <code class="ruby">    clean = data.html_safe</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="108">


          <code class="ruby">    return clean</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>

          <code class="ruby">  def get_currency(amount)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="112">


          <code class="ruby">    amount = amount.to_s.gsub(/,/, &#39;&#39;).to_f</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">    number_to_currency(amount, :precision =&gt; 0)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="114">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="115">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>

          <code class="ruby">  def stripe_pub_key</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="117">


          <code class="ruby">    return &quot;pk_test_1XvbGBUir6OeX1ljhENDmZ7h&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="119">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>

          <code class="ruby">  def project_sponsor_by_level(founders, page_num)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="121">


          <code class="ruby">    if page_num.nil?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="122">


          <code class="ruby">      gold_sponsors, silver_sponsors, bronze_sponsors, platinum_sponsors = [], [], [], []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="123">


          <code class="ruby">      founders.each do |sponsor|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="124">


          <code class="ruby">        if sponsor.level_id.eql?(1)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">          platinum_sponsors &lt;&lt; sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby">        elsif sponsor.level_id.eql?(2)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="127">


          <code class="ruby">          gold_sponsors &lt;&lt; sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="128">


          <code class="ruby">        elsif sponsor.level_id.eql?(3)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="129">


          <code class="ruby">          silver_sponsors &lt;&lt; sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="130">


          <code class="ruby">        elsif sponsor.level_id.eql?(4)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="131">


          <code class="ruby">          bronze_sponsors &lt;&lt; sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="132">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="133">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="134">


          <code class="ruby">      sponsors = {</code>
        </li>

        <li class="never" data-hits="" data-linenumber="135">


          <code class="ruby">        &quot;PLATINUM&quot; =&gt; platinum_sponsors,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="136">


          <code class="ruby">        &quot;GOLD&quot; =&gt; gold_sponsors,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="137">


          <code class="ruby">        &quot;SILVER&quot; =&gt; silver_sponsors,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="138">


          <code class="ruby">        &quot;BRONZE&quot; =&gt; bronze_sponsors</code>
        </li>

        <li class="never" data-hits="" data-linenumber="139">


          <code class="ruby">      }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="140">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="141">


          <code class="ruby">      bronze_sponsors = []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="142">


          <code class="ruby">      founders.each do |sponsor|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="143">


          <code class="ruby">        bronze_sponsors &lt;&lt; sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="144">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="145">


          <code class="ruby">      sponsors = { &quot;BRONZE&quot; =&gt; bronze_sponsors }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="146">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="147">


          <code class="ruby">    sponsors</code>
        </li>

        <li class="never" data-hits="" data-linenumber="148">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="149">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>

          <code class="ruby">  def count_project_sponsor_by_level(sponsors, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="151">


          <code class="ruby">    if sponsors.blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="152">


          <code class="ruby">      0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="153">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="154">


          <code class="ruby">      id_level = sponsors.first.level_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="155">


          <code class="ruby">      ProjectSponsor.where(level_id: id_level, project_id: project.id).count</code>
        </li>

        <li class="never" data-hits="" data-linenumber="156">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="157">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="158">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>

          <code class="ruby">  def count_percentage(total, amount)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="160">


          <code class="ruby">    total_precentage = if total.to_i.eql?(0) and amount.to_i.eql?(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="161">


          <code class="ruby">      0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="162">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="163">


          <code class="ruby">      percentage = amount.to_f / total.to_f * 100.0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="164">


          <code class="ruby">      percentage.to_s[0..3]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="165">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="166">


          <code class="ruby">    return &quot;#{total_precentage} %&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="167">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="168">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>

          <code class="ruby">  def wizard_link(step, project)</code>
        </li>

        <li class="covered" data-hits="35" data-linenumber="170">
          <span class="hits">35</span>

          <code class="ruby">    if step.eql?(&quot;sponsor_info&quot;)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="171">
          <span class="hits">7</span>

          <code class="ruby">      &quot;/projects/#{project.id}/edit#sponsor-info&quot;</code>
        </li>

        <li class="covered" data-hits="28" data-linenumber="172">
          <span class="hits">28</span>

          <code class="ruby">    elsif step.eql?(&quot;project_details&quot;)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="173">
          <span class="hits">7</span>

          <code class="ruby">      if [&quot;first&quot;, &quot;second&quot;, &quot;third&quot;, &quot;fourth&quot;, &quot;last&quot;].include? session[:step]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>

          <code class="ruby">        &quot;/projects/#{project.id}/edit#project-details&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="175">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="176">
          <span class="hits">6</span>

          <code class="ruby">        &quot;javascript:void(0)&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="177">


          <code class="ruby">      end</code>
        </li>

        <li class="covered" data-hits="21" data-linenumber="178">
          <span class="hits">21</span>

          <code class="ruby">    elsif step.eql?(&quot;perks&quot;)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="179">
          <span class="hits">7</span>

          <code class="ruby">      if [&quot;second&quot;, &quot;third&quot;, &quot;fourth&quot;, &quot;last&quot;].include? session[:step]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="180">
          <span class="hits">1</span>

          <code class="ruby">        &quot;/projects/#{project.id}/edit#perks&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="181">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="182">
          <span class="hits">6</span>

          <code class="ruby">        &quot;javascript:void(0)&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="183">


          <code class="ruby">      end</code>
        </li>

        <li class="covered" data-hits="14" data-linenumber="184">
          <span class="hits">14</span>

          <code class="ruby">    elsif step.eql?(&quot;sponsorship&quot;)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="185">
          <span class="hits">7</span>

          <code class="ruby">      if [&quot;third&quot;, &quot;fourth&quot;, &quot;last&quot;].include? session[:step]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="186">
          <span class="hits">1</span>

          <code class="ruby">        &quot;/projects/#{project.id}/edit#sponsorship&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="187">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="188">
          <span class="hits">6</span>

          <code class="ruby">        &quot;javascript:void(0)&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="189">


          <code class="ruby">      end</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="190">
          <span class="hits">7</span>

          <code class="ruby">    elsif step.eql?(&quot;assets&quot;)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="191">
          <span class="hits">7</span>

          <code class="ruby">      if [&quot;fourth&quot;, &quot;last&quot;].include? session[:step]</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="192">
          <span class="hits">1</span>

          <code class="ruby">        &quot;/projects/#{project.id}/edit#assets&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="193">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="194">
          <span class="hits">6</span>

          <code class="ruby">        &quot;javascript:void(0)&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="195">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="196">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="197">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="198">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>

          <code class="ruby">  def total_amount_by_donor(donations)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="200">


          <code class="ruby">    donations.map { |donation| donation.amount }.inject(0) {|sum, element| sum + element }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="201">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="202">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>

          <code class="ruby">  def total_donor_by_level(perk_name, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="204">


          <code class="ruby">    Donation.where(perk_name: perk_name, project_id: project.id).group_by { |donation| donation.user_id }.count</code>
        </li>

        <li class="never" data-hits="" data-linenumber="205">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="206">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="207">
          <span class="hits">1</span>

          <code class="ruby">  def avatar_project_admin(avatar_link, anonymous)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="208">


          <code class="ruby">    if anonymous</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="209">


          <code class="ruby">      avatar_link = &quot;anonymous.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="210">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="211">


          <code class="ruby">      avatar_link = &quot;default-user.png&quot; if avatar_link.eql?(&quot;/images/default-avatar.png&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="212">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="213">


          <code class="ruby">    avatar_link</code>
        </li>

        <li class="never" data-hits="" data-linenumber="214">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="215">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>

          <code class="ruby">  def donor_name_project_admin(name, anonymous)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="217">


          <code class="ruby">    name = &quot;Anonymous Donor&quot; if anonymous</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="218">


          <code class="ruby">    name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="219">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="220">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>

          <code class="ruby">  def get_interval_chart(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="222">


          <code class="ruby">    interval = project.duration.to_i &lt; 45 ? 1 : 5</code>
        </li>

        <li class="never" data-hits="" data-linenumber="223">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="224">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>

          <code class="ruby">  def show_td_mark(project)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="226">
          <span class="hits">7</span>

          <code class="ruby">    if project.organization_classification.eql?(&quot;170(c)(1)&quot;) || project.organization_classification.eql?(&quot;501(c)(3)&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="227">


          <code class="ruby">      &quot;display: block&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="228">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="229">
          <span class="hits">7</span>

          <code class="ruby">      &quot;display:none&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="230">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="231">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="232">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="233">
          <span class="hits">1</span>

          <code class="ruby">  def message_style(controller_name, action_name)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="234">


          <code class="ruby">    if ( controller_name.eql?(&quot;users&quot;) and action_name.eql?(&quot;show&quot;) ) or ( controller_name.eql?(&quot;users&quot;) and action_name.eql?(&quot;profile&quot;) )</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="235">


          <code class="ruby">      &quot;display:none&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="236">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="237">


          <code class="ruby">      &quot;display:block&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="238">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="239">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="240">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="241">
          <span class="hits">1</span>

          <code class="ruby">  def document_thumbnail(url, width)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="242">


          <code class="ruby">    &quot;http://docs.google.com/viewer?url=#{url}&amp;a=bi&amp;pagenumber=1&amp;w=#{width}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="243">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="244">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="245">
          <span class="hits">1</span>

          <code class="ruby">  def full_name user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="246">


          <code class="ruby">    return &quot;- #{user.first_name} #{user.last_name}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="247">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="248">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="249">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="59c94a4a12c07eb6dde0b0e13aff5f4704769bd7">
  <div class="header">
    <h3>app/helpers/devise_helper.rb</h3>
    <h4><span class="red">42.86 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module DeviseHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def devise_error_messages!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    unless resource.errors.full_messages.blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">      &quot;&lt;div class=&#39;alert&#39;&gt;#{resource.errors.full_messages.map { |msg| content_tag(:div, msg) }.join}&lt;/div&gt;&quot;.html_safe</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def forgot_password_messages!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    unless resource.errors.full_messages.blank?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">      &quot;&lt;div class=&#39;alert&#39;&gt;We are sorry, that email address doesn&#39;t exist.</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      Please login using a different address or #{link_to &#39;sign up&#39;, new_user_registration_path}&lt;/div&gt;&quot;.html_safe</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="a32b941304031f144fb5a91339432086460a671e">
  <div class="header">
    <h3>app/helpers/donations_helper.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module DonationsHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">	def current_user_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">		current_user.id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="87399e82acb917bdbbc3e1081c004da716ab5509">
  <div class="header">
    <h3>app/helpers/identities_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module IdentitiesHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="5868eaabdab9a671171a5b3973ec890c2965e49c">
  <div class="header">
    <h3>app/helpers/mailer_helper.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module MailerHelper</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">	def make_currency(amount)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">		number_to_currency(amount, precision: 0)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="0565456c5539d347f0571190d89f295229db842f">
  <div class="header">
    <h3>app/helpers/memberships_helper.rb</h3>
    <h4><span class="red">32.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>17</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module MembershipsHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def membership_title(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    user.membership.kind.titlecase</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def next_membership_renewal_date(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    (user.membership.updated_at + 1.month).strftime(&#39;%m-%d-%Y&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def membership_expire_date(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    (user.membership.updated_at + 1.month - 1.day).strftime(&#39;%m-%d-%Y&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def membership_cost(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    case user.membership.kind</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    when &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      &#39;5% of any amount raised on each project&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    when &#39;basic&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">      &#39;$99 every 1 month&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">    when &#39;plus&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      &#39;$149 every 1 month&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  def membership_cost_by_plan(plan)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    case plan.name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">    when &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      &#39;5% of any amount raised on each project&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    when &#39;basic&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">      &#39;$99 every 1 month&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">    when &#39;plus&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">      &#39;$149 every 1 month&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>

          <code class="ruby">  def membership_cost_message_start(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    case user.membership.kind</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">    when &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">      &#39;means you will be charged&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">    when &#39;basic&#39;, &#39;plus&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">      &quot;will be automatically renewed #{next_membership_renewal_date(user)} and charged&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>

          <code class="ruby">  def membership_cost_message_end(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    case user.membership.kind</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">    when &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">      &#39;unless you change or cancel it.&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">    when &#39;basic&#39;, &#39;plus&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">      &#39;unless you cancel your subscription before that time.&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="df42ae8a85a5bb23564d48b9e2a75d821c2936ce">
  <div class="header">
    <h3>app/helpers/navigation_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module NavigationHelper</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def features_page?</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="3">
          <span class="hits">25</span>

          <code class="ruby">    features_pages = [&#39;/pages/fundraising&#39;, &#39;/pages/donor_relationship&#39;, &#39;/pages/analytics&#39;, &#39;/pages/donor_convenience&#39;]</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="4">
          <span class="hits">25</span>

          <code class="ruby">    features_pages.include?(request.path)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="379787e76c6da5d84f17a7f1530847869608297d">
  <div class="header">
    <h3>app/helpers/pages_helper.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module PagesHelper</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def campaign_days_left(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    ((project.campaign_deadline.end_of_day - DateTime.current) / 1.day).to_i rescue 0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="78611b50266244e79240ce286e4dc9d39b8cffaf">
  <div class="header">
    <h3>app/helpers/payment_helper.rb</h3>
    <h4><span class="red">22.22 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module PaymentHelper</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def car_type_logo(card)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    case card.type</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">    when &quot;Visa&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">      &quot;logo_visa.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">    when &quot;MasterCard&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">      &quot;logo_mastercard.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">    when &quot;American Express&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">      &quot;logo_american_express.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    when &quot;Discover&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">      &quot;logo_discover.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">    when &quot;Diners Club&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">      &quot;logo_dinners.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">      &quot;logo_jcb.png&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="2196ab0203eaae2498e68fcf83d03c1a22d92024">
  <div class="header">
    <h3>app/helpers/projects_helper.rb</h3>
    <h4><span class="red">57.78 %</span> covered</h4>
    <div>
      <b>45</b> relevant lines.
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>19</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module ProjectsHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">	def time_left(endDate, startDate)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    endDate = Date.parse(startDate) + endDate.to_i.days</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    finalDate = endDate - Date.today</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    return finalDate.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def project_title(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    project = Project.find(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    return project.title</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  def current_project</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>

          <code class="ruby">    session[:current_project]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">  def project_categories</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    [</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="20">
          <span class="hits">7</span>

          <code class="ruby">      [&#39;Art / Culture&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">      [&#39;Athletic / Sports&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">      [&#39;Education / Schools&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">      [&#39;Health / Wellness&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">      [&#39;Local Business&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">      [&#39;Neighborhood Improvements&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">      [&#39;Parks &amp; Recreation&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">      [&#39;Safety&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">      [&#39;Sustainability / Energy&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">      [&#39;Technology&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">      [&#39;Transit / Transportation&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">      [&#39;Walkability / Bike / Paths&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">    ]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>

          <code class="ruby">  def project_org_type</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">    [</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="37">
          <span class="hits">7</span>

          <code class="ruby">      [&#39;School&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">      [&#39;Church&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">      [&#39;Municipal&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">      [&#39;Member&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">      [&#39;Foundation&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">      [&#39;Other Civic&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">    ]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>

          <code class="ruby">  def project_org_class</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">    [</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="48">
          <span class="hits">7</span>

          <code class="ruby">      [&#39;501(c)(3)&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">      [&#39;501(c)(4)&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">      [&#39;501(c)(6)&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">      [&#39;501(c)(7)&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">      [&#39;170(c)(1)&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">    ]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>

          <code class="ruby">  def project_duration(duration)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">    if !duration.nil?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">      Time.parse(duration).strftime(&quot;%m/%d/%y&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>

          <code class="ruby">  def stored_content</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">    content_for :description do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">      &quot;This is some text&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>

          <code class="ruby">  def action_image(image, video)</code>
        </li>

        <li class="covered" data-hits="14" data-linenumber="69">
          <span class="hits">14</span>

          <code class="ruby">    if !image.blank? or !video.blank?</code>
        </li>

        <li class="covered" data-hits="12" data-linenumber="70">
          <span class="hits">12</span>

          <code class="ruby">      &quot;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="72">
          <span class="hits">2</span>

          <code class="ruby">      &quot;display:none&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>

          <code class="ruby">  def campaign_days_left(project)</code>
        </li>

        <li class="covered" data-hits="12" data-linenumber="77">
          <span class="hits">12</span>

          <code class="ruby">    ((project.campaign_deadline.end_of_day - DateTime.current) / 1.day).to_i rescue 0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>

          <code class="ruby">  def default_perk</code>
        </li>

        <li class="covered" data-hits="16" data-linenumber="81">
          <span class="hits">16</span>

          <code class="ruby">    [&quot;10&quot;, &quot;25&quot;, &quot;50&quot;, &quot;100&quot;, &quot;250&quot;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>

          <code class="ruby">  def image_sponsor(sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">    if sponsor.anonymous</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">      image_tag(&quot;uruut-fb-og.png&quot;, class: &quot;img-polaroid&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="88">


          <code class="ruby">      link_to(image_tag(sponsor.logo, class: &quot;img-polaroid&quot;), recognize_url(sponsor.site), target: &quot;_blank&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="89">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="90">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="91">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>

          <code class="ruby">  def sponsor_name(sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="93">


          <code class="ruby">    if sponsor.anonymous</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">      &quot;&lt;a href=&#39;javascript:void(0)&#39;&gt;ANONYMOUS &lt;br&gt; SPONSOR&lt;/a&gt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="96">


          <code class="ruby">      link_to(sponsor.name, recognize_url(sponsor.site), target: &quot;_blank&quot;, style: &quot;color: #70bf4c;&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="97">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="99">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>

          <code class="ruby">  def sponsor_link(sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="101">


          <code class="ruby">    unless sponsor.site.nil? or sponsor.anonymous</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="102">


          <code class="ruby">      link_to(strip_url(sponsor.site), recognize_url(sponsor.site), target: &quot;_blank&quot;, style: &quot;&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="103">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>

          <code class="ruby">  def sponsor_item(sponsor)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="107">


          <code class="ruby">    &quot;&lt;div class=&#39;sponsor&#39;&gt;#{image_sponsor(sponsor)}</code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby">      &lt;h5&gt;#{sponsor_name(sponsor)}&lt;/h5&gt;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby">      #{sponsor_link(sponsor)}</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="110">


          <code class="ruby">    &lt;/div&gt;&quot;.html_safe</code>
        </li>

        <li class="never" data-hits="" data-linenumber="111">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="112">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>

          <code class="ruby">  def any_project_donors_or_sponsors?(project)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="114">


          <code class="ruby">    User.who_donated_to(project).any? ||</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="115">


          <code class="ruby">    project.project_sponsors.any?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="116">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="117">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="f0ed26846a32ed31207c30f278e1128e963e78fe">
  <div class="header">
    <h3>app/helpers/sponsors/dashboard_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module Sponsors::DashboardHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="c801de131565edff2dd7b24ed0b9c9112bebaa74">
  <div class="header">
    <h3>app/helpers/sponsors_helper.rb</h3>
    <h4><span class="red">51.85 %</span> covered</h4>
    <div>
      <b>27</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module SponsorsHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def sponsor_option(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    sponsorship_levels_active = []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    project = Project.find(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    level_groups = project.project_sponsors.count(group: &quot;level_id&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    levels = project.sponsorship_levels.pluck(:id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    levels.each { |level| level_groups[level] = 0 unless level_groups.keys.include? level }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    level_groups.each do |key, value|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">      active = project.sponsorship_levels.where(&quot;id = ? AND funding_goal &gt; ?&quot;, key, value)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">      sponsorship_levels_active &lt;&lt; active if !active.size.zero?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    sponsorship_levels_active.flatten</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  def default_result(sponsorship_level, selected_level=nil)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    selected_level ? @selected_level : @sponsorship_levels.first</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def availability(sponsors, level)</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="24">
          <span class="hits">9</span>

          <code class="ruby">    number_of_sponsor = sponsors.where(level_id: level).count</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="26">
          <span class="hits">9</span>

          <code class="ruby">    if level.eql?(1)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="27">
          <span class="hits">3</span>

          <code class="ruby">      if number_of_sponsor &lt; 1</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>

          <code class="ruby">        1</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">        0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">      end</code>
        </li>

        <li class="covered" data-hits="6" data-linenumber="32">
          <span class="hits">6</span>

          <code class="ruby">    elsif level.eql?(2)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>

          <code class="ruby">      if number_of_sponsor &lt; 3</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>

          <code class="ruby">        3 - number_of_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">        0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">      end</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>

          <code class="ruby">    elsif level.eql?(3)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>

          <code class="ruby">      if number_of_sponsor &lt; 5</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="40">
          <span class="hits">3</span>

          <code class="ruby">        5 - number_of_sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">        0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="d937c9f16c10c0de3c4851bda5719bf06ff3ded8">
  <div class="header">
    <h3>app/helpers/users_helper.rb</h3>
    <h4><span class="red">69.23 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">module UsersHelper</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">	def us_states</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">	    [</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="4">
          <span class="hits">7</span>

          <code class="ruby">	      [&#39;AL&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">	      [&#39;AK&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">	      [&#39;AZ&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">	      [&#39;AR&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">	      [&#39;CA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">	      [&#39;CO&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">	      [&#39;CT&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">	      [&#39;DE&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">	      [&#39;DC&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">	      [&#39;FL&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">	      [&#39;GA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">	      [&#39;HI&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">	      [&#39;ID&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">	      [&#39;IL&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">	      [&#39;IN&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">	      [&#39;IA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">	      [&#39;KS&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">	      [&#39;KY&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">	      [&#39;LA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">	      [&#39;ME&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">	      [&#39;MD&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">	      [&#39;MA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">	      [&#39;MI&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">	      [&#39;MN&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">	      [&#39;MS&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">	      [&#39;MO&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">	      [&#39;MT&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">	      [&#39;NE&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">	      [&#39;NV&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">	      [&#39;NH&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">	      [&#39;NJ&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">	      [&#39;NM&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">	      [&#39;NY&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">	      [&#39;NC&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">	      [&#39;ND&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">	      [&#39;OH&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">	      [&#39;OK&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">	      [&#39;OR&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">	      [&#39;PA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">	      [&#39;PR&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">	      [&#39;RI&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">	      [&#39;SC&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">	      [&#39;SD&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">	      [&#39;TN&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">	      [&#39;TX&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">	      [&#39;UT&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">	      [&#39;VT&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">	      [&#39;VA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">	      [&#39;WA&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">	      [&#39;WV&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">	      [&#39;WI&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">	      [&#39;WY&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">	    ]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>

          <code class="ruby">	def project_length</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">	    [</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="61">
          <span class="hits">7</span>

          <code class="ruby">        [30],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">        [45],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">        [60],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby">        [75],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">        [90]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">	    ]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">  # Helper method for I - They on User profile page</code>
        </li>

        <li class="never" data-hits="" data-linenumber="70">


          <code class="ruby">  # @param type</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">  # :who - I, they</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">  # :whose - my, their</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>

          <code class="ruby">  def who(type = :who)</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="74">
          <span class="hits">4</span>

          <code class="ruby">    if @is_current</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="75">
          <span class="hits">4</span>

          <code class="ruby">      if type == :who</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">        &quot;I&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="78">
          <span class="hits">4</span>

          <code class="ruby">        &quot;My&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="81">


          <code class="ruby">      if type == :who</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="82">


          <code class="ruby">        &quot;They&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="84">


          <code class="ruby">        &quot;Their&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="85">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="86">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="88">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="89">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="cf12371121596006810fb66f6365843cc686eeec">
  <div class="header">
    <h3>app/mailer_previews/contact_mailer_preview.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ContactMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def contact_confirmation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    ContactMailer.contact_confirmation name, email, subject, message</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="123e75c980b7cf5f92874586382c294380f0dae0">
  <div class="header">
    <h3>app/mailer_previews/demo_request_mailer_preview.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class DemoRequestMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def scheduled_demo_confirmation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    DemoRequestMailer.scheduled_demo_confirmation demo_request</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="38343f5929f28ca19a7ff97b38d1d2d86655bbe4">
  <div class="header">
    <h3>app/mailer_previews/donation_mailer_preview.rb</h3>
    <h4><span class="red">57.14 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class DonationMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def share_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    DonationMailer.share_project recepient, project_id, user_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def donation_confirmation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    DonationMailer.donation_confirmation donation</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def send_donation_report</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    DonationMailer.send_donation_report </code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="46a3fc2dfe7e14e3e87e77f631598f6cac519d9c">
  <div class="header">
    <h3>app/mailer_previews/milestone_mailer_preview.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class MilestoneMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def milestone_email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    MilestoneMailer.milestone_email email, percent, project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="c624cfe5f3673105a2a3d86e3247ea9dac077424">
  <div class="header">
    <h3>app/mailer_previews/newsletter_mailer_preview.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class NewsletterMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def newsletter_confirmation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    NewsletterMailer.newsletter_confirmation newsletter</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="e8f98f95e47f0d2f8f4c2a287fc4ff6f06e3072c">
  <div class="header">
    <h3>app/mailer_previews/project_mailer_preview.rb</h3>
    <h4><span class="red">57.14 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def project_confirmation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    ProjectMailer.project_confirmation project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def project_message</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    ProjectMailer.project_message recepient, subject_email, header_image, content</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def project_approved</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    ProjectMailer.project_approved project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="c651b9e6cb3588366f4ae47839b3c4c6be41cae8">
  <div class="header">
    <h3>app/mailer_previews/question_mailer_preview.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class QuestionMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def send_question</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    QuestionMailer.send_question owner, name, email, subject, body</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="a077b9593ac724b81cfa81a6dd130c5a959510d2">
  <div class="header">
    <h3>app/mailer_previews/sponsor_mailer_preview.rb</h3>
    <h4><span class="red">55.56 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SponsorMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def share_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    SponsorMailer.share_project recepient, project_id, user_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def new_sponsor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    SponsorMailer.new_sponsor sponsor</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def sponsor_thank_you</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    SponsorMailer.sponsor_thank_you sponsor, email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def send_sponsor_report</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    SponsorMailer.send_sponsor_report </code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="a1feffab53e2b345b62a36cac554e7b4a6009659">
  <div class="header">
    <h3>app/mailer_previews/welcome_mailer_preview.rb</h3>
    <h4><span class="red">50.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class WelcomeMailerPreview</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  def welcome_confirmation_donor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="3">


          <code class="ruby">    WelcomeMailer.welcome_confirmation_donor mock_user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def welcome_confirmation_user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    WelcomeMailer.welcome_confirmation_user mock_user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def mock_user(first_name=&#39;Bill&#39;, last_name=&#39;Gates&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    fake_id User.new(first_name: first_name, last_name: last_name, email: &quot;user#{rand 100}@test.com&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def fake_id(obj)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    # overrides the method on just this object</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    obj.define_singleton_method(:id) { 123 + rand(100) }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    obj</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="b0e247cd3d0aac6e4bfe6a650df91d36f548177f">
  <div class="header">
    <h3>app/mailers/contact_mailer.rb</h3>
    <h4><span class="red">37.5 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ContactMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  # default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  # default to: &quot;mfeinberg@uruut.com, bnorwood@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  # Subject can be set in your I18n file at config/locales/en.yml</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  # with the following lookup:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  #   en.contact_mailer.contact_confirmation.subject</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  #</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def contact_confirmation(name, email, subject, message)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @name = name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    @email = email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @message = message</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @subject = subject</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    mail subject: @subject, from: @email, to: &quot;info@uruut.com&quot;, bcc: &quot;mfeinberg@uruut.com, pbrobson@uruut.com, bnorwood@uruut&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="1263879ab3b8855a469cf932fc43ee40f7e4050c">
  <div class="header">
    <h3>app/mailers/demo_request_mailer.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class DemoRequestMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def scheduled_demo_confirmation(demo_request)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @user = demo_request</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    mail to: demo_request.email, bcc: &quot;charris@uruut.com, mfeinberg@uruut.com, bnorwood@uruut.com, alejo+bcc@bandofcoders.com&quot;, subject: &#39;Uruut - Schedule Your Demo?&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="53f530d65f7208d4d44cd9904134296d34097abd">
  <div class="header">
    <h3>app/mailers/donation_mailer.rb</h3>
    <h4><span class="red">18.18 %</span> covered</h4>
    <div>
      <b>33</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>27</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class DonationMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  # Subject can be set in your I18n file at config/locales/en.yml</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  # with the following lookup:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  #   en.contact_mailer.contact_confirmation.subject</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def share_project(recepient, project_id, user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @project = Project.find(project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    @project_title = @project.project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @project_id = @project.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    user = User.find_by_id(user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    @donator_name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    @image = @project.large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    mail to: recepient, subject: &quot;Checkout The Project I Donated To&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def donation_confirmation(donation)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">    user = User.find_by_id(donation.user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    project = Project.find(donation.project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    sponsor = User.find_by_id(project.user_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    @donation_amount = donation.amount</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    @donator_name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    @email = user.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    @image = project.large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    @project = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    @project_id = project.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    @project_facebook = @project.facebook_page</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    @project_twitter = @project.twitter_handle</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    @project_title = project.project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    @sponsor_email = sponsor.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">    @sponsor_name = &quot;#{sponsor.first_name}&quot; + &quot; #{sponsor.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    @user_id = user.id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">    mail to: @email, subject: &quot;Thank You, Donor!&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>

          <code class="ruby">  def send_donation_report</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">    attachments[&#39;donation_report.csv&#39;] = File.read(&#39;reports/donor_report.csv&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    mail to: &#39;cbartels@uruut.com&#39;, subject: &#39;Donation Report&#39;, body: &#39;&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="9621a48ac3235c77d5788727b94cc12a4ca19725">
  <div class="header">
    <h3>app/mailers/milestone_mailer.rb</h3>
    <h4><span class="red">44.44 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class MilestoneMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def milestone_email(email, percent, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">  	  @email = email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">  	  @percent = percent</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">  	  @project = Project.find_by_id(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">  	  @image = @project.large_image</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">  	  mail to: @email, subject: &quot;Milestone Email Test&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="abd76a0ef148022925435f30ac4d5963ef742a23">
  <div class="header">
    <h3>app/mailers/newsletter_mailer.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class NewsletterMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def newsletter_confirmation(newsletter)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @user = newsletter</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    mail to: @user.email, bcc: &quot;charris@uruut.com, mfeinberg@uruut.com, bnorwood@uruut.com, alejo+bcc@bandofcoders.com&quot;, subject: &#39;Welcome to URUUT News!&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="2212e3c9716f6cd23010c114c440122e6736b38a">
  <div class="header">
    <h3>app/mailers/project_mailer.rb</h3>
    <h4><span class="red">22.22 %</span> covered</h4>
    <div>
      <b>27</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>21</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  # Subject can be set in your I18n file at config/locales/en.yml</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  # with the following lookup:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  #   en.contact_mailer.contact_confirmation.subject</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  #</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  def project_confirmation(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    user = User.find_by_id(project.user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    logger.debug(user)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @email = user.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    @image = project.large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @project = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">    @project_title = project.project_title</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    mail to: @email, bcc: &quot;info@uruut.com, cbartels@uruut.com, agraham@uruut.com, mfeinberg@uruut.com, bnorwood@uruut.com&quot;, subject: &quot;Wait For Approval&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  def project_message(recepient, subject_email, header_image, content)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    @image = header_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    @content = ApplicationController.helpers.simple_format(content)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    mail to: recepient, subject: subject_email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>

          <code class="ruby">  def project_approved(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    user = User.find_by_id(project.user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    email = user.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    @name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    @image = project.large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    @project_id = project.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    attachments[&#39;URUUTGuidebookFinal.pdf&#39;] = File.read(&quot;#{Rails.root}/public/data/URUUTGuidebookFinal.pdf&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">    mail to: email, subject: &quot;Your Project Has Been Approved&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="6d2a4d35d3ce9a5bd895cc6857cb4a4f7ecdb322">
  <div class="header">
    <h3>app/mailers/question_mailer.rb</h3>
    <h4><span class="red">33.33 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class QuestionMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def send_question(owner, name, email, subject, body)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    @name  = name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @email = email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    @body  = body</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @subject = subject</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @owner = owner</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    mail subject: @subject, from: @email, to: @owner.email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="76f50ef76b083474103e5128eab5a62b4896c8a7">
  <div class="header">
    <h3>app/mailers/sponsor_mailer.rb</h3>
    <h4><span class="red">18.18 %</span> covered</h4>
    <div>
      <b>55</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>45</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SponsorMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  helper :mailer</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  helper MailerHelper</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  include MailerHelper</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  # Subject can be set in your I18n file at config/locales/en.yml</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  # with the following lookup:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  #   en.contact_mailer.contact_confirmation.subject</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  #</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  def share_project(recepient, project_id, user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @project = Project.find(project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    project_sponsor = ProjectSponsor.find_by_id(user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    @sponsor_name = project_sponsor.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @image = @project.large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">    @project_title = @project.project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    @project_id = @project.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    mail to: recepient, subject: &quot;Share from Crowfundproject sponsor&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  def new_sponsor(sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    project_sponsor = ProjectSponsor.find_by_sponsor_id(sponsor.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    benefit_level = SponsorshipLevel.find_by_id(project_sponsor.level_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    project = Project.find(project_sponsor.project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    user = User.find_by_id(project.user_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    @donator_name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    @email = user.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    @image = project.large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    @project = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    @project_id = project.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    @project_name = project.project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">    @project_facebook = @project.facebook_page</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    @project_twitter = @project.twitter_handle</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    @project_title = project.title</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">    # @sponsor_email = sponsor.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">    @sponsorship_level = benefit_level.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">    @sponsorship_cost = ActionController::Base.helpers.number_to_currency(project_sponsor.cost, precision: 0)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">    @name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    @sponsor_name = project_sponsor.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    @sponsor_real_name = sponsor.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">    @sponsor_email = sponsor.email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    mail to: @email, subject: &quot;Sponsor thank you follow-up&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>

          <code class="ruby">  def sponsor_thank_you(sponsor, email)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">    project_sponsor = ProjectSponsor.find_by_sponsor_id(sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">    project = Project.find(project_sponsor.project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">    user = User.find_by_id(project.user_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">    @email = email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">    @name = project_sponsor.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">    @sponsor_name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">    @image = project.large_image</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">    @project_name = project.project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">    @project_sponsor = project.organization</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="66">


          <code class="ruby">    @project_facebook = project.facebook_page</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="67">


          <code class="ruby">    @project_twitter = project.twitter_handle</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">    @project_id = project.id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">    mail to: @email, subject: &quot;Thank You, Sponsor!&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>

          <code class="ruby">  def send_sponsor_report</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="74">


          <code class="ruby">    attachments[&#39;sponsor_report.csv&#39;] = File.read(&#39;reports/sponsor_report.csv&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">    mail to: &#39;cbartels@uruut.com&#39;, subject: &#39;Sponsor Report&#39;, body: &#39;&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="7f5b84a83362c331ccfe7290cda16408249a4562">
  <div class="header">
    <h3>app/mailers/transparency_workroom_mailer.rb</h3>
    <h4><span class="red">50.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class TransparencyWorkroomMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def transparency_workroom_update(user, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @user = user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    @manager = User.find_by_id(project.user_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @project = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    mail to: user.email, subject: &#39;Transparency Workroom Update&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="afbbc86d6791a50a783319543a51b679199f7363">
  <div class="header">
    <h3>app/mailers/welcome_mailer.rb</h3>
    <h4><span class="red">29.41 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class WelcomeMailer &lt; ActionMailer::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  default from: &quot;info@uruut.com&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  # Subject can be set in your I18n file at config/locales/en.yml</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  # with the following lookup:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  #   en.contact_mailer.contact_confirmation.subject</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  #</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  def welcome_confirmation_donor(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    logger.debug(user)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    @name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @email = user.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    unless @email.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">      mail to: @email, bcc: &quot;agraham@uruut.com, charris@uruut.com, mfeinberg@uruut.com, bnorwood@uruut.com, alejo+bcc@bandofcoders.com&quot;,subject: &quot;Welcome To URUUT&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  def welcome_confirmation_user(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    logger.debug(user)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">    @name = &quot;#{user.first_name}&quot; + &quot; #{user.last_name}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    @email = user.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    @host = ActionMailer::Base.default_url_options[:host]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    unless @email.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">      mail to: @email, bcc: &quot;agraham@uruut.com, charris@uruut.com, mfeinberg@uruut.com, bnorwood@uruut.com, alejo+bcc@bandofcoders.com&quot;, subject: &quot;Welcome To URUUT&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="8f56b9a98ea120b1766a9787165e93a8183a7869">
  <div class="header">
    <h3>app/models/ability.rb</h3>
    <h4><span class="red">27.27 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Ability</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  include CanCan::Ability</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    user ||= User.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    if user.role == &quot;admin&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">        can :manage, :all</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    if user.role == &quot;pradmin&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">        can :manage, PressCoverage</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">        can :manage, PressRelease</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    if user.role == &quot;member&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">        can :read, :all</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="eb84067a35cc26fa67ae7cfc59185b72f7da2d48">
  <div class="header">
    <h3>app/models/account.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Account &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  has_many :users</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="9bd2d9a057ffb5b3fa4d142b5770a57333d72b15">
  <div class="header">
    <h3>app/models/admin_user.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class AdminUser &lt; ActiveRecord::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">  # Include default devise modules. Others available are:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  # :confirmable, :lockable, :timeoutable and :omniauthable</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  devise :database_authenticatable,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">         :recoverable, :rememberable, :trackable, :validatable</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  # Setup accessible (or protected) attributes for your model</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :email, :password, :password_confirmation, :remember_me</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="597b051dfa35fb8a3a19a5e14cfeeb24b3a7de8a">
  <div class="header">
    <h3>app/models/authentication.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Authentication &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :provider, :token, :token_secret, :uid, :user_id</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="152569c7c87ca8c044e2e3059a50a17f8ba345f2">
  <div class="header">
    <h3>app/models/comment.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Comment &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :body, :post_id, :user_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :post</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="dc439c7da27653b55d9e4919f1e6217069cf2c2d">
  <div class="header">
    <h3>app/models/contact.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Contact &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :email, :user_id</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :email_content, :header_photo, :email_recepient, :subject</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="97d01aa75382dbda039100284feb104f848322aa">
  <div class="header">
    <h3>app/models/credit_card.rb</h3>
    <h4><span class="red">48.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines.
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class CreditCard</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  extend ActiveModel::Naming</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  include ActiveModel::Conversion</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  include ActiveModel::Validations</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :number, :exp_month, :exp_year, :cvc, :name, :billing_address,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">                :city, :zip_code, :state, :plan_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  validates :number, :exp_month, :exp_year, :cvc, :name, :billing_address,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">            :city, :zip_code, :state, presence: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  validate  :valid_exp_year?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(attributes={})</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @number = attributes[:number]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    @exp_month = attributes[:exp_month]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    @exp_year = attributes[:exp_year]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    @cvc = attributes[:cvc]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">    @name = attributes[:name]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    @billing_address = attributes[:billing_address]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    @city = attributes[:city]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    @zip_code = attributes[:zip_code]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    @state = attributes[:state]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  def details_as_hash</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    {</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">      number:        number,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">      exp_month:     exp_month,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">      exp_year:      exp_year,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">      cvc:           cvc,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">      name:          name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">      address_line1: billing_address,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">      address_city:  city,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">      address_zip:   zip_code,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">      address_state: state</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">  def persisted?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>

          <code class="ruby">  def valid_exp_year?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    unless exp_year.to_i &gt;= Date.current.year</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">      errors.add(:exp_year, &quot;must be equal or greater than #{Date.current.year}&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="cf77cbc4efb6d2ffe2a8013041bf7e845500e499">
  <div class="header">
    <h3>app/models/demo.rb</h3>
    <h4><span class="red">68.97 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines.
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Demo &lt; ActiveRecord::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  NON_PROFIT = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">    yes: 1,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">    no: 0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  BASIC_OPTIONS = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">    yes: 1,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    no: 0,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">    &#39;I don’t know&#39; =&gt; 3</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  CROWDFUNDING_CAMPING = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">    yes: 1,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">    no: 0,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    &#39;Not applicable&#39; =&gt; 3</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  TYPE_OF_ACCEPTED_DONATIONS = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">    donate_now: [0, &#39;We accept online donations using a “Donate Now” button and payment processing system (e.g. “PayPal”)&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">    software_solution: [1, &#39;We accept online donations using a software solution(e.g. CommonGround, Blackbaud, Sage)&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    not_accept: [2, &#39;We do not currently accept online donations, but would like to!&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  CROWDFUNDING = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    actively_engaged: [0, &#39;We are actively engaged in a crowdfunding campaign now.&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">    engaged: [1, &#39;We have engaged in a crowdfunding campaign in the past.&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">    not_engaged: [2, &#39;We have not engaged in crowdfunding yet.&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>

          <code class="ruby">  SOCIAL_OUTREACH = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">    pro_active: [0, &#39;We are pro-active in social media, and have the right resources in to manage donor outreach through our social media properties.&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">    active: [1, &#39;We are active in social media, but do not have a proactive strategy.&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">    not_active: [2, &#39;We are more reactive in social media, than proactive.&#39;],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">    reactive: [3, &#39;We are not active in social media, but would like to be.&#39;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  MONEY_RAISED_YEARLY = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">    &#39;Under $50K&#39; =&gt;    1,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">    &#39;$50K – $100K&#39; =&gt;  2,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">    &#39;$100K – $250K&#39; =&gt; 3,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">    &#39;$250K – $500K&#39; =&gt; 4,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">    &#39;$500K – $1M&#39; =&gt;   5,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">    &#39;$1M – $3M&#39; =&gt;     6,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    &#39;$3M – $5M&#39; =&gt;     7,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">    &#39;Over $5M&#39; =&gt;      8</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  CURRENT_FUNDRAISING_ACTIVITIES = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">    fund_events: &#39;Events&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">    fund_website_donation: &#39;Donate on website&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">    fund_direct_email: &#39;Direct Mail&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">    fund_email: &#39;Email&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">    fund_year_round: &#39;Year-round fundraising&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">    fund_seasonal: &#39;Seasonal fundraising&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">    fund_other: &#39;Other:&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>

          <code class="ruby">  TYPE_OF_DONORS_ACCEPTED = HashWithIndifferentAccess.new({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">    accepts_donations_from_individual: &#39;Individuals&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">    accepts_donations_from_foundations: &#39;Foundations&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">    accepts_donations_from_businesses: &#39;Businesses&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby">    accepts_donations_from_other: &#39;Other:&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">    })</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :accepts_donations_from_businesses,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby">    :accepts_donations_from_foundations,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">    :accepts_donations_from_individual,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="70">


          <code class="ruby">    :accepts_donations_from_other,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">    :accepts_donations_from_other_description,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">    :crowdfunding,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby">    :crowdfunding_campaign_goals,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">    :email,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby">    :first_name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">    :founded_date,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby">    :fund_direct_email,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">    :fund_email,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">    :fund_events,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">    :fund_other,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby">    :fund_other_description,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">    :fund_seasonal,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby">    :fund_website_donation,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby">    :fund_year_round,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="85">


          <code class="ruby">    :last_name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="86">


          <code class="ruby">    :money_raised_yearly,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">    :non_profit,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="88">


          <code class="ruby">    :organization,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="89">


          <code class="ruby">    :organization_description,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="90">


          <code class="ruby">    :partial_funding,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="91">


          <code class="ruby">    :phone,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="92">


          <code class="ruby">    :seven_days_to_receive_funds,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="93">


          <code class="ruby">    :social_outreach,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="94">


          <code class="ruby">    :sponsorship_program,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby">    :type_of_accepted_donations</code>
        </li>

        <li class="never" data-hits="" data-linenumber="96">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>

          <code class="ruby">  validates :first_name, :last_name, :email, presence: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby">  # validates :phone, organization, presence: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="99">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>

          <code class="ruby">  validate :current_fundraising_activities, :type_of_accepted_donors, on: :update</code>
        </li>

        <li class="never" data-hits="" data-linenumber="101">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>

          <code class="ruby">  validates :non_profit, :organization_description, :money_raised_yearly,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="103">


          <code class="ruby">    :sponsorship_program, :crowdfunding, :crowdfunding_campaign_goals,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby">    :partial_funding, :seven_days_to_receive_funds, :social_outreach, presence: true, on: :update</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>

          <code class="ruby">  def self.create_for_user(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="107">


          <code class="ruby">    demo = Demo.create(</code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby">        first_name:   user.first_name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby">        last_name:    user.last_name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">        organization: user.organization,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="111">


          <code class="ruby">        email:        user.email,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="112">


          <code class="ruby">        phone:        user.telephone)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="113">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="114">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="116">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>

          <code class="ruby">  def current_fundraising_activities</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="118">


          <code class="ruby">    unless valid_fundraising_activities_options?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="119">


          <code class="ruby">      errors.add(:base, &#39;You must select at least one fundraising activity&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="120">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="121">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="122">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>

          <code class="ruby">  def valid_fundraising_activities_options?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="124">


          <code class="ruby">    (fund_direct_email     ||</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">     fund_email            ||</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby">     fund_events           ||</code>
        </li>

        <li class="never" data-hits="" data-linenumber="127">


          <code class="ruby">     fund_seasonal         ||</code>
        </li>

        <li class="never" data-hits="" data-linenumber="128">


          <code class="ruby">     fund_website_donation ||</code>
        </li>

        <li class="never" data-hits="" data-linenumber="129">


          <code class="ruby">     fund_year_round)      ||</code>
        </li>

        <li class="never" data-hits="" data-linenumber="130">


          <code class="ruby">    (fund_other            &amp;&amp;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="131">


          <code class="ruby">     fund_other_description.present?)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="132">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="133">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>

          <code class="ruby">  def type_of_accepted_donors</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="135">


          <code class="ruby">    unless valid_type_of_donors?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="136">


          <code class="ruby">      errors.add(:base, &#39;You must select at least kind of donor your organization accepts&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="137">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="138">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="139">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>

          <code class="ruby">  def valid_type_of_donors?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="141">


          <code class="ruby">    (accepts_donations_from_businesses  ||</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="142">


          <code class="ruby">     accepts_donations_from_foundations ||</code>
        </li>

        <li class="never" data-hits="" data-linenumber="143">


          <code class="ruby">     accepts_donations_from_individual) ||</code>
        </li>

        <li class="never" data-hits="" data-linenumber="144">


          <code class="ruby">    (accepts_donations_from_other &amp;&amp;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="145">


          <code class="ruby">     accepts_donations_from_other_description.present?)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="146">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="147">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="148">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="e011ef800f5e1d87894fe49a0081aeeb01608126">
  <div class="header">
    <h3>app/models/document.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Document &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :filename, :url, :project_id</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="ef84543fda098ceba08592e2aa82d64fcbc76ece">
  <div class="header">
    <h3>app/models/donation.rb</h3>
    <h4><span class="red">48.39 %</span> covered</h4>
    <div>
      <b>93</b> relevant lines.
      <span class="green"><b>45</b> lines covered</span> and
      <span class="red"><b>48</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Donation &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :amount, :project_id, :customer_token, :user_id, :email, :token,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  :card_last4, :created_at, :card_type, :perk_name, :confirmed, :description, :anonymous, :last_founded</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :token, :card_last4, :card_type, :type_founder</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="47" data-linenumber="9">
          <span class="hits">47</span>

          <code class="ruby">  default_scope { where(confirmed: true) }</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  scope :approved, where(approved: true)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  scope :with_funder, -&gt;(funder) { where(user_id: funder) }</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  scope :for_project, -&gt;(project) { where(project_id: project) }</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  scope :known_users, -&gt; { where(anonymous: false) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def save_with_payment</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">    current_user = :current_user</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">    Stripe.api_key = &quot;#{Settings.stripe.api_key}&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">    customer = Stripe::Customer.create(description: email, card: token)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">    self.customer_token = customer.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    self.confirmed = true</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    save!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">  rescue Stripe::InvalidRequestError =&gt; e</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">    logger.error &quot;Stripe error while creating customer: #{e.message}&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">    errors.add :base, &quot;There was a problem with your credit card.&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">    false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def self.reorder_perks(perks, amount)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>

          <code class="ruby">    perks_arr = []</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="32">
          <span class="hits">3</span>

          <code class="ruby">    perks.each do |perk|</code>
        </li>

        <li class="covered" data-hits="15" data-linenumber="33">
          <span class="hits">15</span>

          <code class="ruby">      if perk[1].to_f &lt;= amount</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>

          <code class="ruby">        if !perk[4].blank? &amp;&amp; perk[4].to_i &gt; 0</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="35">
          <span class="hits">3</span>

          <code class="ruby">          perks_arr.push(perk)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">        elsif perk[4].blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">          perks_arr.push(perk)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="42">
          <span class="hits">3</span>

          <code class="ruby">    perks_arr</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>

          <code class="ruby">  def self.get_perk_info(project, amount, perks)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="48">
          <span class="hits">3</span>

          <code class="ruby">    if !project.perk_permission</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="49">
          <span class="hits">3</span>

          <code class="ruby">      perk_description = &quot;#{amount.to_i} Uruut Reward Points&quot;</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="50">
          <span class="hits">3</span>

          <code class="ruby">      arr = AMOUNTS.select do |a|</code>
        </li>

        <li class="covered" data-hits="15" data-linenumber="51">
          <span class="hits">15</span>

          <code class="ruby">        a == amount</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="54">
          <span class="hits">3</span>

          <code class="ruby">      if arr.first == nil || arr.first == &#39;&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">        perk_name_selected = &quot;Custom&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="57">
          <span class="hits">3</span>

          <code class="ruby">        perk_name_selected = LEVELS[AMOUNTS.index(arr.last)]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">    elsif perks.blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">      perk_name_selected = &quot;No Perk&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">      perk_description = &quot;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">      perk_name_selected = perks.last[0]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">      perk_description = perks.last[3]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="68">
          <span class="hits">3</span>

          <code class="ruby">    return [perk_name_selected, perk_description]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="70">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>

          <code class="ruby">  def self.set_perk_id(perks, project)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="72">
          <span class="hits">3</span>

          <code class="ruby">    if perks.blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="73">


          <code class="ruby">      perk_id = &quot;Custom&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">    elsif project.perk_permission</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">      perk_id = perks.last[2]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="77">
          <span class="hits">3</span>

          <code class="ruby">      perk_id = perks.last[0]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="79">
          <span class="hits">3</span>

          <code class="ruby">    perk_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>

          <code class="ruby">  def self.set_perks(project)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="83">
          <span class="hits">3</span>

          <code class="ruby">    if project.perk_permission</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="84">


          <code class="ruby">      perks = project.perks.order(:amount).map{ |perk| [perk.name, perk.amount.to_i, perk.id, perk.description, perk.perks_available] }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="85">


          <code class="ruby">    else</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="86">
          <span class="hits">3</span>

          <code class="ruby">      perks = DEFAULT_PERK</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="88">
          <span class="hits">3</span>

          <code class="ruby">    perks</code>
        </li>

        <li class="never" data-hits="" data-linenumber="89">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="90">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="91">


          <code class="ruby">  ###  new function for handle Stripe error  ###</code>
        </li>

        <li class="never" data-hits="" data-linenumber="92">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>

          <code class="ruby">  def error_payment?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">    error = false</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="95">


          <code class="ruby">    Stripe.api_key = &quot;#{Settings.stripe.api_key}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="96">


          <code class="ruby">    begin</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">      customer = Stripe::Customer.create(description: email, card: token)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby">    rescue Stripe::CardError =&gt; e</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="99">


          <code class="ruby">      error = e.message</code>
        </li>

        <li class="never" data-hits="" data-linenumber="100">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="101">


          <code class="ruby">    error</code>
        </li>

        <li class="never" data-hits="" data-linenumber="102">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="103">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby">  #####################################################</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>

          <code class="ruby">  def self.already_donated(project, user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="107">


          <code class="ruby">  	@donation = Donation.where(&quot;project_id = ? AND user_id = ?&quot;, project, user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="108">


          <code class="ruby">  	if @donation.length == 0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby">  		return nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">  	else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="111">


          <code class="ruby">  		return @donation.first.amount</code>
        </li>

        <li class="never" data-hits="" data-linenumber="112">


          <code class="ruby">  	end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="113">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="114">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>

          <code class="ruby">  def self.edit_donation(project, user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="116">


          <code class="ruby">  	@donation = Donation.where(&quot;project_id = ? AND user_id = ?&quot;, project, user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="117">


          <code class="ruby">  	return @donation.first.id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="119">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>

          <code class="ruby">  def self.send_confirmation_email(donation)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="121">


          <code class="ruby">    DonationMailer.donation_confirmation(donation).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="122">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>

          <code class="ruby">  def self.generate_report(project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">    require &#39;csv&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="127">


          <code class="ruby">    project = Project.find(project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="128">


          <code class="ruby">    project_name = project.project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="129">


          <code class="ruby">    index_array = project.donations.map(&amp;:user_id).uniq</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="130">


          <code class="ruby">    donations = project.donations</code>
        </li>

        <li class="never" data-hits="" data-linenumber="131">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="132">


          <code class="ruby">    perks = project.perks.order(&quot;id ASC&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="133">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="134">


          <code class="ruby">    CSV.open(&quot;reports/donor_report.csv&quot;, &quot;w+&quot;) do |csv|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="135">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="136">


          <code class="ruby">      csv &lt;&lt; [&quot;project name&quot;, &quot;email&quot;, &quot;first name&quot;, &quot;last name&quot;, &quot;amount&quot;, &quot;perk&quot;, &quot;description&quot;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="137">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="138">


          <code class="ruby">      index_array.each do |index|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="139">


          <code class="ruby">        sum = 0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="140">


          <code class="ruby">        matches = donations.where(&quot;user_id = ?&quot;,index)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="141">


          <code class="ruby">        matches.each do |p|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="142">


          <code class="ruby">          sum += p.amount</code>
        </li>

        <li class="never" data-hits="" data-linenumber="143">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="144">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="145">


          <code class="ruby">        if perks.first.amount &gt; sum</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="146">


          <code class="ruby">          perk_name = &quot;n/a&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="147">


          <code class="ruby">          perk_description = &quot;n/a&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="148">


          <code class="ruby">        elsif sum &gt; perks.last.amount</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="149">


          <code class="ruby">          perk_name = perks.last.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="150">


          <code class="ruby">          perk_description = perks.last.description</code>
        </li>

        <li class="never" data-hits="" data-linenumber="151">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="152">


          <code class="ruby">          perks.each do |p|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="153">


          <code class="ruby">            if p.amount &lt; sum</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="154">


          <code class="ruby">              perk_name = p.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="155">


          <code class="ruby">              perk_description = p.description</code>
        </li>

        <li class="never" data-hits="" data-linenumber="156">


          <code class="ruby">            end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="157">


          <code class="ruby">          end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="158">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="159">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="160">


          <code class="ruby">        csv &lt;&lt; [&quot;#{project_name}&quot;, &quot;#{matches.uniq.first.email}&quot;, &quot;#{User.find(matches.uniq.first.user_id).first_name}&quot;, &quot;#{User.find(matches.uniq.first.user_id).last_name}&quot;, &quot;#{sum}&quot;, &quot;#{perk_name}&quot;, &quot;#{perk_description}&quot;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="161">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="162">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="163">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="164">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="165">


          <code class="ruby">    DonationMailer.send_donation_report.deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="166">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="167">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="168">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="169">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="f89272d3c19c7e125fc9a83860df565a090edf7f">
  <div class="header">
    <h3>app/models/feature.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Feature &lt; ActiveRecord::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  has_many :plan_features</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  has_many :plans, through: :plan_features</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :description, :name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="8f07ef00117bd25fe4fb8a460b3cb4c551ad364a">
  <div class="header">
    <h3>app/models/gallery.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Gallery &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :project_id, :gallery, :gallery_file_name, :gallery_type, :thumbnail_url, :gallery_content_type</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  scope :media_transparent_room, lambda { |page_num| where(gallery_type: &quot;transparency_workroom&quot;).page(page_num).per(9) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="93d3293c53d6c1ba0cc6d601077a31fb8bac95f1">
  <div class="header">
    <h3>app/models/identity.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Identity &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :provider, :token, :uid, :user_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="27d6b1b2a541abe4aaeaa6b6cd9c83c2d046131f">
  <div class="header">
    <h3>app/models/marketing_info.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class MarketingInfo &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :email, :first_name, :last_name, :href</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :href</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  validates :email, :first_name, :last_name, presence: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="c37fda3babeb25f451141a9dee6a0d89e7e3012b">
  <div class="header">
    <h3>app/models/membership.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines.
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Membership &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :sponsor</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :plan</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  def kind</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="7">
          <span class="hits">3</span>

          <code class="ruby">    plan.name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  def basic_or_plus?</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>

          <code class="ruby">    plan &amp;&amp; [&#39;basic&#39;, &#39;plus&#39;].include?(kind)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  def clean_plan_data!</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>

          <code class="ruby">    self.plan = nil</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>

          <code class="ruby">    self.stripe_subscription_id = nil</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>

          <code class="ruby">    save</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="fbfd4573e7b0eb57b5b219dae14a14db95581016">
  <div class="header">
    <h3>app/models/merit/badge_rules.rb</h3>
    <h4><span class="yellow">83.33 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="never" data-hits="" data-linenumber="1">


          <code class="ruby"># Be sure to restart your server when you modify this file.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">#</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"># +grant_on+ accepts:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"># * Nothing (always grants)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"># * A block which evaluates to boolean (recieves the object as parameter)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"># * A block with a hash composed of methods to run on the target object with</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">#   expected values (+:votes =&gt; 5+ for instance).</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">#</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"># +grant_on+ can have a +:to+ method name, which called over the target object</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"># should retrieve the object to badge (could be +:user+, +:self+, +:follower+,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"># etc). If it&#39;s not defined merit will apply the badge to the user who</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"># triggered the action (:action_user by default). If it&#39;s :itself, it badges</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"># the created object (new user for instance).</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">#</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"># The :temporary option indicates that if the condition doesn&#39;t hold but the</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"># badge is granted, then it&#39;s removed. It&#39;s false by default (badges are kept</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"># forever).</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">module Merit</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  class BadgeRules</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">    include Merit::BadgeRulesMethods</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">    def initialize</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">      # grant_on &quot;projects#create&quot;, :badge =&gt; &quot;Project creation badge&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">      grant_on [&quot;donations#create&quot;, &quot;donations#update&quot;], :badge =&gt; &quot;Project donation badge&quot; do |donation|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">        donation.customer_token.present?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">      # If it creates user, grant badge</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">      # Should be &quot;current_user&quot; after registration for badge to be granted.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">      # grant_on &#39;users#create&#39;, :badge =&gt; &#39;just-registered&#39;, :to =&gt; :itself</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">      # If it has 10 comments, grant commenter-10 badge</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">      # grant_on &#39;comments#create&#39;, :badge =&gt; &#39;commenter&#39;, :level =&gt; 10 do |comment|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">      #   comment.user.comments.count == 10</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">      # If it has 5 votes, grant relevant-commenter badge</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">      # grant_on &#39;comments#vote&#39;, :badge =&gt; &#39;relevant-commenter&#39;, :to =&gt; :user do |comment|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">      #   comment.votes.count == 5</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">      # Changes his name by one wider than 4 chars (arbitrary ruby code case)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">      # grant_on &#39;registrations#update&#39;, :badge =&gt; &#39;autobiographer&#39;, :temporary =&gt; true, :model_name =&gt; &#39;User&#39; do |user|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">      #   user.name.length &gt; 4</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="40ae1bfdb6620cd93ab66cab0f8ea194d33892ab">
  <div class="header">
    <h3>app/models/merit/point_rules.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="never" data-hits="" data-linenumber="1">


          <code class="ruby"># Be sure to restart your server when you modify this file.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">#</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"># Points are a simple integer value which are given to &quot;meritable&quot; resources</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"># according to rules in +app/models/merit/point_rules.rb+. They are given on</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"># actions-triggered, either to the action user or to the method (or array of</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"># methods) defined in the +:to+ option.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">#</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"># &#39;score&#39; method may accept a block which evaluates to boolean</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"># (recieves the object as parameter)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">module Merit</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  class PointRules</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">    include Merit::PointRulesMethods</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">    def initialize</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">      # score 10, :on =&gt; &#39;users#update&#39; do</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">      #   user.name.present?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">      #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">      # score 15, :on =&gt; &#39;reviews#create&#39;, :to =&gt; [:reviewer, :reviewed]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">      #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">      # score 20, :on =&gt; [</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">      #   &#39;comments#create&#39;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">      #   &#39;photos#create&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">      # ]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="a045779eb7ee953910dad73120da50d61b63907a">
  <div class="header">
    <h3>app/models/merit/rank_rules.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="never" data-hits="" data-linenumber="1">


          <code class="ruby"># Be sure to restart your server when you modify this file.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">#</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"># 5 stars is a common ranking use case. They are not given at specified</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"># actions like badges, you should define a cron job to test if ranks are to be</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"># granted.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">#</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"># +set_rank+ accepts:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"># * :+level+ ranking level (greater is better)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"># * :+to+ model or scope to check if new rankings apply</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"># * :+level_name+ attribute name (default is empty and results in &#39;level&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">#   attribute, if set it&#39;s appended like &#39;level_#{level_name}&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">module Merit</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  class RankRules</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">    include Merit::RankRulesMethods</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">    def initialize</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">      # set_rank :level =&gt; 1, :to =&gt; Commiter.active do |commiter|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">      #   commiter.repositories.count &gt; 1 &amp;&amp; commiter.followers &gt;= 10</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">      #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">      # set_rank :level =&gt; 2, :to =&gt; Commiter.active do |commiter|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">      #   commiter.branches.count &gt; 1 &amp;&amp; commiter.followers &gt;= 10</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">      #</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">      # set_rank :level =&gt; 3, :to =&gt; Commiter.active do |commiter|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">      #   commiter.branches.count &gt; 2 &amp;&amp; commiter.followers &gt;= 20</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">      # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="5c83c4c07405e6769687dba17bf024869c469a1b">
  <div class="header">
    <h3>app/models/message.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Message &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :message, :project_id</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="8301edf857be2f017130177eebc87531b40c01f2">
  <div class="header">
    <h3>app/models/milestoneemail.rb</h3>
    <h4><span class="red">80.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Milestoneemail &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :fifteen_percent, :fifty_percent, :ninety_percent, :project_id, :seventy_five_percent</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  has_many :projects</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def self.send_milestone_email(email, percent, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    MilestoneMailer.milestone_email(email, percent, project).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="367cc70bc2b2d22fd447d018875601928b398cde">
  <div class="header">
    <h3>app/models/newsletter.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Newsletter &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  validates :email, :email_format =&gt; { :message =&gt; &quot;Invalid email&quot; }</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  validates :email, :uniqueness =&gt; { :case_sensitive =&gt; false }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="e0486abc22ee49268c5dfa9e82d11854f971b26b">
  <div class="header">
    <h3>app/models/perk.rb</h3>
    <h4><span class="red">58.33 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Perk &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :amount, :description, :name, :limit, :perks_available, :project_id, :perk_limit</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def get_perk_name(amount)</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>

          <code class="ruby">  	case amount</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">      when &quot;10&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">        self.name = &quot;Level 1&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">      when &quot;25&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">        self.name = &quot;Level 2&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">      when &quot;50&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">        self.name = &quot;Level 3&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">      when &quot;100&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">        self.name = &quot;Level 4&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">      when &quot;250&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">        self.name = &quot;Level 5&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">      else</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>

          <code class="ruby">        self.name = &quot;Custom&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>

          <code class="ruby">    self.name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="7e71d37e9dc15fdb7a94b8447432a08fc28c9ff1">
  <div class="header">
    <h3>app/models/plan.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Plan &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  has_many :membership</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  has_many :plan_features</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  has_many :features, through: :plan_features</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :stripe_plan_id, :name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def has_feature?(feature_name)</code>
        </li>

        <li class="covered" data-hits="7" data-linenumber="9">
          <span class="hits">7</span>

          <code class="ruby">    features.where(name: feature_name).exists?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="eb146565e98153485d2b79732a6fab6f4c090efa">
  <div class="header">
    <h3>app/models/plan_feature.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PlanFeature &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :plan</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :feature</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="426e2c1456b61fd89d06cc55acac39c78105cd02">
  <div class="header">
    <h3>app/models/post.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Post &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :title, :body, :user_id, :project_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  has_many :comments, dependent: :destroy</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="2cc4e13f808af585d2ae1b8d8f1c390aac30f9f3">
  <div class="header">
    <h3>app/models/press_coverage.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PressCoverage &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :link, :release_date, :title, :publication</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="f5c15ceeba743498e539e4524fc14a72c4376050">
  <div class="header">
    <h3>app/models/press_release.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class PressRelease &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :link, :release_date, :title</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="014c541e6d1d272ebd4b5b43c214d2efba24d16f">
  <div class="header">
    <h3>app/models/project.rb</h3>
    <h4><span class="red">33.48 %</span> covered</h4>
    <div>
      <b>227</b> relevant lines.
      <span class="green"><b>76</b> lines covered</span> and
      <span class="red"><b>151</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Project &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  before_save :downcase_url_and_facebook</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  before_save :capitalize_city</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  before_validation :strip_comma_from_goal, :if =&gt; :project_details</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :category, :description, :duration, :goal, :address, :project_title, :sponsorship_permission,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  :city, :state, :zip, :neighborhood, :title, :image, :video, :tags, :live, :short_description, :perk_permission,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  :perks_attributes, :galleries_attributes, :status, :organization, :website, :twitter_handle, :facebook_page, :seed_video,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  :story, :about, :large_image, :seed_image, :cultivation_image, :ready_for_approval, :organization_type, :cultivation_mime_type,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  :organization_classification, :cultivation_video, :campaign_deadline, :sponsor_permission, :step, :seed_mime_type, :partial_funding</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :sponsorship_permission, :perk_type, :sponsor_info, :project_details, :assets</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  validates :organization, :organization_type, :organization_classification, :address,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">            :city, :state, :zip, :website, :facebook_page, :twitter_handle, :project_token,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">            presence: true,:if =&gt; :sponsor_info</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  validates :project_title, :duration, :category, :title, :story, :about, presence: true, :if =&gt; :project_details</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>

          <code class="ruby">  validates :goal, presence: true, numericality: true, :if =&gt; :project_details</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  validates :large_image, presence: true, :if =&gt; :assets</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  with_options dependent: :destroy do |project|</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">    project.has_many :donations</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>

          <code class="ruby">    project.has_many :perks</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">    project.has_many :galleries</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">    project.has_many :project_updates</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>

          <code class="ruby">    project.has_many :project_sponsors</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>

          <code class="ruby">    project.has_many :sponsorship_benefits</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">    project.has_many :documents</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>

          <code class="ruby">  has_many :sponsorship_levels</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>

          <code class="ruby">  has_many :documents</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>

          <code class="ruby">  has_many :users</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  has_many :tax_reports</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">  has_many :posts</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>

          <code class="ruby">  has_many :questions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">  accepts_nested_attributes_for :perks, allow_destroy: true</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>

          <code class="ruby">  accepts_nested_attributes_for :galleries, allow_destroy: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>

          <code class="ruby">  scope :ready_for_approval, where(ready_for_approval: 1)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  scope :live, where(&quot;live = 1&quot;)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>

          <code class="ruby">  scope :funding_complete, where(&quot;status = &#39;Funding Complete&#39;&quot;)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>

          <code class="ruby">  scope :ending_today, where(&quot;campaign_deadline BETWEEN ? AND ?&quot;, DateTime.now.beginning_of_day, DateTime.now.end_of_day)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  scope :updated_yesterday, -&gt; { where(&quot;updated_at &gt;= ?&quot;, (Time.now - 1.day).utc) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>

          <code class="ruby">  def self.unique_values_of(type)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">    self.select(type).uniq.pluck(type)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>

          <code class="ruby">  def self.by_city(city)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">    (city &amp;&amp; city.downcase != &quot;all cities&quot;) ? where(&quot;lower(city) = ?&quot;, city.downcase) : where(&quot;&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>

          <code class="ruby">  def self.by_category(category)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">    (category &amp;&amp; category.downcase != &quot;all categories&quot;) ? where(&quot;lower(category) = ?&quot;, category.downcase) : where(&quot;&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>

          <code class="ruby">  def self.by_keyword(keyword)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">    where(&quot;city LIKE :keyword OR state LIKE :keyword OR title LIKE :keyword OR description LIKE :keyword OR organization LIKE :keyword&quot;, :keyword =&gt; &quot;%#{keyword}%&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>

          <code class="ruby">  def self.get_sponsor_token</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="69">


          <code class="ruby">    if :current_user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">      Stripe.api_key = API_KEY</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>

          <code class="ruby">  def distinct_donors</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="75">
          <span class="hits">9</span>

          <code class="ruby">    project_donations = self.donations</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="76">
          <span class="hits">9</span>

          <code class="ruby">    anonymous_donors = project_donations.select { |donation| donation.anonymous }.uniq_by { |donation| donation.user_id }</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="77">
          <span class="hits">9</span>

          <code class="ruby">    real_donors = project_donations.select { |donation| !donation.anonymous }.uniq_by { |donation| donation.user_id }</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="78">
          <span class="hits">9</span>

          <code class="ruby">    donors = (anonymous_donors + real_donors).sort_by {|donor| donor.updated_at }.reverse</code>
        </li>

        <li class="covered" data-hits="9" data-linenumber="79">
          <span class="hits">9</span>

          <code class="ruby">    donations.select(&quot;DISTINCT(donations.user_id)&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="80">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>

          <code class="ruby">  def individual_donors(page_num)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="83">


          <code class="ruby">    project_donations = self.donations</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="84">


          <code class="ruby">    anonymous_donors = project_donations.select { |donation| donation.anonymous }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">    real_donors = project_donations.select { |donation| !donation.anonymous }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">    donations_data = individual_donors_by_type(real_donors) + individual_donors_by_type(anonymous_donors)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="88">


          <code class="ruby">    donations_group = group_and_sort_donor(donations_data, self.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">    donations = donations_group.map { |donation| donation[1] }.flatten</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="90">


          <code class="ruby">    Kaminari.paginate_array(donations).page(page_num).per(25)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="91">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="92">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>

          <code class="ruby">  def individual_donors_by_type(donors)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">    donations_data = []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="95">


          <code class="ruby">    users_data = donors.group_by { |donation| donation.user_id }.map {|donation| [ donation[0], total_donation_by_user(donation[1]), last_donation_by_user(donation[1]), donation[1].first.anonymous ] }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="96">


          <code class="ruby">    donations_levels = group_and_sort_donor(self.donations, self.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">    donations_levels_and_amount = donations_levels.map { |donation| [ donation[0], get_amount_by_perk_name(donation[0], self.id) ] }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="98">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="99">


          <code class="ruby">    users_data.each do |user|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="100">


          <code class="ruby">      levels = []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="101">


          <code class="ruby">      donations_levels_and_amount.each do |donation_level|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="102">


          <code class="ruby">        if user[1] &gt;= donation_level[1]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="103">


          <code class="ruby">          levels &lt;&lt; donation_level[0]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="106">


          <code class="ruby">      donations_data &lt;&lt; Donation.new(project_id: self.id, amount: user[1], user_id: user[0], perk_name: levels.first, last_founded: user[2], anonymous: user[3])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="107">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="109">


          <code class="ruby">    donations_data</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="111">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>

          <code class="ruby">  def group_and_sort_donor(data, project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">    data.group_by{ |p| p.perk_name  }.sort_by{|key, value| get_amount_by_perk_name(key, project_id) }.reverse</code>
        </li>

        <li class="never" data-hits="" data-linenumber="114">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="115">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>

          <code class="ruby">  def total_donation_by_user(data)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="117">


          <code class="ruby">    data.map { |donation| donation.amount }.inject(0) {|sum, element| sum + element }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="119">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>

          <code class="ruby">  def last_donation_by_user(data)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="121">


          <code class="ruby">    data.sort_by { |founder| founder.updated_at }.last.updated_at.strftime(&quot;%m/%d&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="122">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>

          <code class="ruby">  def get_amount_by_perk_name(perk_name, project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">    perk = Perk.where(name: perk_name, project_id: project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="126">


          <code class="ruby">    if perk.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="127">


          <code class="ruby">      0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="128">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="129">


          <code class="ruby">      perk.first.amount</code>
        </li>

        <li class="never" data-hits="" data-linenumber="130">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="131">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="132">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>

          <code class="ruby">  def list_recepient</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="134">


          <code class="ruby">    data = []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="135">


          <code class="ruby">    level_ids = self.project_sponsors.map(&amp;:level_id).uniq.sort{ |x,y| y &lt;=&gt; x }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="136">


          <code class="ruby">    perk_names = self.donations.where(anonymous: false).map(&amp;:perk_name).uniq</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="137">


          <code class="ruby">    sponsorship_levels = SponsorshipLevel.where(&quot;id IN (?)&quot;, level_ids).uniq</code>
        </li>

        <li class="never" data-hits="" data-linenumber="138">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="139">


          <code class="ruby">    data.push([&quot;All Project Sponsors&quot;,&quot;All Project Sponsors&quot;, {&quot;data-name&quot; =&gt; &quot;All Project Sponsors&quot;}]) unless sponsorship_levels.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="140">


          <code class="ruby">    sponsorship_levels.map { |sponsor| [sponsor.name + &quot; Level Sponsors&quot;, sponsor.id, {&quot;data-name&quot; =&gt; sponsor.name + &quot; Level Sponsors&quot;}] }.each { |sponsor| data &lt;&lt; sponsor }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="141">


          <code class="ruby">    data.push([&quot;All Project Donors&quot;,&quot;All Project Donors&quot;, {&quot;data-name&quot; =&gt; &quot;All Project Donors&quot;}]) unless perk_names.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="142">


          <code class="ruby">    perk_names.map { |sponsor| [sponsor + &quot; Project Donors&quot; , sponsor + &quot; Project Donors&quot;, {&quot;data-name&quot; =&gt; sponsor + &quot; Project Donors&quot;} ] }.each { |sponsor| data &lt;&lt; sponsor }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="143">


          <code class="ruby">    if !sponsorship_levels.empty? and !perk_names.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="144">


          <code class="ruby">      data.unshift([&quot;All Project Sponsors and Donors&quot;,&quot;All Project Sponsors and Donors&quot;, {&quot;data-name&quot; =&gt; &quot;All Project Sponsors and Donors&quot;}])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="145">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="146">


          <code class="ruby">    data.unshift([&quot;My Contacts&quot;, &quot;My Contacts&quot;])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="147">


          <code class="ruby">    data</code>
        </li>

        <li class="never" data-hits="" data-linenumber="148">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="149">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>

          <code class="ruby">  def amount_per_day</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="151">


          <code class="ruby">    project_donations = self.donations</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="152">


          <code class="ruby">    project_sponsors = self.project_sponsors</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="153">


          <code class="ruby">    if project_donations.blank? and project_sponsors.blank?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="154">


          <code class="ruby">      amount_by_date = &quot;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="155">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="156">


          <code class="ruby">      amount_by_date = []</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="157">


          <code class="ruby">      self.created_at.to_date.upto(Time.now.to_date).each do |date|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="158">


          <code class="ruby">        amount = 0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="159">


          <code class="ruby">        amount += project_donations.select{ |donation| donation.updated_at &gt; date.at_beginning_of_day and donation.updated_at &lt; date.end_of_day }.map { |donation| donation.amount }.inject(0) {|sum, element| sum + element }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="160">


          <code class="ruby">        amount += project_sponsors.select{ |sponsor| sponsor.updated_at &gt; date.at_beginning_of_day and sponsor.updated_at &lt; date.end_of_day }.map { |sponsor| sponsor.cost }.compact.sum</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="161">


          <code class="ruby">        amount += amount_by_date.last unless amount_by_date.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="162">


          <code class="ruby">        amount_by_date &lt;&lt; amount</code>
        </li>

        <li class="never" data-hits="" data-linenumber="163">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="164">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="165">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="166">


          <code class="ruby">    amount_by_date</code>
        </li>

        <li class="never" data-hits="" data-linenumber="167">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="168">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>

          <code class="ruby">  def project_sponsor_by_level(page_num)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="170">


          <code class="ruby">    data = self.project_sponsors.group_by { |sponsor| sponsor.level_id }.sort.map{ |sponsor| sponsor[1] }.flatten</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="171">


          <code class="ruby">    Kaminari.paginate_array(data).page(page_num).per(25)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="172">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="173">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>

          <code class="ruby">  def print_test</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="175">


          <code class="ruby">    logger.debug(&quot;Test Crap&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="176">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="177">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>

          <code class="ruby">  def founders(page_num)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="179">


          <code class="ruby">    total_data = populate_funding_by_project.sort {|x,y| y.created_at &lt;=&gt; x.created_at }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="180">


          <code class="ruby">    Kaminari.paginate_array(total_data).page(page_num).per(25)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="181">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="182">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>

          <code class="ruby">  def all_funding_by_project(page_num)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="184">


          <code class="ruby">    total_data = populate_funding_by_project.group_by{ |p| p.updated_at.to_date  }.sort {|x,y| y &lt;=&gt; x }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="185">


          <code class="ruby">    Kaminari.paginate_array(total_data).page(page_num).per(25)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="186">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="187">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="188">
          <span class="hits">1</span>

          <code class="ruby">  def total_funding_by_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="189">


          <code class="ruby">    total_amout, individual_amount, business_amount, family_amount, foundation_amount = 0, 0, 0, 0, 0</code>
        </li>

        <li class="never" data-hits="" data-linenumber="190">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="191">


          <code class="ruby">    populate_funding_by_project.each do |funding|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="192">


          <code class="ruby">      if funding.type_founder.eql?(&quot;individual&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="193">


          <code class="ruby">        individual_amount += funding.amount.to_i</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="194">


          <code class="ruby">        total_amout += funding.amount.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="195">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="196">


          <code class="ruby">        if funding.sponsor_type.eql?(&quot;Foundation&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="197">


          <code class="ruby">          foundation_amount += funding.cost.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="198">


          <code class="ruby">        elsif funding.sponsor_type.eql?(&quot;Business&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="199">


          <code class="ruby">          business_amount += funding.cost.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="200">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="201">


          <code class="ruby">          family_amount += funding.cost.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="202">


          <code class="ruby">        end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="203">


          <code class="ruby">        total_amout += funding.cost.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="204">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="205">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="206">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="207">


          <code class="ruby">    fundings_data = {</code>
        </li>

        <li class="never" data-hits="" data-linenumber="208">


          <code class="ruby">      total_amount: total_amout,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="209">


          <code class="ruby">      individual_amount: individual_amount,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="210">


          <code class="ruby">      business_amount: business_amount,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="211">


          <code class="ruby">      family_amount: family_amount,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="212">


          <code class="ruby">      foundation_amount: foundation_amount</code>
        </li>

        <li class="never" data-hits="" data-linenumber="213">


          <code class="ruby">    }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="214">


          <code class="ruby">    fundings_data</code>
        </li>

        <li class="never" data-hits="" data-linenumber="215">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="216">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="217">
          <span class="hits">1</span>

          <code class="ruby">  def populate_funding_by_project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="218">


          <code class="ruby">    fundings = []</code>
        </li>

        <li class="never" data-hits="" data-linenumber="219">


          <code class="ruby">    self.donations.each do |sponsor|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="220">


          <code class="ruby">      sponsor.type_founder = &quot;individual&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="221">


          <code class="ruby">      fundings &lt;&lt; sponsor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="222">


          <code class="ruby">    end unless self.donations.empty?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="223">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="224">


          <code class="ruby">    self.project_sponsors.each do |sponsor|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="225">


          <code class="ruby">      sponsor.type_founder = &quot;sponsor&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="226">


          <code class="ruby">      fundings &lt;&lt; sponsor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="227">


          <code class="ruby">    end unless self.project_sponsors.empty?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="228">


          <code class="ruby">    fundings</code>
        </li>

        <li class="never" data-hits="" data-linenumber="229">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="230">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="231">
          <span class="hits">1</span>

          <code class="ruby">  def self.send_confirmation_email(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="232">


          <code class="ruby">    ProjectMailer.project_confirmation(project).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="233">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="234">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>

          <code class="ruby">  def self.send_approval_email(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="236">


          <code class="ruby">    ProjectMailer.project_approved(project).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="237">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="238">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="239">
          <span class="hits">1</span>

          <code class="ruby">  def capitalize_city</code>
        </li>

        <li class="covered" data-hits="38" data-linenumber="240">
          <span class="hits">38</span>

          <code class="ruby">    self.city.capitalize! unless self.city.nil?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="241">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="242">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="243">
          <span class="hits">1</span>

          <code class="ruby">  def downcase_url_and_facebook</code>
        </li>

        <li class="covered" data-hits="38" data-linenumber="244">
          <span class="hits">38</span>

          <code class="ruby">    self.twitter_handle.downcase! unless self.twitter_handle.nil?</code>
        </li>

        <li class="covered" data-hits="38" data-linenumber="245">
          <span class="hits">38</span>

          <code class="ruby">    self.website.downcase! unless self.website.nil?</code>
        </li>

        <li class="covered" data-hits="38" data-linenumber="246">
          <span class="hits">38</span>

          <code class="ruby">    self.facebook_page.downcase! unless self.facebook_page.nil?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="247">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="248">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="249">
          <span class="hits">1</span>

          <code class="ruby">  def self.check_days_left</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="250">


          <code class="ruby">    today = DateTime.now</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="251">


          <code class="ruby">    projects = Project.where(&quot;live = ?&quot;, 1)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="252">


          <code class="ruby">    projects.each do |p|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="253">


          <code class="ruby">      if p.campaign_deadline.to_date == Date.today</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="254">


          <code class="ruby">        p.live=0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="255">


          <code class="ruby">        p.save!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="256">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="257">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="258">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="259">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>

          <code class="ruby">  def approve!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="261">


          <code class="ruby">    self.live = 1</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="262">


          <code class="ruby">    self.ready_for_approval = 0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="263">


          <code class="ruby">    self.approval_date = Date.today</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="264">


          <code class="ruby">    self.campaign_deadline = self.approval_date.end_of_day + (self.duration.to_i).days</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="265">


          <code class="ruby">    self.status = &quot;Funding Active&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="266">


          <code class="ruby">    Project.delay.send_approval_email(self)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="267">


          <code class="ruby">    project_create_badge = Merit::Badge.new(id:2, name:&quot;Project creation badge&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="268">


          <code class="ruby">    self.save!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="269">


          <code class="ruby">    if !self.user.badges.include?(project_create_badge)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="270">


          <code class="ruby">      self.user.add_badge(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="271">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="272">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="273">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>

          <code class="ruby">  def strip_comma_from_goal</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="275">
          <span class="hits">1</span>

          <code class="ruby">    self.goal = self.goal.gsub(/,/, &#39;&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="276">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="277">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="278">
          <span class="hits">1</span>

          <code class="ruby">  def get_donors(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="279">


          <code class="ruby">    donors = Donation.where(&quot;project_id = ? AND customer_token != ?&quot;, project.id, &#39;&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="280">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="281">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>

          <code class="ruby">  def get_sponsors(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="283">


          <code class="ruby">    sponsors = ProjectSponsor.where(&quot;project_id = ? AND customer_id != ?&quot;, project.id, &#39;&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="284">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="285">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="286">
          <span class="hits">1</span>

          <code class="ruby">  def create_token(customer_token, access_token)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="287">


          <code class="ruby">    Stripe::Token.create(</code>
        </li>

        <li class="never" data-hits="" data-linenumber="288">


          <code class="ruby">      {:customer =&gt; customer_token},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="289">


          <code class="ruby">      access_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="290">


          <code class="ruby">    )</code>
        </li>

        <li class="never" data-hits="" data-linenumber="291">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="292">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="293">
          <span class="hits">1</span>

          <code class="ruby">  def create_sponsor_charges</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="294">


          <code class="ruby">    sponsors = get_sponsors(self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="295">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="296">


          <code class="ruby">    sponsors.each do |sponsor|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="297">


          <code class="ruby">      begin</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="298">


          <code class="ruby">        token = create_token(sponsor.customer_id, self.project_token)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="299">


          <code class="ruby">        amount = sponsor.cost.to_i * 100</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="300">


          <code class="ruby">        sponsor_name = Sponsor.where(&quot;id = ?&quot;, sponsor.sponsor_id).first.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="301">


          <code class="ruby">        sponsor_email = Sponsor.where(&quot;id = ?&quot;, sponsor.sponsor_id).first.email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="302">


          <code class="ruby">        description = &quot;Sponsor #{self.project_title} #{sponsor_name} #{sponsor_email}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="303">


          <code class="ruby">        application_fee = (amount * 0.05).to_i</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="304">


          <code class="ruby">        project_token = self.project_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="305">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="306">


          <code class="ruby">        Stripe::Charge.create({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="307">


          <code class="ruby">            :amount =&gt; amount,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="308">


          <code class="ruby">            :currency =&gt; &quot;usd&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="309">


          <code class="ruby">            :card =&gt; token.id,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="310">


          <code class="ruby">            :description =&gt; description,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="311">


          <code class="ruby">            :application_fee =&gt; calculate_funder_application_fee(application_fee)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="312">


          <code class="ruby">          },</code>
        </li>

        <li class="never" data-hits="" data-linenumber="313">


          <code class="ruby">          project_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="314">


          <code class="ruby">        )</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="315">


          <code class="ruby">        sponsor.update_column(:approved, true)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="316">


          <code class="ruby">      rescue Stripe::CardError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="317">


          <code class="ruby">        # Since it&#39;s a decline, Stripe::CardError will be caught</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="318">


          <code class="ruby">        body = e.json_body</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="319">


          <code class="ruby">        err  = body[:error]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="320">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="321">


          <code class="ruby">        puts &quot;Status is: #{e.http_status}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="322">


          <code class="ruby">        puts &quot;Type is: #{err[:type]}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="323">


          <code class="ruby">        puts &quot;Code is: #{err[:code]}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="324">


          <code class="ruby">        # param is &#39;&#39; in this case</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="325">


          <code class="ruby">        puts &quot;Param is: #{err[:param]}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="326">


          <code class="ruby">        puts &quot;Message is: #{err[:message]}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="327">


          <code class="ruby">      rescue Stripe::InvalidRequestError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="328">


          <code class="ruby">        # Invalid parameters were supplied to Stripe&#39;s API</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="329">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="330">


          <code class="ruby">      rescue Stripe::AuthenticationError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="331">


          <code class="ruby">        # Authentication with Stripe&#39;s API failed</code>
        </li>

        <li class="never" data-hits="" data-linenumber="332">


          <code class="ruby">        # (maybe you changed API keys recently)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="333">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="334">


          <code class="ruby">      rescue Stripe::APIConnectionError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="335">


          <code class="ruby">        # Network communication with Stripe failed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="336">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="337">


          <code class="ruby">      rescue Stripe::StripeError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="338">


          <code class="ruby">        # Display a very generic error to the user, and maybe send</code>
        </li>

        <li class="never" data-hits="" data-linenumber="339">


          <code class="ruby">        # yourself an email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="340">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="341">


          <code class="ruby">      rescue =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="342">


          <code class="ruby">        # Something else happened, completely unrelated to Stripe</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="343">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="344">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="345">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="346">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="347">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="348">
          <span class="hits">1</span>

          <code class="ruby">  def create_donation_charges</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="349">


          <code class="ruby">    donors = get_donors(self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="350">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="351">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="352">


          <code class="ruby">    donors.each do |donor|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="353">


          <code class="ruby">      begin</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="354">


          <code class="ruby">        token = create_token(donor.customer_token, self.project_token)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="355">


          <code class="ruby">        amount = donor.amount.to_i * 100</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="356">


          <code class="ruby">        description = &quot;Donor #{self.project_title} #{User.where(&#39;id = ?&#39;, donor.user_id).first.first_name} #{User.where(&#39;id = ?&#39;, donor.user_id).first.last_name} #{User.where(&#39;id = ?&#39;, donor.user_id).first.email}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="357">


          <code class="ruby">        application_fee = (amount * 0.05).to_i</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="358">


          <code class="ruby">        project_token = self.project_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="359">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="360">


          <code class="ruby">        Stripe::Charge.create({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="361">


          <code class="ruby">            :amount =&gt; amount,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="362">


          <code class="ruby">            :currency =&gt; &quot;usd&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="363">


          <code class="ruby">            :card =&gt; token.id,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="364">


          <code class="ruby">            :description =&gt; description,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="365">


          <code class="ruby">            :application_fee =&gt; calculate_funder_application_fee(application_fee)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="366">


          <code class="ruby">          },</code>
        </li>

        <li class="never" data-hits="" data-linenumber="367">


          <code class="ruby">          project_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="368">


          <code class="ruby">        )</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="369">


          <code class="ruby">        donor.update_column(:approved, true)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="370">


          <code class="ruby">      rescue Stripe::CardError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="371">


          <code class="ruby">        # Since it&#39;s a decline, Stripe::CardError will be caught</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="372">


          <code class="ruby">        body = e.json_body</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="373">


          <code class="ruby">        err  = body[:error]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="374">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="375">


          <code class="ruby">        puts &quot;Status is: #{e.http_status}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="376">


          <code class="ruby">        puts &quot;Type is: #{err[:type]}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="377">


          <code class="ruby">        puts &quot;Code is: #{err[:code]}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="378">


          <code class="ruby">        # param is &#39;&#39; in this case</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="379">


          <code class="ruby">        puts &quot;Param is: #{err[:param]}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="380">


          <code class="ruby">        puts &quot;Message is: #{err[:message]}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="381">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="382">


          <code class="ruby">        next</code>
        </li>

        <li class="never" data-hits="" data-linenumber="383">


          <code class="ruby">      rescue Stripe::InvalidRequestError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="384">


          <code class="ruby">        # Invalid parameters were supplied to Stripe&#39;s API</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="385">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="386">


          <code class="ruby">      rescue Stripe::AuthenticationError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="387">


          <code class="ruby">        # Authentication with Stripe&#39;s API failed</code>
        </li>

        <li class="never" data-hits="" data-linenumber="388">


          <code class="ruby">        # (maybe you changed API keys recently)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="389">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="390">


          <code class="ruby">      rescue Stripe::APIConnectionError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="391">


          <code class="ruby">        # Network communication with Stripe failed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="392">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="393">


          <code class="ruby">      rescue Stripe::StripeError =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="394">


          <code class="ruby">        # Display a very generic error to the user, and maybe send</code>
        </li>

        <li class="never" data-hits="" data-linenumber="395">


          <code class="ruby">        # yourself an email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="396">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="397">


          <code class="ruby">      rescue =&gt; e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="398">


          <code class="ruby">        # Something else happened, completely unrelated to Stripe</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="399">


          <code class="ruby">        puts e</code>
        </li>

        <li class="never" data-hits="" data-linenumber="400">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="401">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="402">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="403">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="404">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="405">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="406">
          <span class="hits">1</span>

          <code class="ruby">  def calculate_funder_application_fee(application_fee)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="407">


          <code class="ruby">    user.membership_kind == &#39;fee&#39; ? application_fee : nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="408">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="409">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="410">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="3970aa36c3b03c2727f492796eb4eb475e08c206">
  <div class="header">
    <h3>app/models/project_sponsor.rb</h3>
    <h4><span class="red">62.5 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines.
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectSponsor &lt; ActiveRecord::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">  #mount_uploader :logo, LogoUploader</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :card_token, :cost, :logo, :mission, :name, :project_id, :anonymous,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">  :sponsor_id, :level_id, :payment, :status, :card_type, :card_last4, :created_at, :site, :confirmed, :sponsor_type</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :type_founder</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :sponsor</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :sponsorship_level, foreign_key: :level_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  validates :name, :logo, :mission, :level_id, presence: true, unless: &quot;anonymous&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  validates :name, :level_id, presence: true, if: &quot;anonymous&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  validates_length_of :mission, maximum: 275</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="60" data-linenumber="17">
          <span class="hits">60</span>

          <code class="ruby">  default_scope { where(confirmed: true) }</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">  scope :platinum, where(level_id: 1)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  scope :gold, where(level_id: 2)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  scope :silver, where(level_id: 3)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  scope :bronze, where(level_id: 4)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def self.save_customer</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">    logger.debug &quot;Save With Payment Working?&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    current_user = :current_user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    Stripe.api_key = &quot;#{Settings.stripe.api_key}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    customer = Stripe::Customer.create(description: current_user.email, card: card_token)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    ProjectSponsor.customer_token = customer.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    save!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  rescue Stripe::InvalidRequestError =&gt; e</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    logger.error &quot;Stripe error while creating customer: #{e.message}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    errors.add :base, &quot;There was a problem with your credit card.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="fe2c4aaaca43837f5fac72036fd265cd8670f3ba">
  <div class="header">
    <h3>app/models/project_update.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class ProjectUpdate &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :content, :project_id, :title</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  validates :content, :project_id, :title, presence: true</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="3ad85f53c10aaf90e5b8a3e172ffbc3133b9cee2">
  <div class="header">
    <h3>app/models/question.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Question &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :body, :subject</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="99e3b750911f5c7662b7fad707b34c9f1ea3ba57">
  <div class="header">
    <h3>app/models/sponsor.rb</h3>
    <h4><span class="red">37.14 %</span> covered</h4>
    <div>
      <b>70</b> relevant lines.
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>44</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Sponsor &lt; ActiveRecord::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  delegate :kind, to: :membership, prefix: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  PAYMENT = [&quot;Credit Card&quot;, &quot;Wire Transfer/Check&quot;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  # Include default devise modules. Others available are:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  # :token_authenticatable, :confirmable,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  # :lockable, :timeoutable and :omniauthable</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  # Setup accessible (or protected) attributes for your model</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :email, :name, :payment_type, :card_name, :phone</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :card_name, :anonymous</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  # attr_accessible :title, :body</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  has_many :project_sponsors</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  has_one  :membership</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">  validates :card_name, presence: true, if: :payment_type_credit_card?</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  validates :phone, :email, :name, presence: true, if: :payment_type_transfer?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  def payment_type_transfer?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    self.payment_type.eql? &quot;Wire Transfer&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  def payment_type_credit_card?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    self.payment_type.eql? &quot;Credit Card&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def self.send_confirmation_email(sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    SponsorMailer.new_sponsor(sponsor).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  def self.sponsor_thank_you(sponsor, email)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    SponsorMailer.sponsor_thank_you(sponsor, email).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>

          <code class="ruby">  def self.set_sponsorship_percentage(level_id, project)</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>

          <code class="ruby">    case level_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">      when &quot;1&quot;</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>

          <code class="ruby">        cost = project.goal.to_i * 0.25</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">      when &quot;2&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">        cost = project.goal.to_i * 0.1</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">      when &quot;3&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">        cost = project.goal.to_i * 0.05</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">      when &quot;4&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">        if project.goal.to_i * 0.02 &gt;= 750</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">          cost = 750</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">        else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="49">


          <code class="ruby">          cost = project.goal.to_i * 0.02</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>

          <code class="ruby">    cost</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>

          <code class="ruby">  def self.save_customer(current_user, project_sponsor)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>

          <code class="ruby">    Stripe.api_key = &quot;#{Settings.stripe.api_key}&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>

          <code class="ruby">    name = current_user.first_name + &#39; &#39; + current_user.last_name</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>

          <code class="ruby">    description = &quot;Name: #{name}, Email: #{current_user.email}, Payment Type: Sponsor&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>

          <code class="ruby">    customer = Stripe::Customer.create(description: description, card: project_sponsor.card_token)</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>

          <code class="ruby">    project_sponsor.customer_id = customer.id</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>

          <code class="ruby">    project_sponsor.save!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">  rescue Stripe::InvalidRequestError =&gt; e</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">    logger.error &quot;Stripe error while creating customer: #{e.message}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">    # errors.add :base, &quot;There was a problem with your credit card.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="66">


          <code class="ruby">    false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>

          <code class="ruby">  def self.create_charge(project_sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">    Stripe.api_key = &quot;#{Settings.stripe.api_key}&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="71">


          <code class="ruby">    customer = project_sponsor.customer_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="72">


          <code class="ruby">    auth_token = Project.find(project_sponsor.project_id).project_token</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="73">


          <code class="ruby">    logger.debug customer</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">    token = Stripe::Token.create(</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">      {:customer =&gt; customer},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby">      auth_token # user&#39;s access token from the Stripe Connect flow</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">    )</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="80">


          <code class="ruby">    Stripe::Charge.create({</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby">        :amount =&gt; 1000, # in cents</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">        :currency =&gt; &quot;usd&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby">        :token =&gt; token,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby">        :application_fee =&gt; 1000</code>
        </li>

        <li class="never" data-hits="" data-linenumber="85">


          <code class="ruby">    }, auth_token)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="86">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">  rescue Stripe::InvalidRequestError =&gt; e</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="88">


          <code class="ruby">    logger.error &quot;Stripe error while creating customer: #{e.message}&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="89">


          <code class="ruby">    # errors.add :base, &quot;There was a problem with your credit card.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="90">


          <code class="ruby">    false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="91">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="92">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>

          <code class="ruby">  def self.generate_report(project_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="94">


          <code class="ruby">    require &#39;csv&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="96">


          <code class="ruby">    project_name = Project.find(project_id).project_title</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">    index_array = ProjectSponsor.where(&quot;project_id = ?&quot;, project_id).map(&amp;:sponsor_id).uniq</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="98">


          <code class="ruby">    benefit = SponsorshipBenefit.where(&quot;project_id = ?&quot;, project_id).order(&quot;id ASC&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="99">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="100">


          <code class="ruby">    CSV.open(&quot;#{Rails.root}/reports/sponsor_report.csv&quot;, &quot;w+&quot;) do |csv|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="101">


          <code class="ruby">      csv &lt;&lt; [&quot;project name&quot;, &quot;email&quot;, &quot;sponsor name&quot;, &quot;amount&quot;, &quot;benefits&quot;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="102">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="103">


          <code class="ruby">      index_array.each do |index|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="104">


          <code class="ruby">        sum = 0</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="105">


          <code class="ruby">        less_than_sum = []</code>
        </li>

        <li class="never" data-hits="" data-linenumber="106">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="107">


          <code class="ruby">        matches = ProjectSponsor.where(&quot;project_id = ? AND sponsor_id = ?&quot;, project_id, index)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="108">


          <code class="ruby">        matches.each do |m|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="109">


          <code class="ruby">          sum += m.cost</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">        end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="111">


          <code class="ruby">        puts sum</code>
        </li>

        <li class="never" data-hits="" data-linenumber="112">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">        benefit.each do |b|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="114">


          <code class="ruby">          if b.cost &gt; sum</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="115">


          <code class="ruby">            less_than_sum.push b</code>
        </li>

        <li class="never" data-hits="" data-linenumber="116">


          <code class="ruby">          end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="117">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="119">


          <code class="ruby">        level_cost = less_than_sum.max</code>
        </li>

        <li class="never" data-hits="" data-linenumber="120">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="121">


          <code class="ruby">        total_benefits = less_than_sum.each_index.select{|i| less_than_sum[i].cost == level_cost.cost}</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="122">


          <code class="ruby">        benefit_names = &#39;&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="124">


          <code class="ruby">        total_benefits.each do |tb|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="125">


          <code class="ruby">          benefit_names += less_than_sum[tb].name</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby">        end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="127">


          <code class="ruby">        puts Sponsor.find(index).name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="128">


          <code class="ruby">        puts benefit_names</code>
        </li>

        <li class="never" data-hits="" data-linenumber="129">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="130">


          <code class="ruby">        csv &lt;&lt; [&quot;#{project_name}&quot;, &quot;#{Sponsor.find(matches.uniq.first.id).email}&quot;, &quot;#{Sponsor.find(matches.uniq.first.id).name}&quot;, &quot;#{sum}&quot;, &quot;#{benefit_names.to_s}&quot;]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="131">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="132">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="133">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="134">


          <code class="ruby">    SponsorMailer.send_sponsor_report.deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="135">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="136">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="137">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="138">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="80d05693ee375e25361bc832fb88405c290bd047">
  <div class="header">
    <h3>app/models/sponsorship_benefit.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SponsorshipBenefit &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :name, :sponsorship_level_id, :project_id, :status, :cost</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  SPONSORSHIP_BENEFITS = {1 =&gt; [{ id: 1,  desc: &quot;Recognition plaque or monument sign on project site.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">                          {id: 2, desc: &quot;Platinum Sponsor mention on all external communication (press releases, community newsletter, etc.)&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">                          {id: 3, desc: &quot;Profile of your company on our website with photo.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">                          {id: 4, desc: &quot;Weekly plug on social media leading up to the project and the month after the project has been completed.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">                          {id: 5, desc: &quot;Twenty tickets to VIP Gala Event.&quot;}],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">                          2 =&gt; [{ id: 1, desc: &quot;Gold Sponsor mention in community newsletter.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">                          {id: 2, desc: &quot;Profile of your company on our website with photo.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">                          {id: 3, desc: &quot;Bi-monthly plug on social media leading up to the project and the month after the project has been complete.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">                          {id: 4, desc: &quot;Ten tickets to VIP Gala Event.&quot;}],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">                          3 =&gt; [{id: 1, desc: &quot;Profile of your company on our website with photo.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">                          {id: 2, desc: &quot;Monthly plug on social media leading up to the project and the month after the project has been complete.&quot;},</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">                          {id: 3, desc: &quot;Five tickets to VIP Gala Event.&quot;}],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">                          4 =&gt; [{id: 1, desc: &quot;Lorem ipsum dolor sit amet.&quot;}]}</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  scope :for_project, -&gt;(project) { where(project_id: project.id) }</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  scope :with_project_sponsor_level, -&gt;(project_sponsor) { where(sponsorship_level_id: project_sponsor.level_id) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="b5255c665ff34637018857ff6b255787344d0ab3">
  <div class="header">
    <h3>app/models/sponsorship_level.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SponsorshipLevel &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :name, :cost, :description, :required, :funding_goal, :project_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  has_many :sponsorship_benefits</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="ad6c590b26c503ceebd35b1e1a7cbae68a7757ba">
  <div class="header">
    <h3>app/models/tax_report.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class TaxReport &lt; ActiveRecord::Base</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :url, :user_id, :project_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  # validates_uniqueness_of :url, :scope =&gt; [:project_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :user</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  belongs_to :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="901e1f9b5a6285915135f59fc9672548f6b78e6d">
  <div class="header">
    <h3>app/models/user.rb</h3>
    <h4><span class="red">39.13 %</span> covered</h4>
    <div>
      <b>115</b> relevant lines.
      <span class="green"><b>45</b> lines covered</span> and
      <span class="red"><b>70</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class User &lt; ActiveRecord::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby">  # Include default devise modules. Others available are:</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby">  # :token_authenticatable, :confirmable,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby">  # :lockable, :timeoutable and :omniauthable</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  devise :database_authenticatable, :registerable, :omniauthable,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">    :recoverable, :rememberable, :trackable</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby">  # Setup accessible (or protected) attributes for your model</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessible :first_name, :last_name, :email, :password, :password_confirmation, :remember_me, :city, :state, :zip,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    :neighborhood, :provider, :role, :uid, :token, :organization, :mission, :subscribed, :avatar, :uruut_point,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">    :telephone, :full_registration, :sign_in_plan, :sign_up_plan</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  after_create :assign_default_badge</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  attr_accessor :avatar_upload_width, :avatar_upload_height, :full_registration, :sign_in_plan, :sign_up_plan</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  # attr_accessible :title, :body</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">  validates_confirmation_of :password</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  validates_presence_of :first_name</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  validates_presence_of :last_name</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  validates_presence_of :email</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">  # validate :minimum_image_size</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  validates_uniqueness_of :email, :case_sensitive =&gt; false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  with_options dependent: :destroy do |user|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    # user.has_many :services</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>

          <code class="ruby">    user.has_many :projects</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">    user.has_many :contacts</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  has_many :donations</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>

          <code class="ruby">  has_many :tax_reports</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>

          <code class="ruby">  has_many :questions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>

          <code class="ruby">  has_one :membership</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>

          <code class="ruby">  has_one :marketing_info</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">  delegate :kind, to: :membership, prefix: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>

          <code class="ruby">  acts_as_tenant(:account)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  # Badging</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>

          <code class="ruby">  has_merit</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  scope :who_donated_to, -&gt;(project) { joins(:donations).</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    where(donations: { project_id: project.id, confirmed: true, anonymous: false }) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  delegate :plan, to: :membership, prefix: true</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">  # mount_uploader :avatar, AvatarUploader</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>

          <code class="ruby">  def self.create_with_omniauth(info)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">    create(name: info[&#39;name&#39;])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>

          <code class="ruby">  def self.find_for_social_oauth(auth, signed_in_resource=nil, type)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">    user = User.where(:provider =&gt; auth.provider.to_s, :uid =&gt; auth.uid.to_s).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">    unless user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">      user = User.where(:email =&gt; auth.info.email).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">      unless user</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="63">


          <code class="ruby">        password = Devise.friendly_token[0,20]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">        if type.eql?(&quot;facebook&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">          user = User.create!(</code>
        </li>

        <li class="never" data-hits="" data-linenumber="66">


          <code class="ruby">            first_name:auth.extra.raw_info.name.to_s.split(&#39; &#39;)[0],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby">            last_name: auth.extra.raw_info.name.to_s.split(&#39; &#39;)[1],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby">            provider:auth.provider,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">            uid:auth.uid,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="70">


          <code class="ruby">            email:auth.info.email,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">            password:password,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby">            password_confirmation:password,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="73">


          <code class="ruby">            token:auth.credentials.token,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="74">


          <code class="ruby">            avatar: auth.info.image</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby">          )</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="76">


          <code class="ruby">          user.build_membership.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="77">


          <code class="ruby">          Gateway::CustomerService.new(user).create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby">        end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="79">


          <code class="ruby">      else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="80">


          <code class="ruby">        user.update_attributes!({provider: auth.provider,uid: auth.uid})</code>
        </li>

        <li class="never" data-hits="" data-linenumber="81">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="83">


          <code class="ruby">    user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="84">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="85">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>

          <code class="ruby">  def self.set_redirect_path</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="87">


          <code class="ruby">    session.delete(:path)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="88">


          <code class="ruby">    project = Project.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="89">


          <code class="ruby">    project.user_id = resource.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="90">


          <code class="ruby">    project.save!</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="91">


          <code class="ruby">    &quot;/projects/#{project.id}/edit#sponsor-info&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="92">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="93">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>

          <code class="ruby">  def self.new_with_session(params, session)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="95">


          <code class="ruby">    if session[&quot;devise.user_attributes&quot;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="96">


          <code class="ruby">      new(session[&quot;devise.user_attributes&quot;], :without_protection =&gt; true) do |user|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="97">


          <code class="ruby">        user.attributes = params</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="98">


          <code class="ruby">        user.services.build(:provider =&gt; session[&quot;devise.provider&quot;], :uid =&gt; session[&quot;devise.uid&quot;])</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="99">


          <code class="ruby">        user.valid?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="100">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="101">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="102">


          <code class="ruby">      super</code>
        </li>

        <li class="never" data-hits="" data-linenumber="103">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="105">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>

          <code class="ruby">  def create_facebook_user(omni)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="107">


          <code class="ruby">    self.email = omni[&#39;extra&#39;][&#39;raw_info&#39;].email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="108">


          <code class="ruby">    self.apply_omniauth(omni)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="109">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="110">


          <code class="ruby">    if self.save</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="111">


          <code class="ruby">      flash[:notice] = &quot;Logged in.&quot;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="112">


          <code class="ruby">      sign_in_and_redirect User.find(self.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="113">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="114">


          <code class="ruby">      session[:omniauth] = omni.except(&#39;extra&#39;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="115">


          <code class="ruby">      redirect_to new_user_registration_path</code>
        </li>

        <li class="never" data-hits="" data-linenumber="116">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="117">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="118">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>

          <code class="ruby">  def email_required?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="120">


          <code class="ruby">    super &amp;&amp; provider.blank?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="121">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="122">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>

          <code class="ruby">  def password_required?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="124">


          <code class="ruby">    false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="125">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="126">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>

          <code class="ruby">  def projects_funded</code>
        </li>

        <li class="covered" data-hits="4" data-linenumber="128">
          <span class="hits">4</span>

          <code class="ruby">    Project.joins(:donations).where(&quot;donations.user_id = ? AND donations.confirmed = #{true}&quot;, self.id).uniq</code>
        </li>

        <li class="never" data-hits="" data-linenumber="129">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="130">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="131">
          <span class="hits">1</span>

          <code class="ruby">  def amount_funded</code>
        </li>

        <li class="covered" data-hits="2" data-linenumber="132">
          <span class="hits">2</span>

          <code class="ruby">    donations.sum(:amount)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="133">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="134">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>

          <code class="ruby">  def most_funded_city</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="136">


          <code class="ruby">    donation = self.donations.order(&quot;created_at DESC&quot;).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="137">


          <code class="ruby">    donation.nil? ? &quot;&quot; : donation.project.city</code>
        </li>

        <li class="never" data-hits="" data-linenumber="138">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="139">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>

          <code class="ruby">  def generate_tax_report(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="141">


          <code class="ruby">    donations = self.donations.where(project_id: project.id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="142">


          <code class="ruby">    total_donated = ActionController::Base.helpers.number_to_currency(donations.inject(0) {|sum, i| sum + i.amount}.to_f)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="143">


          <code class="ruby">    first_name = self.first_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="144">


          <code class="ruby">    last_name = self.last_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="145">


          <code class="ruby">    perks = Perk.where(project_id: project.id).order(&quot;amount ASC&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="146">


          <code class="ruby">    eligible_perk = perks.compact.find_all { |item| ActionController::Base.helpers.number_to_currency(item.amount) &lt;= total_donated }.max</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="147">


          <code class="ruby">    eligible_perk_name = eligible_perk.nil? ? &quot;None&quot; : eligible_perk.name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="148">


          <code class="ruby">    eligible_perk_description = eligible_perk.nil? ? &quot; &quot; : eligible_perk.description</code>
        </li>

        <li class="never" data-hits="" data-linenumber="149">


          <code class="ruby">    # Implicit Block</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="150">


          <code class="ruby">    Prawn::Document.generate(&quot;tmp/#{project.organization[0..8].gsub(/\s+/, &#39;&#39;)}_#{project.campaign_deadline.strftime(&#39;%Y%m%d&#39;)}#{self.id}.pdf&quot;) do</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="151">


          <code class="ruby">      font_size 18</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="152">


          <code class="ruby">      pad(20) { text &quot;#{project.organization}&quot; }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="153">


          <code class="ruby">      stroke_horizontal_rule</code>
        </li>

        <li class="never" data-hits="" data-linenumber="154">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="155">


          <code class="ruby">      font_size 12</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="156">


          <code class="ruby">      pad(20) { text &quot;Date: #{todays_date}&quot;}</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="157">


          <code class="ruby">      pad(20) { text &quot;Donator Name: #{first_name} #{last_name}&quot; }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="158">


          <code class="ruby">      pad(20) { text &quot;Total Donated: #{total_donated}&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="159">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="160">


          <code class="ruby">      pad(20) { text &quot;Perk/Benefit Received: #{eligible_perk_name} - #{eligible_perk_description}&quot; }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="161">


          <code class="ruby">      stroke_horizontal_rule</code>
        </li>

        <li class="never" data-hits="" data-linenumber="162">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="163">


          <code class="ruby">      font_size 10</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="164">


          <code class="ruby">      pad(20) { text &quot;No goods or services were received in exchange for the donation unless specified above.  It is recommended you seek advice from a tax professional.&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="165">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="166">


          <code class="ruby">    upload_to_s3(&quot;#{project.organization[0..8].gsub(/\s+/, &#39;&#39;)}_#{Date.today.strftime(&#39;%Y%m%d&#39;)}#{self.id}.pdf&quot;, project)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="167">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="168">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>

          <code class="ruby">  def upload_to_s3(filename, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="170">


          <code class="ruby">    s3 = AWS::S3.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="171">


          <code class="ruby">    bucket = s3.buckets[&#39;uruut/tax_reports&#39;]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="172">


          <code class="ruby">    obj = bucket.objects[filename]</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="173">


          <code class="ruby">    obj.write(:file =&gt; &quot;#{Rails.root}/tmp/#{filename}&quot;)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="174">


          <code class="ruby">    url = obj.public_url.to_s</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="175">


          <code class="ruby">    save_url(url, project)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="176">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="177">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>

          <code class="ruby">  def save_url(url, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="179">


          <code class="ruby">    tax_report = self.tax_reports.new</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="180">


          <code class="ruby">    tax_report.update_attributes(url: url, project_id: project.id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="181">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="182">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>

          <code class="ruby">  def is_admin?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="184">


          <code class="ruby">    role == &#39;admin&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="185">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="186">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="187">
          <span class="hits">1</span>

          <code class="ruby">  def donor?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="188">


          <code class="ruby">    membership_plan.blank?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="189">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="190">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>

          <code class="ruby">  def campaign_manager?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="192">


          <code class="ruby">    !donor?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="193">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="194">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="195">
          <span class="hits">1</span>

          <code class="ruby">  def send_welcome_email</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="196">


          <code class="ruby">    if self.donor?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="197">


          <code class="ruby">      WelcomeMailer.welcome_confirmation_donor(self).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="198">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="199">


          <code class="ruby">      WelcomeMailer.welcome_confirmation_user(self).deliver</code>
        </li>

        <li class="never" data-hits="" data-linenumber="200">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="201">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="202">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="204">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>

          <code class="ruby">  def assign_default_badge</code>
        </li>

        <li class="covered" data-hits="20" data-linenumber="206">
          <span class="hits">20</span>

          <code class="ruby">    self.add_badge(1)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="207">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="208">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="209">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="248deb0cfd0ad48f9bd072f78e737130d47486b0">
  <div class="header">
    <h3>app/services/gateway/base_service.rb</h3>
    <h4><span class="red">54.55 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;stripe&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">class Gateway::BaseService</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :user, :customer</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @user = user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def find_customer</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    return false unless user.stripe_user_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @customer = Stripe::Customer.retrieve(user.stripe_user_token)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def find_card</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    return false unless find_customer &amp;&amp; user.stripe_card_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    customer.cards.retrieve(user.stripe_card_token)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="c59123810d052eeb2c9cba2800711fdcdf6faec1">
  <div class="header">
    <h3>app/services/gateway/cards_service.rb</h3>
    <h4><span class="red">33.33 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;stripe&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">class Gateway::CardsService &lt; Gateway::BaseService</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def create(credit_card)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    return false unless find_customer</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    response = customer.cards.create(</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">      card: credit_card.details_as_hash</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">    )</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    customer.default_card = response.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    customer.save</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    user.stripe_card_token = response.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    user.save</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="e6fc991cf5749b5c80d306c061bc3610ab37ed77">
  <div class="header">
    <h3>app/services/gateway/customer_service.rb</h3>
    <h4><span class="red">42.86 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;stripe&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">class Gateway::CustomerService &lt; Gateway::BaseService</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    return false if user.stripe_user_token</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    response = Stripe::Customer.create(email: user.email)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    user.stripe_user_token = response.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    user.save</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="d19292acdc58db56c1cc616d9522c8eba85cee43">
  <div class="header">
    <h3>app/services/gateway/plans_service.rb</h3>
    <h4><span class="red">28.57 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>20</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;stripe&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">class Gateway::PlansService &lt; Gateway::BaseService</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def update_plan(plan_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    membership = @user.membership</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="7">


          <code class="ruby">    cancel_plan if updates_from_basic_or_plus_to_fee?(membership, plan_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    update_stripe_subscription(membership, plan_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def cancel_plan</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    membership = @user.membership</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    if membership.basic_or_plus?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">      return false unless find_card</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    cancel_stripe_subscription(membership)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    membership.clean_plan_data!</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def update_stripe_subscription(membership, plan_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">    plan = Plan.where(name: plan_id).first</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    membership.plan = plan</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    case plan_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">    when &#39;fee&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">      membership.save</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">    when &#39;basic&#39;, &#39;plus&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">      find_card</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">      response = customer.update_subscription(plan: plan_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">      membership.stripe_subscription_id = response.id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">      membership.save</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">    else</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">      false</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">  def cancel_stripe_subscription(membership)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    case membership.kind</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">    when &#39;basic&#39;, &#39;plus&#39;</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">      customer.cancel_subscription</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>

          <code class="ruby">  def updates_from_basic_or_plus_to_fee?(membership, plan_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="48">


          <code class="ruby">    plan_id == &#39;fee&#39; &amp;&amp; membership.basic_or_plus?</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="501003b58a9cdaedd52f211d748398104ed9ad15">
  <div class="header">
    <h3>app/services/subscription_service.rb</h3>
    <h4><span class="yellow">83.33 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SubscriptionService</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(user)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @user = user</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def update</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def cancel</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="cf6840928b0c230fde4fe34b1caae49d23c919a8">
  <div class="header">
    <h3>app/services/worksheet/base.rb</h3>
    <h4><span class="red">38.89 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Worksheet::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(xls, project, funders, worksheet_name)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    @project   = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    @funders   = funders</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="6">


          <code class="ruby">    @worksheet = xls.add_worksheet(worksheet_name)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="8">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    add_title_to_columns</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    funders.each_with_index do |funder, row|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">      funder_attributes = attributes(funder)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">      funder_attributes.each_with_index do |attribute, column|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">        worksheet.write(row + 1, column, attribute[1])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :project, :funders, :worksheet</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def add_title_to_columns</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">    column_titles.each_with_index do |title, column|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">      worksheet.write(0, column, format_title(title))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def format_title(title)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    title.to_s.titleize</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="f862985a47e78b58fe5aecbe684cc5557e3b0144">
  <div class="header">
    <h3>app/services/worksheet/donors.rb</h3>
    <h4><span class="red">58.33 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Worksheet::Donors &lt; Worksheet::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(xls, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    @project = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    super(xls, project, donations, &#39;Donors&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def attributes(donation)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">    { project_name: donation.project.title,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">      email:        donation.user.email,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">      first_name:   donation.user.first_name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">      last_name:    donation.user.last_name,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">      amount:       donation.amount,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">      perk:         donation.perk_name,</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">      description:  donation.description }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  def donations</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    Donation.for_project(project).known_users</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  def column_titles</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    [:project_name, :email, :first_name, :last_name, :amount, :perk, :description]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="99efbd4197005b7d330aacecb21d9d59ffb57790">
  <div class="header">
    <h3>app/services/worksheet/sponsors.rb</h3>
    <h4><span class="red">53.33 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Worksheet::Sponsors &lt; Worksheet::Base</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(xls, project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    @project = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    super(xls, project, project_sponsors, &#39;Project Sponsors&#39;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :project</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def attributes(project_sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    project_sponsor_benefit = benefit(project_sponsor)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">    { project_name:      project.project_title || &quot;&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">      organization_name: project_sponsor.name || &quot;&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">      name:              project_sponsor.sponsor.name || &quot;&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">      email:             project_sponsor.sponsor.email || &quot;&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">      amount:            project_sponsor.cost || &quot;&quot;,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">      level:             project_sponsor.sponsorship_level.name || &quot;&quot;,</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">      description:       project_sponsor_benefit.name || &quot;&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def project_sponsors</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">    @project_sponsors = project.project_sponsors</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">  def column_titles</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    [:project_name, :organization_name, :name, :email, :amount, :level, :description]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>

          <code class="ruby">  def benefit(project_sponsor)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    SponsorshipBenefit.for_project(project).with_project_sponsor_level(project_sponsor).first</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="151d00deba20d09927071f991cbfdfec5da2351d">
  <div class="header">
    <h3>app/services/xls_service.rb</h3>
    <h4><span class="red">47.06 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class XlsService</code>
        </li>

        <li class="never" data-hits="" data-linenumber="2">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(project)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    @project = project</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    @xls = WriteExcel.new(file_path)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def create</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    create_donors_worksheet</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    create_project_sponsors_worksheet</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    xls.close</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    self</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def file_path</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    &#39;tmp/project_funders.xls&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">private</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :project, :xls</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  def create_donors_worksheet</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    Worksheet::Donors.new(xls, project).create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def create_project_sponsors_worksheet</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    Worksheet::Sponsors.new(xls, project).create</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="00031ce59e4062aef510bd5632cb3d3beb920e52">
  <div class="header">
    <h3>app/workers/second_test.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class SecondTest</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  include Sidekiq::Worker</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def perform(name, count)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    logger.debug &quot;Hello&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby">  </code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def printTest</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    Project.print_test</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

      </div>
    </div>
  </body>
</html>
